(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t(require('photoeditorsdk'),require('react'),require('react-dom')):'function'==typeof define&&define.amd?define(['photoeditorsdk','react','react-dom'],t):'object'==typeof exports?exports.PhotoEditorReactUI=t(require('photoeditorsdk'),require('react'),require('react-dom')):e.PhotoEditorReactUI=t(e.PhotoEditorSDK,e.React,e.ReactDOM)})(this,function(e,t,o){var i=Math.atan2,r=Math.sin,a=Math.cos,n=Math.PI,s=Math.floor,l=Math.abs,d=Math.round,p=Math.min,c=Math.max;return function(e){function t(i){if(o[i])return o[i].exports;var r=o[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var o=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(o,'a',o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=108)}([function(e,t){'use strict';t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0}),t.SharedConstants=t.PropTypes=t.ImageLoader=t.ImageFormat=t.ColorMatrix=t.now=t.Log=t.cancelAnimationFrame=t.requestAnimationFrame=t.SDK=t.EXIF=t.ReactDOM=t.UniformType=t.OptionType=t.RenderType=t.Base64=t.Color=t.SharedState=t.Constants=t.EventEmitter=t.SDKUtils=t.Vector2=t.ReactBEM=t.BaseComponent=t.Classnames=t.BEM=t.React=t.Utils=t.Promise=void 0;var r=o(34),a=i(r),n=o(57),s=i(n),l=o(144),d=i(l),p=o(81),c=i(p),m=o(83),_=i(m),u=o(84),g=i(u),f=o(85),y=i(f),h=o(156),b=i(h),k=o(157),v=i(k),E=o(169),S=i(E),M=o(170),C=i(M),B=o(171),R=o(88),x=i(R),T=o(89),P=i(T),D=o(172),O=i(D),w=a.default.Base64,I=a.default.Color,F=a.default.Math.ColorMatrix,z=a.default.EventEmitter,N=a.default.EXIF,A=a.default.OptionType,V=a.default.Promise,L=a.default.Utils,U=a.default.RenderType,W=a.default.ImageFormat,j=a.default,K=a.default.UniformType,H=a.default.Math.Vector2,$='undefined'!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):o(90);t.Promise=V,t.Utils=v.default,t.React=s.default,t.BEM=g.default,t.Classnames=_.default,t.BaseComponent=b.default,t.ReactBEM=y.default,t.Vector2=H,t.SDKUtils=L,t.EventEmitter=z,t.Constants=S.default,t.SharedState=C.default,t.Color=I,t.Base64=w,t.RenderType=U,t.OptionType=A,t.UniformType=K,t.ReactDOM=d.default,t.EXIF=N,t.SDK=j,t.requestAnimationFrame=B.requestAnimationFrame,t.cancelAnimationFrame=B.cancelAnimationFrame,t.Log=x.default,t.now=$,t.ColorMatrix=F,t.ImageFormat=W,t.ImageLoader=P.default,t.PropTypes=c.default,t.SharedConstants=O.default},function(e,t,o){'use strict';t.__esModule=!0;var i=o(14),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'===('undefined'==typeof t?'undefined':(0,r.default)(t))||'function'==typeof t)?t:e}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=o(137),a=i(r),n=o(141),s=i(n),l=o(14),d=i(l);t.default=function(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+('undefined'==typeof t?'undefined':(0,d.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(a.default?(0,a.default)(e,t):e.__proto__=t)}},function(e,t,o){'use strict';t.__esModule=!0;var i=o(71),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e,t,o){return t in e?(0,r.default)(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(40),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=function(e){function t(o,i,r){var a=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(0,s.default)(this,t);var n=(0,d.default)(this,e.call(this));return n.type=o,n.title=i,n.text=r,n.overlay=a,n.data=null,n}return(0,c.default)(t,e),t.prototype.setData=function(e){this.data=e,this.emit('update')},t.prototype.close=function(){this.emit('close')},t}(m.EventEmitter),u=function(e){function t(){(0,s.default)(this,t);var o=(0,d.default)(this,e.call(this));return o._modals=[],o}return(0,c.default)(t,e),t.prototype.displayLoading=function(e){var t=new _('loading',null,e);return this.addModal(t),t},t.prototype.displayProgress=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=new _('progress',null,e);return o.setData({progress:t}),this.addModal(o),o},t.prototype.displayWarning=function(e,t){var o=new _('warning',e,t);return this.addModal(o),o},t.prototype.displayError=function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,i=new _('error',e,t,o);return this.addModal(i),i},t.prototype.addModal=function(e){var t=this;this._modals.push(e),e.on('close',function(){t.removeModal(e)}),e.on('update',function(){t.emit('update')}),this.emit('update')},t.prototype.removeModal=function(e){var t=this._modals.indexOf(e);this._modals.splice(t,1),this.emit('update')},t.prototype.getModals=function(){return this._modals},(0,a.default)(t,null,[{key:'instance',get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(m.EventEmitter);t.default=u},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),m=o(1),_=o(11),u=i(_),g=12,f=function(e){function t(){(0,a.default)(this,t);var o=(0,s.default)(this,e.call(this));return o.constructor.NATIVE_SCROLLBAR_WIDTH||(o.constructor.NATIVE_SCROLLBAR_WIDTH=m.Utils.getScrollbarWidth()),o._needsStyleFixes=!0,o._isDragging=!1,o._bindAll('_onButtonDragStart','_onButtonDrag','_onButtonDragStop','_onBarDragStart','_onBarDrag','_onBarDragStop','_onListScroll'),o.state={buttonSize:0,buttonPosition:0,buttonVisible:!1},o}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.update()},t.prototype.fixStyles=function(){m.Utils.isMobile()||this._updateListSize()},t.prototype._onListScroll=function(){if(!this._isDragging){var e=this._getDirection(),o,i,r;e===t.HORIZONTAL?(o=this._list.scrollWidth-this._list.offsetWidth,i=this._list.scrollLeft,r=this._node.offsetWidth-this.state.buttonSize):e===t.VERTICAL&&(o=this._list.scrollHeight-this._list.offsetHeight,i=this._list.scrollTop,r=this._node.offsetHeight-this.state.buttonSize);var a=i/o;this.setState({buttonPosition:r*a})}},t.prototype._onButtonDragStart=function(){this._isDragging=!0,this._initialButtonPosition=this.state.buttonPosition||0},t.prototype._onButtonDrag=function(e){var o=this._getDirection(),i;o===t.HORIZONTAL?i=this._initialButtonPosition+e.x:o===t.VERTICAL&&(i=this._initialButtonPosition+e.y),this._setButtonPosition(i)},t.prototype._onButtonDragStop=function(){this._isDragging=!1},t.prototype._onBarDragStart=function(o){var e=m.Utils.getEventPosition(o);this._initialPosition=e.clone();var i=this._node.getBoundingClientRect(),r=new m.Vector2(i.left,i.top),a=e.clone().subtract(r),n=this._getDirection();n===t.HORIZONTAL?this._setButtonPosition(a.x-this.state.buttonSize/2):n===t.VERTICAL&&this._setButtonPosition(a.y-this.state.buttonSize/2),document.addEventListener('mousemove',this._onBarDrag),document.addEventListener('touchmove',this._onBarDrag),document.addEventListener('mouseup',this._onBarDragStop),document.addEventListener('touchend',this._onBarDragStop)},t.prototype._onBarDrag=function(o){var e=m.Utils.getEventPosition(o),i=this._node.getBoundingClientRect(),r=new m.Vector2(i.left,i.top),a=e.clone().subtract(r),n=this._getDirection();n===t.HORIZONTAL?this._setButtonPosition(a.x-this.state.buttonSize/2):n===t.VERTICAL&&this._setButtonPosition(a.y-this.state.buttonSize/2)},t.prototype._onBarDragStop=function(){document.removeEventListener('mousemove',this._onBarDrag),document.removeEventListener('touchmove',this._onBarDrag),document.removeEventListener('mouseup',this._onBarDragStop),document.removeEventListener('touchend',this._onBarDragStop)},t.prototype._setButtonPosition=function(e){var o=this._getDirection(),i,r;o===t.HORIZONTAL?(i=this._node.offsetWidth-this.state.buttonSize,r=this._list.scrollWidth-this._list.offsetWidth):o===t.VERTICAL&&(i=this._node.offsetHeight-this.state.buttonSize,r=this._list.scrollHeight-this._list.offsetHeight),e=c(0,e),e=p(e,i),this.setState({buttonPosition:e});var a=e/i,n=r*a;o===t.HORIZONTAL?this._list.scrollLeft=n:o===t.VERTICAL&&(this._list.scrollTop=n)},t.prototype._updateButtonSize=function(e){var o=0,i=!1,r=this._getDirection(),a,n;r===t.HORIZONTAL?(a=this._list.clientWidth,n=this._list.scrollWidth):r===t.VERTICAL&&(a=this._list.offsetHeight,n=this._list.scrollHeight),o=a/n*a,i=n>a,this.setState({buttonSize:o,buttonVisible:i},e)},t.prototype._updateListSize=function(){if(this._list){var e=this._getDirection();if(e===t.HORIZONTAL){this._list.style.height='';var o=this._getFullListDimensions();this._listSize=o.y,this._listContentSize=this._list.offsetHeight}else if(e===t.VERTICAL){this._list.style.width='';var i=this._getFullListDimensions();this._listSize=i.x,this._listContentSize=this._list.offsetWidth}}},t.prototype._getFullListDimensions=function(){var e=this._list.getBoundingClientRect();return new m.Vector2(e.width,e.height)},t.prototype.update=function(){var e=this;if(!m.Utils.isMobile()){var o=this.refs,i=o.root,r=o.list;this._node=i,this._list=r;var a=this._getDirection();this._updateButtonSize(function(){e._listSize||e._updateListSize();var o=e._listSize;e.state.buttonVisible&&(o+=e.constructor.NATIVE_SCROLLBAR_WIDTH),a===t.HORIZONTAL?(e._list.style.height=o+'px',e._node.style.top=e._listContentSize-g+'px',e._node.style.width=e._list.offsetWidth+'px'):a===t.VERTICAL&&(e._list.style.width=o+'px',e._node.style.left=e._listContentSize-g+'px',e._node.style.height=e._list.offsetHeight+'px')}),this._list.addEventListener('scroll',this._onListScroll)}},t.prototype._getDirection=function(){return this.props.direction||'horizontal'},t.prototype._getButtonStyle=function(){var e=this._getDirection();return'horizontal'===e?{left:this.state.buttonPosition,width:this.state.buttonSize}:{top:this.state.buttonPosition,height:this.state.buttonSize}},t.prototype.getList=function(){return this.refs.list},t.prototype.getRoot=function(){return this.refs.root},t.prototype.renderWithBEM=function(){if(m.Utils.isMobile())return this.props.children;var e=this._getButtonStyle(),t={display:this.state.buttonVisible?'block':'none'},o=m.React.cloneElement(this.props.children,{ref:'list'});return m.ReactBEM.createElement('div',null,o,m.ReactBEM.createElement('div',{bem:'$b:scrollbar m:'+(this.props.direction||'horizontal')+' m:'+(this.state.buttonVisible?'visible':'invisible'),ref:'root',style:t,onMouseDown:this._onBarDragStart,onTouchStart:this._onBarDragStart},m.ReactBEM.createElement(u.default,{onStart:this._onButtonDragStart,onDrag:this._onButtonDrag,onStop:this._onButtonDragStop},m.ReactBEM.createElement('div',{bem:'e:bar',style:e,onMouseDown:this._onButtonDown}))))},t}(m.BaseComponent);t.default=f,f.HORIZONTAL='horizontal',f.VERTICAL='vertical',f.contextTypes=m.BaseComponent.contextTypes},function(e){var t=e.exports={version:'2.4.0'};'number'==typeof __e&&(__e=t)},function(e,t,o){var i=o(49)('wks'),r=o(32),a=o(12).Symbol,n='function'==typeof a,s=e.exports=function(e){return i[e]||(i[e]=n&&a[e]||(n?a:r)('Symbol.'+e))};s.store=i},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(206),m=i(c),_=o(207),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._hasBackButton=!0,n._hasDoneButton=!1,n._backButtonClicked=!1,n._bindAll('_onBackClick','_onDoneClick'),n}return(0,d.default)(t,e),t.prototype._onBackClick=function(){this._backButtonClicked=!0,this.props.onSwitchControls('back')},t.prototype._onDoneClick=function(){this._onBackClick()},t.prototype.renderControls=function(){return null},t.prototype.renderOverlayControls=function(){return null},t.prototype.renderWithBEM=function(){var e=this.props.options&&this.props.options.forcedControl,t=this._hasBackButton&&!e?p.ReactBEM.createElement(m.default,{onClick:this._onBackClick}):null,o=this._hasDoneButton||e?p.ReactBEM.createElement(u.default,{onClick:this._onDoneClick}):null;return p.ReactBEM.createElement('div',{bem:'$b:controls',ref:'root'},this.renderOverlayControls(),p.ReactBEM.createElement('div',{bem:'e:table'},t,this.renderControls(),o))},t}(p.BaseComponent);t.default=g,g.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=function(){function e(){(0,r.default)(this,e)}return e.prototype.getInitialSharedState=function(){return{}},e.prototype.isAvailable=function(){return!1},e.getPreloadAssets=function(){return[]},e}();a.topBarControlsComponent=null,a.controlsComponent=null,a.canvasControlsComponent=null,a.identifier=null,a.iconPath=null,a.languageKey=null,a.defaultOptions={},t.default=a},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onDragStart','_onDragMove','_onDragEnd'),n}return(0,d.default)(t,e),t.prototype._onDragStart=function(t){if(!this.props.disabled){t.preventDefault(),t.stopPropagation(),this._initialMousePosition=p.Utils.getEventPosition(t),document.addEventListener('mousemove',this._onDragMove),document.addEventListener('touchmove',this._onDragMove),document.addEventListener('mouseup',this._onDragEnd),document.addEventListener('touchend',this._onDragEnd);var e=this.refs.element,o=e.getBoundingClientRect(),i=new p.Vector2(o.left,o.top),r=this._initialMousePosition.clone().subtract(i);this.props.onStart&&this.props.onStart(r,t)}},t.prototype._onDragMove=function(t){t.preventDefault(),t.stopPropagation();var e=p.Utils.getEventPosition(t);if(e){var o=e.clone().subtract(this._initialMousePosition);this.props.onDrag&&this.props.onDrag(o,t)}},t.prototype._onDragEnd=function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this._onDragMove(t),document.removeEventListener('mousemove',this._onDragMove),document.removeEventListener('touchmove',this._onDragMove),document.removeEventListener('mouseup',this._onDragEnd),document.removeEventListener('touchend',this._onDragEnd),this.props.onStop&&this.props.onStop(t)},t.prototype.render=function(){if(!this.props.children||this.props.children instanceof Array)throw new Error('DraggableComponent expects exactly one child.');return p.React.cloneElement(this.props.children,{onMouseDown:this._onDragStart,onTouchStart:this._onDragStart,ref:'element'})},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e){var t=e.exports='undefined'!=typeof window&&window.Math==Math?window:'undefined'!=typeof self&&self.Math==Math?self:Function('return this')();'number'==typeof __g&&(__g=t)},function(e,t,o){var i=o(17),r=o(72),a=o(42),n=Object.defineProperty;t.f=o(18)?Object.defineProperty:function(e,t,o){if(i(e),t=a(t,!0),i(o),r)try{return n(e,t,o)}catch(t){}if('get'in o||'set'in o)throw TypeError('Accessors not supported!');return'value'in o&&(e[t]=o.value),e}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=o(114),a=i(r),n=o(126),s=i(n),l='function'==typeof s.default&&'symbol'==typeof a.default?function(e){return typeof e}:function(e){return e&&'function'==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?'symbol':typeof e};t.default='function'==typeof s.default&&'symbol'===l(a.default)?function(e){return'undefined'==typeof e?'undefined':l(e)}:function(e){return e&&'function'==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?'symbol':'undefined'==typeof e?'undefined':l(e)}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(37),m=i(c),_=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onSliderValueChange'),n.state={value:n.props.value},n}return(0,d.default)(t,e),t.prototype.componentWillReceiveProps=function(e){e.value!==this.state.value&&(this.state.value=e.value)},t.prototype._onSliderValueChange=function(e){this.props.onChange&&this.props.onChange(e),this.setState({value:e})},t.prototype._renderSlider=function(){var e=p.SDKUtils.defaults(this.props,{style:'',middleDot:!1,minValue:1,maxValue:100,label:'Label',onChange:this._onSliderValueChange,value:this.state.value});return p.ReactBEM.createElement(m.default,e)},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:controls e:overlay m:slider m:dark'},this._renderSlider())},t}(p.BaseComponent);t.default=_,_.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){var i=o(12),r=o(7),a=o(41),n=o(21),s='prototype',l=function(e,t,o){var d=e&l.F,p=e&l.G,c=e&l.S,m=e&l.P,_=e&l.B,u=e&l.W,g=p?r:r[t]||(r[t]={}),f=g[s],y=p?i:c?i[t]:(i[t]||{})[s],h,b,k;for(h in p&&(o=t),o)b=!d&&y&&void 0!==y[h],b&&h in g||(k=b?y[h]:o[h],g[h]=p&&'function'!=typeof y[h]?o[h]:_&&b?a(k,i):u&&y[h]==k?function(e){var t=function(t,o,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,o);}return new e(t,o,i)}return e.apply(this,arguments)};return t[s]=e[s],t}(k):m&&'function'==typeof k?a(Function.call,k):k,m&&((g.virtual||(g.virtual={}))[h]=k,e&l.R&&f&&!f[h]&&n(f,h,k)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,o){var i=o(25);e.exports=function(e){if(!i(e))throw TypeError(e+' is not an object!');return e}},function(e,t,o){e.exports=!o(26)(function(){return 7!=Object.defineProperty({},'a',{get:function(){return 7}}).a})},function(e){var t={}.hasOwnProperty;e.exports=function(e,o){return t.call(e,o)}},function(e,t,o){var i=o(77),r=o(44);e.exports=function(e){return i(r(e))}},function(e,t,o){var i=o(13),r=o(27);e.exports=o(18)?function(e,t,o){return i.f(e,t,r(1,o))}:function(e,t,o){return e[t]=o,e}},function(e){e.exports={}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(175),m=i(c),_=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._renderHeader=function(){return this.context.options.showHeader?p.ReactBEM.createElement(m.default,null):null},t.prototype._renderScreen=function(){return p.ReactBEM.createElement('div',null)},t.prototype.renderWithBEM=function(){var e='b:screen';return this.context.options.showHeader||(e+=' m:noHeader'),p.ReactBEM.createElement('div',{bem:e,className:this.props.visible?null:'is-hidden'},this._renderHeader(),this._renderScreen())},t}(p.BaseComponent);t.default=_,_.propTypes={editor:p.PropTypes.any},_.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onCanvasZoomDone'),n}return(0,d.default)(t,e),t.prototype._performHitTest=function(e){var t=this.refs.container,o=t.getBoundingClientRect(),i=new p.Vector2(o.left,o.top),r=e.subtract(i),a=this.context.editor,n=a.controls.getAvailable();for(var s in n){var l=n[s],d=l.clickAtPosition&&l.clickAtPosition(r,a);if(d)return d.selectedSprite===this.getSharedState('selectedSprite')||(this.props.onSwitchControls(l,d),!0)}return!1},t.prototype._onCanvasZoomDone=function(){this.forceUpdate()},t.prototype._bindEvents=function(){e.prototype._bindEvents.call(this),this.context.mediator.on(p.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)},t.prototype._unbindEvents=function(){e.prototype._unbindEvents.call(this),this.context.mediator.off(p.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e){e.exports=function(e){return'object'==typeof e?null!==e:'function'==typeof e}},function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,o){var i=o(76),r=o(50);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,o){'use strict';t.__esModule=!0;var i=o(178),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=r.default||function(e){for(var t=1,o;t<arguments.length;t++)for(var i in o=arguments[t],o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);return e}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(1),s=o(62),l=i(s),d=function(){function e(t,o){(0,a.default)(this,e),this._ui=t,this._options=o,this._categoriesById={},this._categories=[],this._stickersById={},this._addCategories(n.SharedConstants.DEFAULTS.STICKER_CATEGORIES);var i=this._options,r=i.categories,s=i.replaceCategories;this._options.categories?this._addCategories(r,s):(this._updateCategoriesMap(),this._updateAllCategory())}return e.prototype.loadExternal=function(e){var t=this,o=new l.default(e);return o.load().then(function(e){t._addCategories(e.categories,t._options.replaceCategories)})},e.prototype._addCategories=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._categories=t?e.slice(0):n.Utils.mergeCategories(this._categories,e,'stickers'),this._updateCategoriesMap(),this._updateAllCategory()},e.prototype._updateCategoriesMap=function(){var e=this;this._categoriesById={},this._categories.forEach(function(t){e._categoriesById[t.identifier]=t}),this._categories.forEach(function(t){t.stickers.forEach(function(t){e._stickersById[t.identifier]=t})}),null!==this._options.availableStickers&&(this._categories.forEach(function(t){t.stickers=t.stickers.filter(function(t){return-1!==e._options.availableStickers.indexOf(t.identifier)})}),this._categories=this._categories.filter(function(e){return 0<e.stickers.length})),this._updateAllCategory()},e.prototype._updateAllCategory=function(){this._allCategory={identifier:'all',defaultName:'All',stickers:this._categories.map(function(e){return e.stickers}).reduce(function(e,t){return e.concat(t)},[])},this._categoriesById.all=this._allCategory},e.prototype.getStickersForCategory=function(e){if(!this._categoriesById[e])throw new Error('Unknown sticker category \''+e+'\'');return this._categoriesById[e].stickers},e.prototype.getStickerByIdentifier=function(e){return this._stickersById[e]},e.prototype.getCategories=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return e?[this._allCategory].concat(this._categories):this._categories},e.prototype.getCategory=function(e){return this._categoriesById[e]},e.getURLForSticker=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'base',o=e.images,i='base'===t?o.mediaBase||o.mediaThumb:o.mediaThumb,r=i.uris||[i.uri];if(!n.Utils.Browser.getIEVersion()){var a=r.filter(function(e){return /\.svg$/i.test(e)});return a.length?a[0]:r[0]}var s=r.filter(function(e){return!/\.svg$/i.test(e)});return s.length?s[0]:r[0]},e}();t.default=d},function(e,t,o){'use strict';var i=o(116)(!0);o(74)(String,'String',function(e){this._t=e+'',this._i=0},function(){var e=this._t,t=this._i,o;return t>=e.length?{value:void 0,done:!0}:(o=i(e,t),this._i+=o.length,{value:o,done:!1})})},function(e){var t=0,o=Math.random();e.exports=function(e){return'Symbol('.concat(e===void 0?'':e,')_',(++t+o).toString(36))}},function(e,t){t.f={}.propertyIsEnumerable},function(t){t.exports=e},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(o){'object'==typeof window&&(t=window)}e.exports=t},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderContent=function(){return this.props.children},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:topBar e:row'},p.ReactBEM.createElement('div',{bem:'e:cell'},this.renderContent()))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(29),a=i(r),n=o(0),s=i(n),m=o(2),_=i(m),u=o(3),g=i(u),f=o(1),y=o(11),h=i(y),b=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,_.default)(this,e.call.apply(e,[this].concat(i)));return a._bindAll('_onKnobDragStart','_onKnobDrag','_onKnobDragStop','_onBarDragStart','_onBarDrag','_onBarDragStop','_onMiddleDotClick'),a.state={value:a.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},a}return(0,g.default)(t,e),t.prototype.componentDidMount=function(){this._setValue(this.state.value,!1)},t.prototype.componentWillReceiveProps=function(e){e.value!==this.state.value&&this._setValue(e.value,!1)},t.prototype._onMiddleDotClick=function(){this._previousValue=this.state.value;var e=this.props.minValue+(this.props.maxValue-this.props.minValue)/2;this._setValue(e,!0,!0)},t.prototype._onKnobDragStart=function(e){this._previousValue=this.state.value,this._initialSliderPosition=this.state.sliderPosition,this._initialPosition=e},t.prototype._onKnobDrag=function(e){var t=this.refs.bar,o=t.offsetWidth,i=this._initialSliderPosition+e.x;i=c(0,p(i,o));var r=i/o,a=this.props.minValue+(this.props.maxValue-this.props.minValue)*r;this._setValue(a)},t.prototype._onKnobDragStop=function(){this._setValue(this.state.value,!0,!0)},t.prototype._onBarDragStart=function(e){this._previousValue=this.state.value,this._initialPosition=e.clone();var t=this.refs.bar,o=t.offsetWidth,i=e.x/o,r=this.props.minValue+(this.props.maxValue-this.props.minValue)*i;this._setValue(r)},t.prototype._onBarDrag=function(e){var t=this._initialPosition.clone().add(e),o=this.refs.bar,i=o.offsetWidth,r=t.x/i,a=this.props.minValue+(this.props.maxValue-this.props.minValue)*r;a=c(this.props.minValue,p(this.props.maxValue,a)),this._setValue(a)},t.prototype._onBarDragStop=function(){this._setValue(this.state.value,!0,!0)},t.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition}},t.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}},t.prototype._displayMiddleDot=function(){return!1!==this.props.middleDot},t.prototype._setValue=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,o=2<arguments.length&&void 0!==arguments[2]&&arguments[2];e=d(e);var i=this.props,r=i.minValue,a=i.maxValue,n=(e-r)/(a-r),s=this.refs.bar,p=s.offsetWidth,c=n*p,m=0;this._displayMiddleDot()&&(c=l(n-0.5)*p,m=0.5>n?0.5*p-c:'50%'),this.setState({value:e,sliderPosition:p*n,foregroundWidth:c,foregroundLeft:m}),t&&this.props.onChange&&this.props.onChange(e,this._previousValue,o)},t.prototype._buildValue=function(e){return 0!=e%1&&(e=e.toFixed(2)),this.props.positiveValuePrefix&&0<=e&&(e=''+this.props.positiveValuePrefix+e),this.props.valueUnit&&(e+=this.props.valueUnit),e},t.prototype.renderWithBEM=function(){var e=null;this._displayMiddleDot()&&(e=f.ReactBEM.createElement('div',{bem:'e:middleDot',onClick:this._onMiddleDotClick}));var t={style:this._getForegroundStyle()},o='$b:slider'+(this.props.style?' m:'+this.props.style:'');return f.ReactBEM.createElement('div',{bem:o},f.ReactBEM.createElement('div',{bem:'$e:bar',ref:'bar'},f.ReactBEM.createElement(h.default,{onStart:this._onBarDragStart,onDrag:this._onBarDrag,onStop:this._onBarDragStop},f.ReactBEM.createElement('div',null,f.ReactBEM.createElement('div',{bem:'$e:background'}),f.ReactBEM.createElement('div',(0,a.default)({bem:'$e:foreground'},t)),f.ReactBEM.createElement(h.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag,onStop:this._onKnobDragStop},f.ReactBEM.createElement('div',{bem:'e:knob b:knob m:slider',style:this._getKnobStyle()})))),e),f.ReactBEM.createElement('div',{bem:'$e:labels'},f.ReactBEM.createElement('div',{bem:'e:label m:lowerBoundary'},this._buildValue(this.props.minValue)),f.ReactBEM.createElement('div',{bem:'e:label m:value'},this.props.label,' ',this._buildValue(this.state.value)),f.ReactBEM.createElement('div',{bem:'e:label m:upperBoundary'},this._buildValue(this.props.maxValue))))},t}(f.BaseComponent);t.default=b,b.contextTypes=f.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(29),a=i(r),n=o(4),s=i(n),l=o(0),d=i(l),p=o(2),c=i(p),m=o(3),_=i(m),u=o(1),g=o(240),f=i(g),y=o(241),h=i(y),b=o(242),k=i(b),v=o(24),E=i(v),S=u.SDK.Operations.SpriteOperation,M=S.StickerSprite,C=S.TextSprite,B=S.BrushSprite,R=function(e){function t(){var o;(0,d.default)(this,t);for(var i=arguments.length,r=Array(i),a=0;a<i;a++)r[a]=arguments[a];var n=(0,c.default)(this,e.call.apply(e,[this].concat(r)));return n._bindAll('_onCanvasClick','_onSpriteDragStart','_onSpriteDragStop','_onOperationUpdated','_onOperationRemoved','_onSpriteFlip','_onSpriteTakeToFront','_onSpriteRemove'),n._canvasClickDisabled=!1,n._events=(o={},(0,s.default)(o,u.Constants.EVENTS.OPERATION_UPDATED,n._onOperationUpdated),(0,s.default)(o,u.Constants.EVENTS.OPERATION_REMOVED,n._onOperationRemoved),o),n}return(0,_.default)(t,e),t.prototype._onOperationRemoved=function(e){var t=this.getSharedState('selectedSprite');if(e===this.getSharedState('operation')&&t){var o=this.context.editor,i=o.operations.getOrCreate('sprite',{sprites:[t],enabled:!1});this.setSharedState({operation:i,operationExistedBefore:!1,initialOptions:{}})}},t.prototype._onOperationUpdated=function(e){var t=this.getSharedState('selectedSprite');if(e===this.getSharedState('operation')&&t){var o=e.getSprites();-1===o.indexOf(t)&&o.push(t),this.forceUpdate()}},t.prototype._onItemBlur=function(){},t.prototype._onCanvasClick=function(t){if(!this._canvasClickDisabled){var e=this._performHitTest(u.Utils.getEventPosition(t));e||(this.getSharedState('selectedSprite')&&this._onItemBlur(),this.props.onSwitchControls('home'))}},t.prototype._onSpriteFlip=function(e){var t=this.getSharedState('selectedSprite');'h'===e?t.setFlipHorizontally(!t.getFlipHorizontally()):'v'===e?t.setFlipVertically(!t.getFlipVertically()):void 0},t.prototype._onSpriteTakeToFront=function(){var e=this.getSharedState('operation');e.takeSpriteToFront(this.getSharedState('selectedSprite')),this.forceSharedUpdate()},t.prototype._onSpriteRemove=function(){var e=this.getSharedState('operation'),t=this.getSharedState('selectedSprite');e.removeSprite(t),t.dispose(),this.setSharedState({selectedSprite:null})},t.prototype._onSpriteDragStart=function(){this._canvasClickDisabled=!0},t.prototype._onSpriteDragStop=function(){var e=this;setTimeout(function(){e._canvasClickDisabled=!1},100)},t.prototype._getContainerStyle=function(){var e=this.context.editor,t=e.getCanvasDimensions(),o=e.getOutputDimensions(),i=t.clone().divide(2).subtract(o.clone().divide(2)),r=i.x,a=i.y;return{left:r,top:a,width:o.x,height:o.y}},t.prototype._getContainerProps=function(){return{}},t.prototype._getInnerContainerProps=function(){return{style:this._getContainerStyle(),onClick:this._onCanvasClick}},t.prototype._renderSpriteItems=function(){var e=this,t=this.getSharedState('operation'),o=t.getSprites(),i=this.getSharedState('selectedSprite');return o.map(function(o){var r=null;return o instanceof C?r=f.default:o instanceof M?r=h.default:o instanceof B&&(r=k.default),u.ReactBEM.createElement(r,{operation:t,sharedState:e.props.sharedState,sprite:o,selected:o===i,onDragStart:e._onSpriteDragStart,onDragStop:e._onSpriteDragStop,onRemove:e._onSpriteRemove.bind(e,o),options:e.props.options,ref:'sprite-'+o.getId()})})},t.prototype._renderOverlayControls=function(){return null},t.prototype.renderWithBEM=function(){return u.ReactBEM.createElement('div',(0,a.default)({bem:'$b:canvasControls e:container m:full',ref:'container'},this._getContainerProps()),u.ReactBEM.createElement('div',(0,a.default)({bem:'b:canvasControls e:innerContainer',ref:'innerContainer'},this._getInnerContainerProps()),u.ReactBEM.createElement('div',{bem:'$b:spritesCanvasControls',ref:'container'},this._renderSpriteItems(),this._renderOverlayControls())))},t}(E.default);t.default=R,R.contextTypes=E.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(14),a=i(r),n=o(0),s=i(n),l=o(269),d=i(l),p=o(272),c=i(p),m=function(){function e(t,o){(0,s.default)(this,e),this._ui=t,this._fonts=o,this._loadedFonts=[]}return e.prototype.setFonts=function(e){this._fonts=e},e.prototype.needsToLoad=function(){for(var e=this,t=function(t){var o;return e._fonts[t].getVariations().forEach(function(e){o=o||e.getProvider()}),o?{v:!0}:'continue'},o=0,i;o<this._fonts.length;o++)switch(i=t(o),i){case'continue':continue;default:if('object'===('undefined'==typeof i?'undefined':(0,a.default)(i)))return i.v;}},e.prototype.fontLoaded=function(e){var t=e.getFontFamily();return-1!==this._loadedFonts.indexOf(t)},e.prototype.setFontLoaded=function(e){if(!this.fontLoaded(e)){var t=e.getFontFamily();this._loadedFonts.push(t)}},e.prototype.load=function(){var e=this,t=this._fonts,o={google:new d.default(this._ui),file:new c.default(this._ui)},i=function(){for(var e in o){var t=o[e];t.dispose()}};t.filter(function(t){return!e.fontLoaded(t)}).forEach(function(e){e.getVariations().forEach(function(e){var t=e.getProvider();if(t){var i=o[t];i.add(e)}})});var r=[];for(var a in o)r.push(o[a].load());return Promise.all(r).then(function(){i(),t.forEach(function(t){e.setFontLoaded(t)})}).catch(function(t){throw i(),t})},e}();t.default=m},function(e,t,o){'use strict';t.__esModule=!0;var i=o(71),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(){function e(e,t){for(var o=0,i;o<t.length;o++)i=t[o],i.enumerable=i.enumerable||!1,i.configurable=!0,'value'in i&&(i.writable=!0),(0,r.default)(e,i.key,i)}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}()},function(e,t,o){var i=o(113);e.exports=function(e,t,o){return(i(e),void 0===t)?e:1===o?function(o){return e.call(t,o)}:2===o?function(o,i){return e.call(t,o,i)}:3===o?function(o,i,r){return e.call(t,o,i,r)}:function(){return e.apply(t,arguments)}}},function(e,t,o){var i=o(25);e.exports=function(e,t){if(!i(e))return e;var o,r;if(t&&'function'==typeof(o=e.toString)&&!i(r=o.call(e)))return r;if('function'==typeof(o=e.valueOf)&&!i(r=o.call(e)))return r;if(!t&&'function'==typeof(o=e.toString)&&!i(r=o.call(e)))return r;throw TypeError('Can\'t convert object to primitive value')}},function(e){var t=Math.ceil;e.exports=function(e){return isNaN(e=+e)?0:(0<e?s:t)(e)}},function(e){e.exports=function(e){if(e==void 0)throw TypeError('Can\'t call method on  '+e);return e}},function(e){e.exports=!0},function(e,t,o){var i=o(17),r=o(118),a=o(50),n=o(48)('IE_PROTO'),s=function(){},l='prototype',d=function(){var e=o(73)('iframe'),t=a.length,i='<',r='>',n;for(e.style.display='none',o(121).appendChild(e),e.src='javascript:',n=e.contentWindow.document,n.open(),n.write(i+'script'+r+'document.F=Object'+i+'/script'+r),n.close(),d=n.F;t--;)delete d[l][a[t]];return d()};e.exports=Object.create||function(e,t){var o;return null===e?o=d():(s[l]=i(e),o=new s,s[l]=null,o[n]=e),void 0===t?o:r(o,t)}},function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},function(e,t,o){var i=o(49)('keys'),r=o(32);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,o){var i=o(12),r='__core-js_shared__',a=i[r]||(i[r]={});e.exports=function(e){return a[e]||(a[e]={})}},function(e){e.exports=['constructor','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','toLocaleString','toString','valueOf']},function(e,t,o){var i=o(13).f,r=o(19),a=o(8)('toStringTag');e.exports=function(e,t,o){e&&!r(e=o?e:e.prototype,a)&&i(e,a,{configurable:!0,value:t})}},function(e,t,o){var i=o(44);e.exports=function(e){return Object(i(e))}},function(e,t,o){o(123);for(var r=o(12),a=o(21),n=o(22),s=o(8)('toStringTag'),l=['NodeList','DOMTokenList','MediaList','StyleSheetList','CSSRuleList'],d=0;5>d;d++){var i=l[d],p=r[i],c=p&&p.prototype;c&&!c[s]&&a(c,s,i),n[i]=n.Array}},function(e,t,o){t.f=o(8)},function(e,t,o){var i=o(12),r=o(7),a=o(45),n=o(54),s=o(13).f;e.exports=function(e){var t=r.Symbol||(r.Symbol=a?{}:i.Symbol||{});'_'==e.charAt(0)||e in t||s(t,e,{value:n.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e){e.exports=t},function(e){'use strict';function t(e){return function(){return e}}var o=function(){};o.thatReturns=t,o.thatReturnsFalse=t(!1),o.thatReturnsTrue=t(!0),o.thatReturnsNull=t(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e){'use strict';var t=function(){};'production'!=={ENV:'"production"'}.NODE_ENV&&(t=function(e){if(e===void 0)throw new Error('invariant requires an error message argument')}),e.exports=function(o,i,r,a,n,s,l,e){if(t(i),!o){var d;if(void 0===i)d=new Error('Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.');else{var p=[r,a,n,s,l,e],c=0;d=new Error(i.replace(/%s/g,function(){return p[c++]})),d.name='Invariant Violation'}throw d.framesToPop=1,d}}},function(e){'use strict';e.exports='SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED'},function(e){function t(){throw new Error('setTimeout has not been defined')}function o(){throw new Error('clearTimeout has not been defined')}function r(e){if(p===setTimeout)return setTimeout(e,0);if((p===t||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function i(e){if(c===clearTimeout)return clearTimeout(e);if((c===o||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function a(){_&&g&&(_=!1,g.length?m=g.concat(m):u=-1,m.length&&n())}function n(){if(!_){var e=r(a);_=!0;for(var t=m.length;t;){for(g=m,m=[];++u<t;)g&&g[u].run();u=-1,t=m.length}g=null,_=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var d=e.exports={},p,c;(function(){try{p='function'==typeof setTimeout?setTimeout:t}catch(o){p=t}try{c='function'==typeof clearTimeout?clearTimeout:o}catch(t){c=o}})();var m=[],_=!1,u=-1,g;d.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];m.push(new s(e,t)),1!==m.length||_||r(n)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title='browser',d.browser=!0,d.env={},d.argv=[],d.version='',d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.prependListener=l,d.prependOnceListener=l,d.listeners=function(){return[]},d.binding=function(){throw new Error('process.binding is not supported')},d.cwd=function(){return'/'},d.chdir=function(){throw new Error('process.chdir is not supported')},d.umask=function(){return 0}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(159),s=i(n),l=o(162),p=i(l),c=function(){function e(t){(0,a.default)(this,e),this._url=t,this._parsedUrl=p.default.parse(this._url,!0)}return e.prototype._isJSONPRequest=function(){var e=this._parsedUrl.query;for(var t in e){var o=e[t];if('?'===o)return!0}return!1},e.prototype.load=function(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()},e.prototype._loadJSON=function(){var e=this;return new s.default(function(t,o){var i;window.XDomainRequest?(i=new window.XDomainRequest,i.onload=function(){var e=JSON.parse(i.responseText);t(e)},i.onerror=function(t){o(t)}):window.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e=JSON.parse(i.responseText);t(e)}else o(new Error('HTTP Status '+i.status))}),i.open('GET',e._url,!0),i.send()})},e.prototype._loadJSONP=function(){var e=this,t=!1,o=!1,i='pesdk'+d(99999999999999*Math.random());return new s.default(function(r,a){var n=e._createJSONPNode(i);window[i]=function(i){e._removeJSONPNode(n),t||(o=!0,r(i))},window.setTimeout(function(){o||(e._removeJSONPNode(n),t=!0,a(new Error('Timeout of 5 seconds exceeded.')))},5e3)})},e.prototype._createJSONPNode=function(e){var t=this._buildJSONPUrl(e),o=document.querySelector('head'),i=document.createElement('script');return i.src=t,o.appendChild(i),i},e.prototype._removeJSONPNode=function(e){e.parentNode.removeChild(e)},e.prototype._buildJSONPUrl=function(e){var t=this._parsedUrl.query,o=null;for(var i in t)if('?'===t[i]){o=i;break}return delete this._parsedUrl.search,t[o]=e,p.default.format(this._parsedUrl)},e}();t.default=c},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onClick'),n}return(0,d.default)(t,e),t.prototype._onClick=function(){this.props.onClick&&this.props.onClick()},t.prototype._renderContent=function(){return null},t.prototype.renderWithBEM=function(){var e='$e:row m:'+this._modifier;return this.props.totalRows&&(e+=' m:row-'+this.props.totalRows),p.ReactBEM.createElement('bem',{specifier:'b:splashScreen'},p.ReactBEM.createElement('div',{bem:e},this._renderContent()))},t}(p.BaseComponent);t.default=c,c.propTypes={onClick:p.PropTypes.func},c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(183),m=i(c),_=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onNewFile'),n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){this._fileLoader=new m.default(this.refs.fileInput),this._fileLoader.on('file',this._onNewFile)},t.prototype.componentWillUnmount=function(){this._fileLoader.off('file',this._onNewFile),this._fileLoader.dispose(),this._fileLoader=null},t.prototype._onNewFile=function(e){this.props.onNewFile&&this.props.onNewFile(e)},t.prototype.open=function(){this._fileLoader.open()},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('input',{type:'file',accept:'image/*',bem:'b:hiddenFileInput',ref:'fileInput'})},t}(p.BaseComponent);t.default=_,_.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){var e='$e:button';this.props.style&&(e+=' m:'+this.props.style),this.props.icon&&(e+=' m:withIcon');var t=null;return this.props.icon&&(t=p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath(this.props.icon,!0)})),p.ReactBEM.createElement('bem',{specifier:'$b:topBar'},p.ReactBEM.createElement('div',{bem:e,onClick:this.props.onClick},t,p.ReactBEM.createElement('div',{bem:'e:label'},this.props.label||'Button')))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t,o){(0,r.default)(this,e),this._ui=t,this._options=o,this._categoriesById={},this._filtersByIdentifier={identity:a.SDK.Filters.IdentityFilter},this._categories=a.SharedConstants.DEFAULTS.FILTERS,this._initCategories()}return e.prototype.instantiateFilterWithIdentifier=function(e){var t=this,o=this.getFilterByIdentifier(e);if(!o)return Promise.reject(new Error('Unknown filter with identifier `'+e+'`!'));if(!(o.prototype instanceof a.SDK.Filter)){var i=o.lutImage,r=o.resolution,n=o.horizontalTileCount,s=o.verticalTileCount,l=this._ui.getPreloader().getAsset(i),d;return d=l?Promise.resolve(l):a.ImageLoader.load(this._ui.getAssetPath(i)),d.then(function(){return a.ImageLoader.load(t._ui.getAssetPath(i)).then(function(e){return new a.SDK.Filters.ThreeDLUTFilter({image:e,resolution:r,horizontalTileCount:n,verticalTileCount:s})})})}return Promise.resolve(new o)},e.prototype._initCategories=function(){var e=this;if(this._options.categories&&(this._options.replaceCategories?this._categories=this._options.categories:this._categories=a.Utils.mergeCategories(this._categories,this._options.categories,'filters')),this._options.availableFilters){var t=[];this._categories.forEach(function(o){var i=o.filters.filter(function(t){return-1!==e._options.availableFilters.indexOf(t.identifier)});0<i.length&&t.push({identifier:o.identifier,defaultName:o.defaultName,filters:i})}),this._categories=t}var o={identifier:'all',defaultName:'All',filters:this._categories.map(function(e){return e.filters}).reduce(function(e,t){return e.concat(t)})};this._categories.unshift(o),this._categoriesById.all=o,this._categories.forEach(function(t){e._categoriesById[t.identifier]=t}),o.filters.forEach(function(t){e._filtersByIdentifier[t.identifier]=t})},e.prototype.getFiltersForCategory=function(e){if(!this._categoriesById[e])throw new Error('Unknown filter category \''+e+'\'');return this._categoriesById[e].filters},e.prototype.getFilterByIdentifier=function(e){return this._filtersByIdentifier[e]},e.prototype.getCategories=function(){return this._categories},e.prototype.getCategoryByIdentifier=function(e){return this._categoriesById[e]},e}();t.default=n},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onItemDragStart','_onItemDragStop','_onItemDrag','_onSpriteUpdate'),n}return(0,d.default)(t,e),t.prototype._getAbsoluteSpritePosition=function(){var e=this.context.editor,t=e.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(t)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.sprite.on('update',this._onSpriteUpdate)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.props.sprite.off('update',this._onSpriteUpdate)},t.prototype.componentWillReceiveProps=function(e){this.props.sprite.off('update',this._onSpriteUpdate),e.sprite.on('update',this._onSpriteUpdate)},t.prototype._onSpriteUpdate=function(){this.forceUpdate()},t.prototype._onItemDragStart=function(){var e=this.props.sprite;this._initialPosition=e.getPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onItemDrag=function(e){var t=this.props.sprite,o=this.context.editor,i=o.getOutputDimensions(),r=this._initialPosition.clone().add(e.divide(i));t.setPosition(r)},t.prototype._onItemDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(248),u=i(_),g=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,d.default)(this,e.call.apply(e,[this].concat(i)));return n._value=n.props.initialValue.clone(),n._bindAll('_onButtonClick','_onValueChange','_onColorPickerOpen','_onColorPickerClose'),n._events=(0,a.default)({},m.Constants.EVENTS.COLORPICKER_OPEN,n._onColorPickerOpen),n.state={overlayVisible:!1},n._transparentPatternCanvas=m.Utils.createTransparentPatternCanvas(),n}return(0,c.default)(t,e),t.prototype.componentWillReceiveProps=function(e){e.initialValue!==this.props.initialValue&&(this._value=e.initialValue.clone(),this._renderColor())},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderColor()},t.prototype.componentDidUpdate=function(){this._renderColor()},t.prototype._onColorPickerOpen=function(e){e===this||this.setState({overlayVisible:!1})},t.prototype._onColorPickerClose=function(){this.setState({overlayVisible:!1})},t.prototype._onButtonClick=function(t){t.preventDefault(),t.stopPropagation(),this.state.overlayVisible||this._emitEvent(m.Constants.EVENTS.COLORPICKER_OPEN,this),this.setState({overlayVisible:!this.state.overlayVisible})},t.prototype._onValueChange=function(e){this._value=e,this._renderColor(),this.forceUpdate(),this.props.onChange&&this.props.onChange(e)},t.prototype._renderColor=function(){var e=this.refs.canvas,t=e.getContext('2d');e.width=e.offsetWidth,e.height=e.offsetHeight;var o=t.createPattern(this._transparentPatternCanvas,'repeat');t.fillStyle=o,t.fillRect(0,0,e.width,e.height),t.fillStyle=this._value.toRGBA(),t.fillRect(0,0,e.width,e.height)},t.prototype.renderWithBEM=function(){var e=null;this.state.overlayVisible&&(e=m.ReactBEM.createElement(u.default,{initialValue:this._value,onChange:this._onValueChange,onClose:this._onColorPickerClose,alpha:this.props.alpha}));var t=this.state.overlayVisible?'is-active':null;return m.ReactBEM.createElement('bem',{specifier:'$b:controls'},m.ReactBEM.createElement('div',{bem:'$b:colorPicker',className:t,onClick:this._onButtonClick},m.ReactBEM.createElement('canvas',{bem:'e:preview',ref:'canvas'}),m.ReactBEM.createElement('div',{bem:'e:label'},this.props.label||this._t('generic.color')),e))},t}(m.BaseComponent);t.default=g,g.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(105),c=i(p),m=o(107),_=i(m),u=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._serializeSticker=function(t,o){var i=t.getInputDimensions(!1),r=e.prototype._serializeSticker.call(this,t,o);return'none'!==o.getTintMode()&&(r.options.tintColor=o.serializeOption('tintColor',!0)),r.options.dimensions=o.getDimensions().clone().divide(i.min()).toObject(),r.options.identifier=r.options.name,delete r.options.name,r},t.prototype._serializePath=function(t){var o=e.prototype._serializePath.call(this,t),i=t.getBrush();return i.hasOption('hardness')&&(o.hardness=i.getOption('hardness')),o},t.prototype._serializeOperation=function(t,o){return'frame'===t.constructor.identifier?(this._serializeFrameOperation(t,o),null):'overlay'===t.constructor.identifier?(this._serializeOverlayOperation(t,o),null):e.prototype._serializeOperation.call(this,t,o)},t.prototype._serializeFrameOperation=function(e,t){var o=t.filter(function(e){return'sprite'===e.type}),i;o.length?i=o.pop():(i={type:'sprite',options:{sprites:[]}},t.push(i)),i.options.sprites.push({type:'frame',options:this._getFrameOptions(e)})},t.prototype._serializeOverlayOperation=function(e,t){if(e.getIdentifier()){var o=t.filter(function(e){return'sprite'===e.type}),i;o.length?i=o.pop():(i={type:'sprite',options:{sprites:[]}},t.push(i)),i.options.sprites.push({type:'overlay',options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:_.default[e.getBlendMode()]}})}},t.prototype._getFrameOptions=function(e){return{identifier:e.getFrame().identifier}},t.prototype._serializeOrientationOperation=function(t){var o=e.prototype._serializeOrientationOperation.call(this,t);return(90===o.options.rotation||270===o.options.rotation)&&(o.options.flipHorizontally=!o.options.flipHorizontally,o.options.flipVertically=!o.options.flipVertically),o},t.prototype._serializeTransformOperation=function(t){var o=this._editor.operations;if(o.exists('orientation')){t=t.clone();var i=o.get('orientation');t.rotate(-i.getRotation()),i.getFlipVertically()&&(t.flip('vertical'),t.setRotation(-1*t.getRotation())),i.getFlipHorizontally()&&(t.flip('horizontal'),t.setRotation(-1*t.getRotation()))}var r=e.prototype._serializeTransformOperation.call(this,t);return r.type='transform',r},t.prototype._serializeText=function(t,o){var i=e.prototype._serializeText.call(this,t,o),r=t.getInputDimensions(!1);return i.options.fontIdentifier=o.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*r.x/r.min(),delete i.options.fontFamily,i},t.prototype._serializeFilterOperation=function(t){var o=e.prototype._serializeFilterOperation.call(this,t);return o?(o.options.identifier=o.options.name,delete o.options.name,o):null},t.prototype._serializeRadialFocusOperation=function(t){var o=e.prototype._serializeRadialFocusOperation.call(this,t),i=o.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,o},t}(c.default);t.default=u,u.version='2.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(14),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(106),u=i(_),g=o(100),f=i(g),y=o(275),h=i(y),b=o(101),k=i(b),v=o(39),E=i(v),S=o(89),M=i(S),C=o(107),B=i(C),R=o(30),x=i(R),T=m.SDKUtils.flipObject(B.default),P=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,d.default)(this,e.call.apply(e,[this].concat(i)));a._frameManager=new f.default(a._ui,a._getOptions('frame'));var n=a._getOptions('overlay');return n&&(a._overlayManager=new h.default(a._ui,n)),a}return(0,c.default)(t,e),t.prototype._deserializeSprite=function(t,o){return'frame'===o.type?this._deserializeFrame(t,o):'overlay'===o.type?this._deserializeOverlay(t,o):e.prototype._deserializeSprite.call(this,t,o)},t.prototype._deserializeOperation=function(t){return'transform'===t.type?this._deserializeTransformOperation(t):e.prototype._deserializeOperation.call(this,t)},t.prototype._deserializeOrientationOperation=function(t){return(90===t.options.rotation||270===t.options.rotation)&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),e.prototype._deserializeOrientationOperation.call(this,t)},t.prototype._deserializeTransformOperation=function(t){var o=this;return e.prototype._deserializeCropOperation.call(this,t).then(function(e){var t=o._operationsData.orientation;if(t){var i=t.options;e.rotate(i.rotation),i.flipHorizontally&&(e.flip('horizontal'),e.setRotation(-1*e.getRotation())),i.flipVertically&&(e.flip('vertical'),e.setRotation(-1*e.getRotation()))}return e})},t.prototype._deserializeFrame=function(e,t){var o=this,i=t.options.identifier,r=this._frameManager.getFrameByIdentifier(i);if(!r)return m.Log.warn('Deserializer','Unknown frame `'+i+'`. Skipping frame.'),Promise.resolve();var a=new k.default(this._ui,r);return a.load().then(function(){o._editor.operations.getOrCreate('frame',{frame:a.getFrame()})})},t.prototype._deserializeOverlay=function(e,t){var o=this,i=t.options,r=i.blendMode,a=i.intensity,n=i.identifier,s=this._overlayManager.getOverlayByIdentifier(n);if(!s)return m.Log.warn('Deserializer','Unknown overlay `'+n+'`. Skipping overlay.'),Promise.resolve();var l=this._editor.getUI().getAssetPath(s.image);return M.default.load(l).then(function(e){o._editor.operations.getOrCreate('overlay',{alpha:a,identifier:n,blendMode:parseInt(T[r||s.blendMode],10),image:e})})},t.prototype._createBrushForPath=function(t){var o=e.prototype._createBrushForPath.call(this,t);return'undefined'!=typeof t.hardness&&o.hasOption('hardness')&&o.setHardness(t.hardness),o},t.prototype._deserializeSticker=function(e,t){var o=this,i=m.SDK.Operations.SpriteOperation,r=t.options,n=this._stickerManager.getStickerByIdentifier(r.identifier),s=x.default.getURLForSticker(n,'base');if(!n)return m.Log.warn('Deserializer','Unknown sticker `'+r.identifier+'`. Skipping sprite.'),Promise.resolve();var l=e.getInputDimensions(!1);return new Promise(function(t){var d=new window.Image;d.addEventListener('load',function(){var o=i.StickerSprite.prototype.availableOptions.adjustments.structure,s=r.rotation,p=r.flipHorizontally,c=r.flipVertically,_={identifier:r.identifier,image:d,position:m.Vector2.fromObject(r.position),dimensions:m.Vector2.fromObject(r.dimensions).multiply(l.min()),rotation:s,flipHorizontally:p,flipVertically:c,adjustments:{}};'undefined'!=typeof r.adjustments&&['brightness','contrast','saturation'].forEach(function(e){void 0!==(0,a.default)(r.adjustments[e])&&(_.adjustments[e]=r.adjustments[e]+o[e].default)}),'undefined'!=typeof r.tintColor&&'undefined'!=typeof n.tintMode&&(_.tintColor=m.Color.fromArray(r.tintColor),_.tintMode=n.tintMode),t(e.createSticker(_))}),d.crossOrigin='Anonymous',d.src=o._editor.getUI().getAssetPath(s)})},t.prototype._deserializeFilterOperation=function(e){var t=this,o=e.options;return this._filterManager.getFilterByIdentifier(o.identifier)?this._filterManager.instantiateFilterWithIdentifier(o.identifier).then(function(e){var i=t._editor.operations.getOrCreate('filter');i.set({identifier:o.identifier,filter:e,intensity:o.intensity})}):(m.Log.warn('Deserializer','Unknown filter `'+o.identifier+'`'),Promise.resolve())},t.prototype._deserializeFocusOperation=function(t){var o=t.options,i=o.options,r=o.type;if('radial'!==r)return e.prototype._deserializeFocusOperation.call(this,t);var a=i.start,n=i.end,s=i.gradientRadius,l=i.blurRadius,d=m.Vector2.fromObject(n).subtract(m.Vector2.fromObject(a)).len();this._editor.operations.getOrCreate('radial-focus',{position:m.Vector2.fromObject(a),radius:d,gradientRadius:s,blurRadius:l})},t.prototype._deserializeText=function(e,t){var o=t.options,i=o.fontSize,r=o.lineHeight,a=o.fontIdentifier,n=o.alignment,s=o.rotation,l=o.maxWidth,d=o.color,p=o.backgroundColor,c=new E.default(this._ui),_=this._fontManager.getVariationByIdentifier(a);return _?c.setFonts([_.getFont()]):_=this._fontManager.getDefaultFont(),c.load().then(function(){var t=e.getInputDimensions(!1),a=l*t.min()/t.x;return e.createText({fontSize:i,lineHeight:r,fontFamily:_.getFontFamily(),fontWeight:_.getFontWeight(),fontIdentifier:_.getIdentifier(),alignment:n,rotation:s,maxWidth:a,text:o.text,color:m.Color.fromArray(d),backgroundColor:m.Color.fromArray(p),position:m.Vector2.fromObject(o.position)})})},t}(u.default);t.default=P,P.version='2.0.0'},function(e,t,o){e.exports={default:o(111),__esModule:!0}},function(e,t,o){e.exports=!o(18)&&!o(26)(function(){return 7!=Object.defineProperty(o(73)('div'),'a',{get:function(){return 7}}).a})},function(e,t,o){var i=o(25),r=o(12).document,a=i(r)&&i(r.createElement);e.exports=function(e){return a?r.createElement(e):{}}},function(e,t,o){'use strict';var i=o(45),r=o(16),a=o(75),n=o(21),s=o(19),l=o(22),d=o(117),p=o(51),c=o(122),m=o(8)('iterator'),_=!([].keys&&'next'in[].keys()),u='keys',g='values',f=function(){return this};e.exports=function(e,t,o,y,h,b,k){d(o,t,y);var v=function(e){return!_&&e in C?C[e]:e===u?function(){return new o(this,e)}:e===g?function(){return new o(this,e)}:function(){return new o(this,e)}},E=t+' Iterator',S=h==g,M=!1,C=e.prototype,B=C[m]||C['@@iterator']||h&&C[h],R=B||v(h),x=h?S?v('entries'):R:void 0,T='Array'==t?C.entries||B:B,P,D,O;if(T&&(O=c(T.call(new e)),O!==Object.prototype&&(p(O,E,!0),!i&&!s(O,m)&&n(O,m,f))),S&&B&&B.name!==g&&(M=!0,R=function(){return B.call(this)}),(!i||k)&&(_||M||!C[m])&&n(C,m,R),l[t]=R,l[E]=f,h)if(P={values:S?R:v(g),keys:b?R:v(u),entries:x},k)for(D in P)D in C||a(C,D,P[D]);else r(r.P+r.F*(_||M),t,P);return P}},function(e,t,o){e.exports=o(21)},function(e,t,o){var r=o(19),a=o(20),n=o(119)(!1),i=o(48)('IE_PROTO');e.exports=function(e,t){var o=a(e),s=0,l=[],d;for(d in o)d!=i&&r(o,d)&&l.push(d);for(;t.length>s;)r(o,d=t[s++])&&(~n(l,d)||l.push(d));return l}},function(e,t,o){var i=o(47);e.exports=Object('z').propertyIsEnumerable(0)?Object:function(e){return'String'==i(e)?e.split(''):Object(e)}},function(e,t,o){var i=o(43);e.exports=function(e){return 0<e?p(i(e),9007199254740991):0}},function(e,t,o){var i=o(76),r=o(50).concat('length','prototype');t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t,o){var i=o(33),r=o(27),a=o(20),n=o(42),s=o(19),l=o(72),d=Object.getOwnPropertyDescriptor;t.f=o(18)?d:function(e,t){if(e=a(e),t=n(t,!0),l)try{return d(e,t)}catch(t){}return s(e,t)?r(!i.f.call(e,t),e[t]):void 0}},function(e,t,o){if('production'!=={ENV:'"production"'}.NODE_ENV){var i='function'==typeof Symbol&&Symbol.for&&Symbol.for('react.element')||60103,r=function(e){return'object'==typeof e&&null!==e&&e.$$typeof===i};e.exports=o(145)(r,!0)}else e.exports=o(147)()},function(e,t,o){'use strict';var i=o(58),r=i;'production'!=={ENV:'"production"'}.NODE_ENV&&function(){var e=function(e){for(var t=arguments.length,o=Array(1<t?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];var r=0,a='Warning: '+e.replace(/%s/g,function(){return o[r++]});'undefined'!=typeof console&&console.error(a);try{throw new Error(a)}catch(e){}};r=function(t,o){if(o===void 0)throw new Error('`warning(condition, format, ...args)` requires a warning message argument');if(0!==o.indexOf('Failed Composite propType: ')&&!t){for(var i=arguments.length,r=Array(2<i?i-2:0),a=2;a<i;a++)r[a-2]=arguments[a];e.apply(void 0,[o].concat(r))}}}(),e.exports=r},function(e,t){var o,i;/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){'use strict';function r(){for(var e=[],t=0,o;t<arguments.length;t++)if(o=arguments[t],o){var i=typeof o;if('string'==i||'number'==i)e.push(o);else if(Array.isArray(o))e.push(r.apply(null,o));else if('object'==i)for(var n in o)a.call(o,n)&&o[n]&&e.push(n)}return e.join(' ')}var a={}.hasOwnProperty;'undefined'!=typeof e&&e.exports?e.exports=r:(o=[],i=function(){return r}.apply(t,o),!(i!==void 0&&(e.exports=i)))})()},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(40),s=i(n),l=function(){function e(t,o,i){(0,a.default)(this,e),this._parent=t,this._type=o,this._name=i}return e.prototype.element=function(t){return new e(this,'element',t)},e.prototype.modifier=function(t){return new e(this,'modifier',t)},(0,s.default)(e,[{key:'str',get:function(){var e=this._parent?this._parent.str:'';switch(this._type){case'block':e+=''+'pesdk-react-'+this._name;break;case'element':e+=''+'__'+this._name;break;case'modifier':e+=''+'--'+this._name;}return e}}]),e}();t.default={block:function(e){return new l(null,'block',e)}}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}function r(e){for(var t=[],o=0;o<e.length;o++)e[o]instanceof Array?t=t.concat(r(e[o])):t.push(e[o]);return t}Object.defineProperty(t,'__esModule',{value:!0});var a=o(148),n=i(a),s=o(14),l=i(s),d=o(57),p=i(d),c=o(83),m=i(c),_=o(84),u=i(_),g={b:'block',e:'element',m:'modifier'};t.default={_parseBemSpecifier:function(e){if(!e)return[];var t=e.split(' '),o=t.map(function(e){var t=e.match(/^(\$)?([bem]):(.*)$/i);if(!t)throw new Error('Invalid BEM specifier: '+e);var o='undefined'!=typeof t[1],i=g[t[2]],r=t[3];return{type:i,name:r,pass:o}});return o},_getBemInfoForNode:function(e){var t='bem'===e.type,o=t?e.props.specifier:e.props.bem;if(t&&!o)throw new Error('<bem> elements should always have a `specifier` property');var i=this._parseBemSpecifier(o);return t&&i.forEach(function(e){e.pass=!0}),{data:i,isBemNode:t}},createElement:function(e,t){for(var o=arguments.length,i=Array(2<o?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];return t=t||{},i=i.filter(function(e){return null!==e&&'undefined'!=typeof e}),{type:e,props:t,children:i}},_isNodeBEMable:function(e){return null!==e&&'object'===('undefined'==typeof e?'undefined':(0,l.default)(e))&&!p.default.isValidElement(e)},_applyBEMClasses:function(e){var t=this;if(!this._isNodeBEMable(e))return e;var o=e.props.className?[e.props.className]:[],i=this._getBemInfoForNode(e),a=e.props.__bemObject,n=e.props.__bemObject;i.data.forEach(function(e){if('block'===e.type)a=u.default.block(e.name),e.pass&&(n=u.default.block(e.name)),o.push(a.str);else if('element'===e.type){if(!a)throw new Error('Tried to create an element, but no parent block has been found.');a=a.element(e.name),e.pass&&(n=n.element(e.name)),o.push(a.str)}else if('modifier'===e.type){if(!a)throw new Error('Tried to create a modifier, but no parent block has been found.');e.pass&&(n=n.modifier(e.name)),o.push(a.modifier(e.name).str)}});var s=(0,m.default)(o);return s&&(e.props.className=s),e.children=r(e.children),e.children.forEach(function(e){t._isNodeBEMable(e)&&(e.props.__bemObject=n)}),e.children=e.children.map(function(e){return t._applyBEMClasses(e)}),e.children=r(e.children),delete e.props.__bemObject,delete e.props.bem,i.isBemNode&&(e.children instanceof Array&&1===e.children.length?e=e.children[0]:e=e.children),e},_transformToReact:function(e){var t=this;return this._isNodeBEMable(e)?(e.children=e.children.map(function(e){return t._transformToReact(e)}),p.default.createElement.apply(p.default,[e.type,e.props].concat((0,n.default)(e.children)))):e},transform:function(e){return(e=this._applyBEMClasses(e),e instanceof Array)?e:(e=this._transformToReact(e),e)}}},function(e,t,o){var i=o(87),r=o(8)('iterator'),a=o(22);e.exports=o(7).getIteratorMethod=function(e){if(e!=void 0)return e[r]||e['@@iterator']||a[i(e)]}},function(e,t,o){var i=o(47),r=o(8)('toStringTag'),a='Arguments'==i(function(){return arguments}()),n=function(e,t){try{return e[t]}catch(t){}};e.exports=function(e){var t,o,s;return e===void 0?'Undefined':null===e?'Null':'string'==typeof(o=n(t=Object(e),r))?o:a?i(t):'Object'==(s=i(t))&&'function'==typeof t.callee?'Arguments':s}},function(e,t,o){'use strict';(function(e){Object.defineProperty(t,'__esModule',{value:!0});var o='warn',i=[{type:'trace',background:'#EEEEEE',color:'#AAAAAA'},{type:'info',background:'#BDE5F8',color:'#00529B'},{type:'warn',background:'#FEEFB3',color:'#9F6000'},{type:'error',background:'#FFBABA',color:'#D8000C'},{type:'log',background:'#EEEEEE',color:'#1f4f6b'}],r=i.map(function(e){return e.type}),a={};a.setLevel=function(e){o=e},a.canLog=function(e){if(null===o)return!1;var t=r.indexOf(e),i=r.indexOf(o);return!(t<i)},a.hasColorfulOutput=function(){return(!e||e&&e.browser)&&'undefined'!=typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/)},a.printError=function(t){var e=t.stack.split('\n');e.forEach(function(e){a.error('Error',e)})},i.forEach(function(e){var t=e.type,o=e.background,i=e.color;a[t]=function(e){if('undefined'!=typeof console&&a.canLog(t)){for(var r=arguments.length,n=Array(1<r?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];var l=n.map(function(e){return'string'==typeof e?e:e.toString()}).join(' ');return a.hasColorfulOutput()?void console.log('%c  %c PhotoEditorSDK %c  %c '+e+' %c  '+l+'  %c  ','background: #2D7BFF; line-height: 20px; padding: 4px 0','background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0','background: #2D7BFF; line-height: 20px; padding: 4px 0','background: '+o+'; color: '+i+'; line-height: 20px; padding: 4px 0; font-weight: bold','background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0','background: #2D7BFF; line-height: 20px; padding: 4px 0'):console.log('PhotoEditorSDK | '+e+' | '+l)}}}),t.default=a}).call(t,o(61))},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.default={load:function(e){return new Promise(function(t,o){var i=new window.Image;i.addEventListener('load',function(){t(i)}),i.addEventListener('error',function(){o(new Error('Failed to load image at '+e))}),i.src=e})},loadXHR:function(e,t){return new Promise(function(o,i){var r;window.XDomainRequest?(r=new window.XDomainRequest,t&&r.overrideMimeType(t),r.onload=function(){o(r)},r.onerror=function(t){i(t)}):window.XMLHttpRequest&&(r=new window.XMLHttpRequest,t&&r.overrideMimeType(t),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?o(r):i(new Error('HTTP Status '+r.status)))}),r.open('GET',e,!0),r.send()})}}},function(e,t,o){(function(t){(function(){var o,i,r;'undefined'!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:'undefined'!=typeof t&&null!==t&&t.hrtime?(e.exports=function(){return(o()-r)/1e6},i=t.hrtime,o=function(){var e;return e=i(),1e9*e[0]+e[1]},r=o()):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(this)}).call(t,o(61))},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onClick'),n}return(0,d.default)(t,e),t.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.searchSuggestion)},t.prototype.renderWithBEM=function(){var e=this.props.searchSuggestion,t={backgroundImage:'url('+e.coverImage+')'};return p.ReactBEM.createElement('bem',{specifier:'b:photoRoll e:libraryList'},p.ReactBEM.createElement('li',{bem:'e:item',style:t,onClick:this._onClick},p.ReactBEM.createElement('div',{bem:'e:overlay'}),p.ReactBEM.createElement('div',{bem:'e:name'},e.query)))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(5),m=i(c),_=o(200),u=i(_),g=o(6),f=i(g),y=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._needsStyleFixes=!0,n._totalPhotosHeight=0,n.state={loading:!1,photos:[]},n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._loadPhotos()},t.prototype.componentDidUpdate=function(){this.refs.scrollbar&&this.refs.scrollbar.update()},t.prototype._onPhotoClicked=function(e){this.props.onPhotoClicked&&this.props.onPhotoClicked(e)},t.prototype._getHeadline=function(){return this.props.library.name},t.prototype.fixStyles=function(){if(p.Utils.Browser.isIElte(11)){var e=this.refs.cell,t=this.refs.scrollbar.getList();if(!(e&&t))return;var o=e.offsetHeight;t.style.height=o+'px'}this.refs.scrollbar&&this.refs.scrollbar.update()},t.prototype._renderColumns=function(){for(var e=this,t=this.state.photos,o=3,r=[],a=[],n=0;n<o;n++)a.push([]),r.push(0);return t.forEach(function(t){for(var i=t.dimensions,n=null,s=Infinity,l=0;l<o;l++)r[l]<s&&(n=l,s=r[l]);a[n].push(p.ReactBEM.createElement(u.default,{photo:t.obj,onClick:e._onPhotoClicked.bind(e,t.obj)})),r[n]+=i.y}),a},t.prototype._renderPhotos=function(){var e=this._renderColumns();return p.ReactBEM.createElement('div',{bem:'$b:photoRoll e:row m:fullHeight'},p.ReactBEM.createElement('div',{bem:'e:cell',ref:'cell'},p.ReactBEM.createElement(f.default,{direction:'vertical',ref:'scrollbar'},p.ReactBEM.createElement('div',{bem:'e:container',ref:'container'},p.ReactBEM.createElement('div',{bem:'e:innerContainer'},p.ReactBEM.createElement('div',{bem:'e:headline'},this._getHeadline()),p.ReactBEM.createElement('bem',{specifier:'e:photoList'},e.map(function(e){return p.ReactBEM.createElement('ul',{bem:'$e:list'},e)})))))))},t.prototype._loadPhotos=function(){var t=this;this._totalPhotosHeight=0;var o=m.default.instance.displayProgress(this._t('loading.loading')),e=this.context.options.photoRoll.provider,i=new e;i.getPhotosForLibrary(this.props.library).then(function(e){return t._preloadPhotos(e,o)}).then(function(e){t.setState({photos:e,loading:!1}),o.close()}).catch(function(i){o.close(),m.default.instance.displayError(t._t('errors.photoRollLoadFail.title'),t._t('errors.photoRollLoadFail.text',{error:i.message}))})},t.prototype._preloadPhotos=function(e,t){var o=this,i=e.length,r=0;return Promise.all(e.map(function(e){return o._preloadPhoto(e).then(function(a){var n=new p.Vector2(a.width,a.height);return n.multiply(240/a.width),o._totalPhotosHeight+=n.y,r++,t.setData({progress:r/i}),{obj:e,dimensions:n}})}))},t.prototype._preloadPhoto=function(e){return new Promise(function(t){var o=new window.Image;o.addEventListener('load',function(){t(o)}),o.addEventListener('error',function(){t(o)}),o.crossOrigin='Anonymous',o.src=e.urls.thumb})},t.prototype.renderWithBEM=function(){return this.state.loading?p.ReactBEM.createElement('div',null):this._renderPhotos()},t}(p.BaseComponent);t.default=y,y.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(9),m=i(c),_=o(6),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._hasBackButton=!1,n}return(0,d.default)(t,e),t.prototype._onItemClick=function(e){this.props.onSwitchControls(e)},t.prototype._renderListItems=function(){var e=this,t=this.context.editor,o=[],i=function(o){var i=t.controls.get(o);return p.ReactBEM.createElement('li',{bem:'e:item',key:i.identifier,"data-identifier":i.identifier,onClick:e._onItemClick.bind(e,i)},p.ReactBEM.createElement('bem',{specifier:'$b:controls'},p.ReactBEM.createElement('div',{bem:'$e:button m:withLabel'},p.ReactBEM.createElement('img',{bem:'e:icon',src:e._getAssetPath(i.iconPath,!0)}),p.ReactBEM.createElement('div',{bem:'e:label'},e._t(i.languageKey)))))},r=this.context.options.editor.controlsOrder;r.forEach(function(e){if(Array.isArray(e)){var r=[];e.forEach(function(e){t.controls.isEnabled(e)&&r.push(i(e))}),r.length&&o.push(r)}else{var a=e;if(!t.controls.isEnabled(a))return;o.push(i(a))}});var a=[];return o.forEach(function(e){a=a.concat(e),e!==o[o.length-1]&&a.push(p.ReactBEM.createElement('li',{bem:'e:separator'}))}),a},t.prototype.renderControls=function(){var e=this._renderListItems();return p.ReactBEM.createElement('div',{bem:'e:cell m:list'},p.ReactBEM.createElement(u.default,null,p.ReactBEM.createElement('ul',{bem:'$e:list'},e)))},t}(m.default);t.default=g,g.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(216),m=i(c),_=o(218),u=i(_),g=o(219),f=i(g),y=o(220),h=i(y),b=o(264),k=i(b),v=o(265),E=i(v),S=o(266),M=i(S),C=function(e){function t(o,i,r){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];(0,a.default)(this,t);var l=(0,s.default)(this,e.call(this));return l._ui=o,l._options=i,l._mediator=r,l._ready=!1,l._padding=[0,0,0,0],l._shallow=n,n||(l._initSDK(),l._onZoom=l._onZoom.bind(l),l._onUndo=l._onUndo.bind(l),l.operations=new f.default(l,l._sdk,l._mediator),l.history=new M.default(l,l._sdk,l._mediator),l.history.on('undo',l._onUndo),l.zoom=new E.default(l,l._sdk,l._mediator),l.zoom.on('set',l._onZoom),l._initSerializers()),l.controls=new h.default(l,l._sdk,l._mediator),l.features=new k.default(l,l._sdk,l._mediator),l._running=!1,l._renderRequested=!0,l._renderCallbacks=[],l._animationFrameRequest=null,l.render=l.render.bind(l),l._tick=l._tick.bind(l),l}return(0,d.default)(t,e),t.prototype.setImage=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,i=this._sdk.getRenderer(),r=new p.Vector2(t.naturalWidth,t.naturalHeight),a=1e6*this.getMaxMegapixels(),n=i.getMaxDimensions();o&&this.reset();var s=new u.default(t,a,n),l=null,d=function(t){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;e._setImage(t,l,o),e._initWatermark(),e._ready=!0,e.emit('ready')};s.needsResize()?(this.emit('resize'),l=this._sdk.parseExif(t),s.resize().then(function(t){var o=t.canvas,i=t.dimensions,r=t.reason;o.src='data:image/jpeg;base64,',e.emit('resized',{dimensions:i,reason:r}),d(o,i,r)})):d(t)},t.prototype._initWatermark=function(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate('watermark',{image:this._options.editor.watermarkImage}))},t.prototype._initSDK=function(){var e=this._options,t=e.logLevel,o=e.displayWelcomeMessage,i=e.debug,r=e.license,a=this._options.editor,n=a.smoothDownscaling,s=a.smoothUpscaling,l=a.preferredRenderer,d=a.pixelRatio;this._sdk=new p.SDK(l,{logLevel:t,debug:i,displayWelcomeMessage:o,pixelRatio:d,smoothDownscaling:n,smoothUpscaling:s,transparent:!0,license:r})},t.prototype._onZoom=function(){var e=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.fixOffset(),this.render(function(){e._mediator.emit(p.Constants.EVENTS.ZOOM_DONE),t&&t()})},t.prototype._onUndo=function(){this.render()},t.prototype.getRotation=function(){return this._sdk.getRotation()},t.prototype.setRotation=function(e){this._sdk.setRotation(e)},t.prototype.getSpriteScale=function(){return this._sdk.getSpriteScale()},t.prototype.setSpriteScale=function(e){this._sdk.setSpriteScale(e)},t.prototype.isToolAllowed=function(e){return!!this._shallow||this._sdk._l.isToolAllowed(e)},t.prototype.isToolEnabled=function(e){return-1!==this._options.editor.tools.indexOf(e)},t.prototype.getMaxMegapixels=function(){var e=this._options.editor.maxMegaPixels;return p.Utils.isMobile()?e.mobile:e.desktop},t.prototype.getOutputDimensions=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputDimensions(e)},t.prototype.getOutputTextureDimensions=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputTextureDimensions(e)},t.prototype.getFinalDimensions=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._sdk.getFinalDimensions(e)},t.prototype.getCanvasDimensions=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,t=this._sdk.getCanvas(),o=new p.Vector2(t.offsetWidth,t.offsetHeight);return e&&o.subtract(this._padding[1]+this._padding[3],this._padding[0]+this._padding[2]),o},t.prototype._setImage=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t,o),this.zoom.set('auto'),this.emit('new-image')},t.prototype.export=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty();var o=this._options.editor.export,i=new m.default(this._sdk,o,t);return i.export().then(function(t){return e.emit('export',t),e._mediator.emit(p.Constants.EVENTS.EXPORT,t,e),e._watermarkOperation&&(e._watermarkOperation.setEnabled(!0),e._sdk.render()),e._sdk.setAllOperationsToDirty(),t})},t.prototype._initSerializers=function(){this._serializers={"1.0.0":o(267).default,"1.0.1":o(273).default,"2.0.0":o(274).default,"2.0.1":o(276).default,"3.0.0":o(279).default}},t.prototype.serialize=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'3.0.0',o=this._serializers[t];if(!o)return p.Promise.reject(new Error('No serializer for version '+t+' found.'));var i=new o(this);return i.serialize(e)},t.prototype.deserialize=function(e){var t=this,o=this._serializers[e.version];if(!o)return p.Promise.reject(new Error('No serializer for version '+e.version+' found.'));var i=new o(this);return i.deserialize(e).then(function(){t.zoom.set('auto')})},t.prototype._applyOffset=function(){var e=this._offset.clone();e.x-=this._padding[1]/2,e.x+=this._padding[3]/2,e.y-=this._padding[2]/2,e.y+=this._padding[0]/2,this._sdk.setOffset(e)},t.prototype.start=function(){this.zoom.set('auto'),this._animationFrameRequest=(0,p.requestAnimationFrame)(this._tick)},t.prototype.stop=function(){this._running=!1,this._animationFrameRequest&&((0,p.cancelAnimationFrame)(this._animationFrameRequest),this._renderCallbacks=[])},t.prototype.render=function(e){this._renderRequested=!0,e&&this._renderCallbacks.push(e)},t.prototype.setOffset=function(e){this._offset=this._clampOffset(e)},t.prototype.getOffset=function(){return this._offset},t.prototype.fixOffset=function(){this.setOffset(this._sdk.getOffset())},t.prototype._clampOffset=function(e){var t=this._sdk.getRenderer(),o=new p.Vector2(t.getWidth(),t.getHeight()),i=this._sdk.getOutputDimensions(!1),r=o.clone().subtract(i).divide(2).clamp(null,new p.Vector2(0,0)),a=i.clone().subtract(o).divide(2).clamp(new p.Vector2(0,0),null),n=e.clone().clamp(r,a).round();return n},t.prototype._tick=function(){var e=this;if(this._renderRequested){var t=this._renderCallbacks.slice(0);this._renderCallbacks=[],this._render().then(function(){t.forEach(function(e){return e()}),e._animationFrameRequest=(0,p.requestAnimationFrame)(e._tick)}).catch(function(t){p.Log.printError(t)}),this._renderRequested=!1}else this._animationFrameRequest=(0,p.requestAnimationFrame)(this._tick)},t.prototype._render=function(){var t=this;return this._ready?(this._applyOffset(),this._sdk.render().then(function(){t._lastOutputBounds=t._sdk.getSprite().getBounds()}).catch(function(o){t.emit('render-error',o)})):p.Promise.resolve()},t.prototype.reset=function(){this._sdk.reset(),this.history.reset(),this.operations.reset()},t.prototype.dispose=function(){this.stop(),this._sdk.dispose()},t.prototype.isReady=function(){return this._ready},t.prototype.getRenderer=function(){return this._sdk.getRenderer()},t.prototype.getSDK=function(){return this._sdk},t.prototype.getInputDimensions=function(){return this._sdk.getInputDimensions(!1)},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e?e:[0,0,0,0]},t.prototype.getImage=function(){return this._options.editor.image},t.prototype.getOptions=function(){return this._options},t.prototype.getUI=function(){return this._ui},t.prototype.broadcastTransform=function(e,t){var o=this,i=new p.SDK.Operations.TransformOperation.TransformChange(e,t);['sprite','selective-blur','radial-focus','mirrored-focus','linear-focus','blur'].forEach(function(e){var t=o.operations.get(e);t&&t.transform(i)})},t.prototype.broadcastFlip=function(e){var t=this;['mirrored-focus','radial-focus','sprite','selective-blur'].forEach(function(o){var i=t.operations.get(o);i&&i.flip(e)})},t.prototype.broadcastRotate=function(e){var t=this;['transform','mirrored-focus','radial-focus','sprite','selective-blur'].forEach(function(o){var i=t.operations.get(o);i&&i.rotate(e)})},t}(p.EventEmitter);t.default=C},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(221);Object.defineProperty(t,'adjustments',{enumerable:!0,get:function(){return i(r).default}});var a=o(224);Object.defineProperty(t,'transform',{enumerable:!0,get:function(){return i(a).default}});var n=o(228);Object.defineProperty(t,'filter',{enumerable:!0,get:function(){return i(n).default}});var s=o(231);Object.defineProperty(t,'focus',{enumerable:!0,get:function(){return i(s).default}});var l=o(236);Object.defineProperty(t,'sticker',{enumerable:!0,get:function(){return i(l).default}});var d=o(244);Object.defineProperty(t,'text',{enumerable:!0,get:function(){return i(d).default}});var p=o(254);Object.defineProperty(t,'brush',{enumerable:!0,get:function(){return i(p).default}});var c=o(258);Object.defineProperty(t,'selectiveBlur',{enumerable:!0,get:function(){return i(c).default}});var m=o(261);Object.defineProperty(t,'frame',{enumerable:!0,get:function(){return i(m).default}})},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(230),m=i(c),_=function(e){function t(){(0,a.default)(this,t);var o=(0,s.default)(this,e.call(this));return o._bindAll('_onButtonClick'),o.state={overlayVisible:!1},o}return(0,d.default)(t,e),t.prototype._onButtonClick=function(t){t.preventDefault(),t.stopPropagation(),this.setState({overlayVisible:!this.state.overlayVisible})},t.prototype.renderWithBEM=function(){var e=null;this.state.overlayVisible&&(e=p.ReactBEM.createElement(m.default,{items:this.props.items,selectedItem:this.props.selectedItem,onChange:this.props.onChange}));var t=this.state.overlayVisible?'is-active':null;return p.ReactBEM.createElement('bem',{specifier:'$b:controls'},p.ReactBEM.createElement('div',{bem:'$e:categoryDropdown',className:t,onClick:this._onButtonClick},p.ReactBEM.createElement('img',{bem:'e:icon',src:this.props.selectedItem.icon}),p.ReactBEM.createElement('div',{bem:'e:label'},this.props.selectedItem.label),e))},t}(p.BaseComponent);t.default=_,_.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.componentDidUpdate=function(){this._renderCanvas()},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=this.context.editor,o=t.getSDK(),i=o.getPixelRatio();e.width=e.offsetWidth*i,e.height=e.offsetHeight*i,e.style.width=e.offsetWidth+'px',e.style.height=e.offsetHeight+'px';var r=e.getContext('2d');r.fillStyle='red',r.clearRect(0,0,e.width,e.height),r.font=(this.props.fontStyle||'')+' '+(this.props.fontWeight||'')+' '+24*i+'px '+this.props.fontFamily,r.textBaseline='middle',r.textAlign='center',r.fillStyle='white',r.fillText('Abc',e.width/2,e.height/2)},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('canvas',{bem:'b:fontFamily e:canvas',ref:'canvas'})},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(1),s=o(253),l=i(s),d=o(99),p=i(d),c=function(){function e(t,o){(0,a.default)(this,e),this._ui=t,this._options=o,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}return e.prototype._initFonts=function(){var e=this,t=this._options,o=t.fonts,i=t.replaceFonts,r=t.availableVariations,a=n.Constants.DEFAULTS.FONTS;a=i?o:a.concat(o||[]);var s;a=a.map(function(t){var o=t.fontFamily,i=t.variations;if(r&&(i=i.filter(function(e){return-1!==r.indexOf(e.identifier)})),0===i.length)return null;var a=new l.default({fontFamily:o});return i=i.map(function(t){var i=new p.default(t);return i.setFontFamily(o),i.setFont(a),t.default&&!s&&(s=i),e._variationsByIdentifier[i.getIdentifier()]=i,i}),a.setVariations(i),e._fontsByFontFamily[o]=a,a}).filter(function(e){return e}),s||(s=a[0].getVariations()[0]),this._defaultVariation=s,this._fonts=a},e.prototype.getFonts=function(){return this._fonts},e.prototype.getFontByFontFamily=function(e){return this._fontsByFontFamily[e]},e.prototype.getVariationByIdentifier=function(e){return this._variationsByIdentifier[e]},e.prototype.getDefaultVariation=function(){return this._defaultVariation},e}();t.default=c},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=p.SDK.OptionType,m={100:'Extra Light',200:'Light',300:'Book',400:'Regular',500:'Medium',600:'Semibold',700:'Bold',800:'Black',900:'Extra Black',bold:'Bold',normal:'Regular'},_=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.getLabel=function(){var e=m[this._options.fontWeight];switch(this._options.fontStyle){case'italic':e+=' Italic';}return e},t}(p.SDK.Configurable);t.default=_,_.prototype.availableOptions={identifier:{type:c.STRING,required:!0},fontFamily:{type:c.STRING,required:!0},fontWeight:{type:c.ALL,default:400},fontStyle:{type:c.STRING,default:'normal'},provider:{type:c.STRING,available:['google','file']},filePath:{type:c.STRING},default:{type:c.BOOLEAN,default:!1},font:{type:c.OBJECT}}},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t,o){(0,r.default)(this,e),this._ui=t,this._options=o,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(a.SharedConstants.DEFAULTS.FRAME_CATEGORIES);var i=this._options,n=i.categories,s=i.replaceCategories;this._options.categories?this._addCategories(n,s):this._updateAllCategory()}return e.prototype._addCategories=function(e){var t=this,o=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._categories=o?e.slice(0):a.Utils.mergeCategories(this._categories,e,'frames'),this._categoriesById={},this._categories.forEach(function(e){t._categoriesById[e.identifier]=e});var i=this._options.availableFrames;i&&this._categories.forEach(function(e){e.frames=e.frames.filter(function(e){return-1!==i.indexOf(e.identifier)})}),this._categories.forEach(function(e){e.frames.forEach(function(e){t._framesById[e.identifier]=e})}),this._updateAllCategory()},e.prototype._updateAllCategory=function(){this._allCategory={identifier:'all',defaultName:'All',frames:this._categories.map(function(e){return e.frames}).reduce(function(e,t){return e.concat(t)},[])},this._categoriesById.all=this._allCategory},e.prototype.getFramesForCategory=function(e){if(!this._categoriesById[e])throw new Error('Unknown frame category \''+e+'\'');return this._categoriesById[e].frames},e.prototype.getFrameByIdentifier=function(e){return this._framesById[e]},e.prototype.getCategories=function(){return this._categories},e.prototype.getCategory=function(e){return this._categoriesById[e]},e}();t.default=n},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=p.SDK.OptionType,m=function(e){function t(o){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,t);var r=(0,s.default)(this,e.call(this,i));return r._loaded=!1,r._loading=!1,r._ui=o,r._frame=p.SDK.Utils.deepClone(r._options),r}return(0,d.default)(t,e),t.prototype.load=function(){var e=this;if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error('Called Frame#load while it\'s already loading'));this._loading=!0;var t=this._frame.imageGroups,o=[];return['top','left','right','bottom'].forEach(function(i){if(i in t){var r=t[i];['start','mid','end'].forEach(function(t){t in r&&o.push(e._loadPart(i,t))})}}),Promise.all(o).then(function(){e._loaded=!0,e._loading=!1}).catch(function(){e._loaded=!1,e._loading=!1})},t.prototype._loadPart=function(e,t){var o=this;return new Promise(function(i,r){var a=o._frame.imageGroups,n=a[e][t],s=n;'string'!=typeof n&&'image'in n&&(s=n.image);var l=new window.Image;l.addEventListener('load',function(){'string'==typeof n?o._frame.imageGroups[e][t]=l:o._frame.imageGroups[e][t].image=l,i(l)}),l.addEventListener('error',function(){r(new Error('Failed to load image at '+s))}),l.crossOrigin='Anonymous',l.src=o._ui.getAssetPath(s)})},t.prototype.getFrame=function(){return this._frame},t}(p.SDK.Configurable);t.default=m,m.prototype.availableOptions={identifier:{type:c.STRING,required:!0},defaultName:{type:c.STRING},thumbnail:{type:c.STRING},tintable:{type:c.BOOLEAN,default:!1},layoutMode:{type:c.STRING,default:'horizontal-inside',available:['horizontal-inside','vertical-inside']},imageGroups:{type:c.OBJECT,required:!0}}},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),s=2*n,l=function(){function e(t){(0,r.default)(this,e),this._editor=t,this._serializeOperations=this._serializeOperations.bind(this)}return e.prototype.serialize=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._options=a.SDKUtils.defaults(e,{image:!0});var t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)},e.prototype._serializeInputImage=function(e){var t=this._editor.getImage(),o=t.width,i=t.height;if(!this._options.image)return e.inputImage={width:o,height:i},Promise.resolve(e);var r=a.SDKUtils.createCanvas();r.width=t.width,r.height=t.height;var n=r.getContext('2d');n.drawImage(t,0,0);var s=r.toDataURL(a.ImageFormat.PNG);return e.inputImage={type:a.ImageFormat.PNG,data:s.replace(/^data:image\/(.*?);base64,/,''),width:o,height:i},Promise.resolve(e)},e.prototype._serializeOperations=function(e){var t=this,o=[],i=this._editor.operations.getStack();return i.forEach(function(e){var i=t._serializeOperation(e,o);i&&o.push(i)}),e.operations=o.filter(function(e){return e}),Promise.resolve(e)},e.prototype._serializeOperation=function(e,t){switch(e.constructor.identifier){case'transform':return this._serializeTransformOperation(e);case'orientation':return this._serializeOrientationOperation(e);case'filter':return this._serializeFilterOperation(e);case'adjustments':return this._serializeAdjustmentsOperation(e);case'sprite':return this._serializeSpriteOperation(e,t);case'radial-focus':return this._serializeRadialFocusOperation(e);case'mirrored-focus':return this._serializeLinearFocusOperation(e);default:a.Log.warn('Unable to serialize operation of type '+e.constructor.identifier);}},e.prototype._serializeTransformOperation=function(e){var t=e.serializeOptions(['start','end','rotation'],!0);return t.rotation=(t.rotation+s)%s,{type:'crop',options:t}},e.prototype._serializeOrientationOperation=function(e){return{type:'orientation',options:e.serializeOptions(['flipVertically','flipHorizontally','rotation'],!0)}},e.prototype._serializeFilterOperation=function(e){return'identity'===e.getIdentifier()?null:{type:'filter',options:{intensity:e.getIntensity(),name:e.getIdentifier()}}},e.prototype._serializeAdjustmentsOperation=function(e){var t=e.availableOptions,o={};return['brightness','saturation','contrast','exposure','shadows','highlights','clarity'].forEach(function(i){var r=t[i],a=e.getOption(i),n=r.minValue,s=r.midValue,l=r.maxValue;o[i]=a<=s?(a-n)/(s-n)-1:(a-s)/(l-s)}),{type:'adjustments',options:o}},e.prototype._serializeSpriteOperation=function(e,t){var o=this,i=t.filter(function(e){return'sprite'===e.type}),r=!0,a;if(i.length?(a=i.pop(),r=!1):a={type:'sprite',options:{sprites:[]}},e.getSprites().forEach(function(t){var i=null;t instanceof e.constructor.StickerSprite?i=o._serializeSticker(e,t):t instanceof e.constructor.TextSprite?i=o._serializeText(e,t):t instanceof e.constructor.BrushSprite&&(i=o._serializeBrush(e,t)),i&&a.options.sprites.push(i)}),r)return a},e.prototype._serializeSticker=function(e,t){var o=t.getAdjustments(),i=t.serializeOptions(['identifier','position','dimensions','flipVertically','flipHorizontally','rotation'],!0);i.name=i.identifier,delete i.identifier,i.rotation=(i.rotation+s)%s;var r=o.availableOptions;return i.adjustments={brightness:o.getBrightness()-r.brightness.default,saturation:o.getSaturation()-r.saturation.default,contrast:o.getContrast()-r.contrast.default},{type:'sticker',options:i}},e.prototype._serializeText=function(e,t){var o=t.serializeOptions(['fontSize','lineHeight','fontFamily','fontWeight','alignment','color','backgroundColor','position','rotation','text','maxWidth'],!0);return o.rotation=(o.rotation+s)%s,{type:'text',options:o}},e.prototype._serializeBrush=function(e,t){var o=this;return{type:'brush',options:{paths:t.getPaths().map(function(e){return o._serializePath(e)})}}},e.prototype._serializePath=function(e){var t=e.getBrush().serializeOptions(['color','size'],!0);return t.points=e.getControlPoints().map(function(e){return e.getPosition().toObject()}),t},e.prototype._serializeRadialFocusOperation=function(e){return{type:'focus',options:{type:'radial',options:e.serializeOptions(['position','radius','gradientRadius','blurRadius'],!0)}}},e.prototype._serializeLinearFocusOperation=function(e){return{type:'focus',options:{type:'linear',options:e.serializeOptions(['start','end','blurRadius','size','gradientSize'],!0)}}},e.prototype._getInputDimensionsForOperation=function(e){var t=!1,o=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(i){i===e&&(t=!0),t||(o=i.getNewDimensions(o))}),o},e}();t.default=l,l.version='1.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(2),a=i(r),s=o(3),l=i(s),d=o(14),p=i(d),c=o(0),m=i(c),_=o(1),u=o(66),g=i(u),f=o(30),y=i(f),h=o(268),b=i(h),k=o(98),v=i(k),E=o(39),S=i(E),M=_.SDK.Operations.SpriteOperation.BrushSprite.Brush,C=function(){function e(t,o){(0,m.default)(this,e),this._editor=t,this._ui=this._editor.getUI(),this._data=o,this._filterManager=new g.default(this._ui,this._getOptions('filter')),this._stickerManager=new y.default(this._ui,this._getOptions('sticker')),this._brushManager=new b.default(this._ui,this._getOptions('brush')),this._fontManager=new v.default(this._ui,this._getOptions('text'))}return e.prototype._getOptions=function(e){var t=this._editor.controls,o={};t&&t.get(e)&&(o=t.get(e).defaultOptions);var i=this._editor.getOptions();return _.SDKUtils.extend({},i.editor.controlsOptions[e]||{},o)},e.prototype.deserialize=function(){var e=this;return this._validateVersion().then(function(){return e._deserializeInputImage()}).then(function(){return e._deserializeOperations()})},e.prototype._validateVersion=function(){return this._data.version===this.constructor.version?Promise.resolve():Promise.reject(new Error('Invalid version '+this._data.version+', expected '+this.constructor.version))},e.prototype._deserializeInputImage=function(){var e=this;return new Promise(function(t){var o=e._data.inputImage,i=o.data,r=o.type;if(i&&r){var a=new window.Image;a.addEventListener('load',function(){e._editor.setImage(a),t()}),a.src='data:'+r+';base64,'+i}else t()})},e.prototype._deserializeOperations=function(){var e=this;this._operationsData={},this._data.operations.forEach(function(t){e._operationsData[t.type]=t});var t=this._data.operations.map(function(t){return e._deserializeOperation(t)});return Promise.all(t)},e.prototype._deserializeOperation=function(e){switch(e.type){case'crop':return this._deserializeCropOperation(e);case'orientation':return this._deserializeOrientationOperation(e);case'filter':return this._deserializeFilterOperation(e);case'adjustments':return this._deserializeAdjustmentsOperation(e);case'sprite':return this._deserializeSpriteOperation(e);case'focus':return this._deserializeFocusOperation(e);}},e.prototype._deserializeCropOperation=function(e){var t=e.options,o=t.rotation,i=_.Vector2.fromObject(t.start),r=_.Vector2.fromObject(t.end);o>n&&(o-=2*n);var a={start:i,end:r};'undefined'!=typeof o&&(a.rotation=o);var s=this._editor.operations.getOrCreate('transform');return this._editor.broadcastTransform(s,a),s.set(a),Promise.resolve(s)},e.prototype._deserializeOrientationOperation=function(e){var t=e.options,o=this._editor.operations.getOrCreate('orientation');o.set(t)},e.prototype._deserializeFilterOperation=function(e){var t=this,o=e.options;return this._filterManager.getFilterByIdentifier(o.name)?this._filterManager.instantiateFilterWithIdentifier(o.name).then(function(e){var i=t._editor.operations.getOrCreate('filter');i.set({identifier:o.name,filter:e,intensity:o.intensity})}):(_.Log.warn('Deserializer','Unknown filter `'+o.name+'`'),Promise.resolve())},e.prototype._deserializeAdjustmentsOperation=function(e){var t=_.SDK.Operations.AdjustmentsOperation,o=e.options,i={};return['brightness','saturation','contrast','exposure','shadows','highlights','clarity'].forEach(function(e){if('undefined'!=typeof o[e]){var r=t.prototype.availableOptions[e],a=r.minValue,n=r.midValue,s=r.maxValue,l=o[e];l=0>l?n+(n-a)*l:n+(s-n)*l,i[e]=l}}),Promise.resolve(this._editor.operations.getOrCreate('adjustments',i))},e.prototype._deserializeSpriteOperation=function(e){var t=this,o=e.options,i=this._editor.operations.getOrCreate('sprite'),r=o.sprites.map(function(e){return t._deserializeSprite(i,e)}).filter(function(e){return e});return Promise.all(r).then(function(e){i.setSprites(e.filter(function(e){return e}))})},e.prototype._deserializeSprite=function(e,t){switch(t.type){case'sticker':return this._deserializeSticker(e,t);case'text':return this._deserializeText(e,t);case'brush':return this._deserializeBrush(e,t);}},e.prototype._deserializeSticker=function(e,t){var o=this,i=_.SDK.Operations.SpriteOperation,r=t.options,a=this._stickerManager.getStickerByIdentifier(r.name),n=this._stickerManager.getURLForSticker(a);return a?new Promise(function(t){var a=new window.Image;a.addEventListener('load',function(){var o=i.StickerSprite.prototype.availableOptions.adjustments.structure,n=r.rotation,s=r.flipHorizontally,l=r.flipVertically,d={identifier:r.name,image:a,position:_.Vector2.fromObject(r.position),dimensions:_.Vector2.fromObject(r.dimensions),rotation:n,flipHorizontally:s,flipVertically:l,adjustments:{}};'undefined'!=typeof r.adjustments&&['brightness','contrast','saturation'].forEach(function(e){void 0!==(0,p.default)(r.adjustments[e])&&(d.adjustments[e]=r.adjustments[e]+o[e].default)}),t(e.createSticker(d))}),a.crossOrigin='Anonymous',a.src=o._editor.getUI().getAssetPath(n)}):(_.Log.warn('Deserializer','Unknown sticker \''+r.name+'\'. Skipping sprite.'),Promise.resolve())},e.prototype._deserializeText=function(e,t){var o=t.options,i=o.fontSize,r=o.lineHeight,a=o.fontFamily,n=o.fontWeight,s=o.alignment,l=o.rotation,d=o.maxWidth,p=o.color,c=o.backgroundColor,m=new S.default(this._ui),u=this._fontManager.getFontByFontFamily(a);return u||(u=this._fontManager.getDefaultFont()),m.setFonts([u]),m.load().then(function(){return e.createText({fontSize:i,lineHeight:r,fontFamily:a,fontWeight:n,alignment:s,rotation:l,maxWidth:d,text:o.text,color:_.Color.fromArray(p),backgroundColor:_.Color.fromArray(c),position:_.Vector2.fromObject(o.position)})})},e.prototype._deserializeBrush=function(e,t){var o=this,i=t.options,r=i.paths,a=e.createBrush();return r.forEach(function(e){o._deserializeBrushPath(a,e)}),Promise.resolve(a)},e.prototype._deserializeBrushPath=function(e,t){var o=t.points,i=this._createBrushForPath(t),r=e.createPath(i);r.setClosed(!0),o.forEach(function(e){r.addControlPoint(_.Vector2.fromObject(e))})},e.prototype._createBrushForPath=function(e){var t=e.color,o=e.size,i=_.Color.fromArray(t),r={color:i,size:o},n=this._brushManager.getFirstBrush();if(n.prototype&&n.prototype instanceof M){return new n(r)}var s=_.SDKUtils.extend({},n);delete s.image;var d=function(e){function t(){return(0,m.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,l.default)(t,e),t}(M);return d.identifier=n.identifier,new d(_.SDKUtils.extend({},s,r))},e.prototype._deserializeFocusOperation=function(e){var t=e.options.options;switch(e.options.type){case'radial':{var o=t.position,i=t.radius,r=t.gradientRadius,a=t.blurRadius;this._editor.operations.getOrCreate('radial-focus',{position:_.Vector2.fromObject(o),radius:i,gradientRadius:r,blurRadius:a})}break;case'linear':{var n=t.start,s=t.end,l=t.size,d=t.gradientSize,p=t.blurRadius;this._editor.operations.getOrCreate('mirrored-focus',{start:_.Vector2.fromObject(n),end:_.Vector2.fromObject(s),size:l,gradientSize:d,blurRadius:p})}}},e.prototype._getInputDimensionsForOperation=function(e){var t=!1,o=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(i){i===e&&(t=!0),t||(o=i.getNewDimensions(o))}),o},e}();t.default=C,C.version='1.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(270),s=i(n),l=function(){function e(t){(0,a.default)(this,e),this._ui=t,this._fonts=[],this._observers=[]}return e.prototype.add=function(e){this._fonts.push(e)},e.prototype.load=function(){var e=this;return 0===this._fonts.length?Promise.resolve():(this._observers=[],this._fonts.forEach(function(t){e._observers.push(new s.default(t))}),Promise.all(this._observers.map(function(e){return e.observe()})))},e.prototype.dispose=function(){this._observers.forEach(function(e){return e.dispose()})},e}();t.default=l},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),s=o(2),l=i(s),d=o(3),p=i(d),c=o(102),m=i(c),_=2*n,u=function(e){function t(){return(0,a.default)(this,t),(0,l.default)(this,e.apply(this,arguments))}return(0,p.default)(t,e),t.prototype._serializeTransformOperation=function(e){var t=e.serializeOptions(['start','end','rotation','textureScale'],!0);return t.rotation=(t.rotation+_)%_,1!==t.textureScale&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:'crop',options:t}},t}(m.default);t.default=u,u.version='1.0.1'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),s=o(2),l=i(s),d=o(3),p=i(d),c=o(1),m=o(103),_=i(m),u=function(e){function t(){return(0,a.default)(this,t),(0,l.default)(this,e.apply(this,arguments))}return(0,p.default)(t,e),t.prototype._deserializeOperation=function(t){return'selective-blur'===t.type?this._deserializeSelectiveBlurOperation(t):e.prototype._deserializeOperation.call(this,t)},t.prototype._deserializeCropOperation=function(e){var t=e.options,o=t.rotation,i=c.Vector2.fromObject(t.start),r=c.Vector2.fromObject(t.end),a=t.dimensions?c.Vector2.fromObject(t.dimensions):null;o>n&&(o-=2*n);var s={start:i,end:r};'undefined'!=typeof o&&(s.rotation=o);var l=this._editor.operations.getOrCreate('transform');if(this._editor.broadcastTransform(l,s),l.set(s),a){var d=r.clone().subtract(i),p=l.getInputDimensions(!1).multiply(d);l.setTextureScale(a.x/p.x)}return Promise.resolve(l)},t}(_.default);t.default=u,u.version='1.0.1'},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(4),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=a.SDK.Engine.Filters.OverlayFilter,s;t.default=(s={},(0,r.default)(s,n.BLEND_MODES.NORMAL,'normal'),(0,r.default)(s,n.BLEND_MODES.OVERLAY,'overlay'),(0,r.default)(s,n.BLEND_MODES.HARD_LIGHT,'hard light'),(0,r.default)(s,n.BLEND_MODES.SOFT_LIGHT,'soft light'),(0,r.default)(s,n.BLEND_MODES.MULTIPLY,'multiply'),(0,r.default)(s,n.BLEND_MODES.DARKEN,'darken'),(0,r.default)(s,n.BLEND_MODES.LIGHTEN,'lighten'),(0,r.default)(s,n.BLEND_MODES.SCREEN,'screen'),(0,r.default)(s,n.BLEND_MODES.COLOR_BURN,'color burn'),s)},function(e,t,o){'use strict';/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */o(109),e.exports=o(110).default},function(){},function(e,t,o){'use strict';function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var a=o(40),n=r(a),s=o(0),l=r(s),d=o(2),p=r(d),c=o(3),m=r(c),_=o(1),u=o(173),g=r(u),f=o(6),y=r(f),h=o(9),b=r(h),k=o(5),v=r(k),E=o(62),S=r(E),M=o(287),C=r(M),B=o(288),R=i(B),x=o(10),T=r(x),P=o(95),D=i(P),O=o(37),w=r(O),I=o(15),F=r(I),z=o(39),N=r(z),A=function(e){return _.SDKUtils.byteArrayToString(_.Base64.decode(e))},V=function(e){function t(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,l.default)(this,t);var i=(0,p.default)(this,e.call(this));return i._mediator=new _.EventEmitter,i._fontLoader=new N.default(i),i._options=o,i._initOptions(),i._initLanguage(),i._initEvents(),i._disposed=!1,i._preloader=new C.default(i,i._options,i._mediator),_.Log.setLevel(i._options.logLevel),i._v()&&i.run(),i}return(0,m.default)(t,e),t.prototype.run=function(){this._registerWebFonts(),this._options.container.style.position='relative',this._render()},t.prototype._render=function(){var e=_.React.createElement(g.default,{ui:this,mediator:this._mediator,options:this._options});return this._options.renderReturnsComponent?e:void(this._component=_.ReactDOM.render(e,this._options.container))},t.prototype.export=function(){var e;return(e=this._component).export.apply(e,arguments)},t.prototype.serialize=function(){var e;return(e=this._component).serialize.apply(e,arguments)},t.prototype.deserialize=function(e){return this._component.deserialize(e)},t.prototype.getEditor=function(){return this._component.getEditor()},t.prototype._initOptions=function(){this._options=_.SDKUtils.defaults(this._options,{language:'en',title:'PhotoEditor SDK',logLevel:'warn',preloader:!0,editor:{},assets:{},photoRoll:{},enableUpload:!0,enableWebcam:!0,showCloseButton:!1,showHeader:!0,showTopBar:!0,responsive:!1}),this._options.editor=_.SDKUtils.defaults(this._options.editor||{},{pixelRatio:'undefined'!=typeof window&&window.devicePixelRatio||1,preferredRenderer:'webgl',enableZoom:!0,enableDrag:!0,smoothDownscaling:!1,smoothUpscaling:!1,displayResizeMessage:!0,maxMegaPixels:{},forceControls:[],watermarkImage:null,tools:['transform','filter','brightness','saturation','contrast','clarity','exposure','shadows','highlights','gamma','text','sticker','brush','radial-focus','mirrored-focus','frame'],controlsOrder:['transform',['filter','adjustments'],['text','sticker','brush'],['selectiveBlur','focus','frame']],operationsOrder:['exif-orientation','orientation','transform','filter','adjustments','radial-focus','mirrored-focus','selective-blur','sprite','frame','watermark'],controlsOptions:{}}),this._options.editor.maxMegaPixels=_.SDKUtils.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=_.SDKUtils.defaults(this._options.editor.export||{},{showButton:!0,format:'image/png',type:_.RenderType.IMAGE,download:!0,fileBasename:'photoeditorsdk-export',quality:0.8}),this._options.photoRoll=_.SDKUtils.defaults(this._options.photoRoll||{},{provider:null}),this._options.extensions=_.SDKUtils.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=_.SDKUtils.defaults(this._options.assets||{},{baseUrl:'assets',resolver:null})},t.prototype._v=function(){return!!this[A('X29wdGlvbnM=')][A('bGljZW5zZQ==')]||(_.Log.error(A('TGljZW5zaW5n'),A('Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=')),_.Log.error(A('TGljZW5zaW5n'),A('SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==')),!1)},t.prototype._registerWebFonts=function(){var e=this.getAssetPath('fonts/montserrat-regular.woff',!0,!0),t=this.getAssetPath('fonts/montserrat-light.woff',!0,!0);this._webFontsStyle=document.createElement('style'),this._webFontsStyle.innerHTML='\n      // Injected by PhotoEditorSDK\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+e+'\') format(\'woff\');\n        font-weight: normal;\n        font-style: normal;\n      }\n\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+t+'\') format(\'woff\');\n        font-weight: 100;\n        font-style: normal;\n      }\n    ';var o=document.getElementsByTagName('head')[0];o.appendChild(this._webFontsStyle)},t.prototype._initEvents=function(){this._mediator.pipeEvents(this)},t.prototype._disposeEvents=function(){this._mediator.unpipeEvents(this)},t.prototype._initLanguage=function(){this._languages=_.SDKUtils.deepDefaults(this._options.extensions.languages,{de:o(293),en:o(294)}),this._language=this._languages[this._options.language],this._language||_.Log.error(this.constructor.name,'Language `'+this._options.language+'` not found!')},t.prototype.translate=function(e,t){return _.Utils.translate(this._language,e,t)},t.prototype.setImage=function(e){this._component&&this._component.setImage(e)},t.prototype.getAssetPath=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=this._options.assets,r=i.baseUrl,a=i.resolver,n=r+'/'+e;if(e.match(/(ftp|http|https):\/\//)&&(n=e),t){if(!o){var s='undefined'!=typeof window&&window.devicePixelRatio||1;if(1<s){var l=/\.[\w?=]+$/;e=e.replace(l,function(e){return'@2x'+e})}}n=r+'/ui/react/'+e}return'undefined'!=typeof a&&null!==a&&(n=a(n)),n},t.prototype.getFontLoader=function(){return this._fontLoader},t.prototype.getPreloader=function(){return this._preloader},t.prototype.dispose=function(){if(this._disposed)throw new Error('This instance of PhotoEditorSDK is already disposed.');this._disposed=!0,this._webFontsStyle.parentNode.removeChild(this._webFontsStyle),_.ReactDOM.unmountComponentAtNode(this._options.container),this._disposeEvents()},t}(_.EventEmitter);/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */V.prototype.identifier='react',V.BaseComponent=_.BaseComponent,V.BaseControls=T.default,V.ControlsComponent=b.default,V.React=_.React,V.ReactBEM=_.ReactBEM,V.SharedState=_.SharedState,V.Constants=_.Constants,V.Utils=_.Utils,V.ScrollbarComponent=y.default,V.ModalManager=v.default,V.JSONLoader=S.default,V.PhotoRoll=R,V.Controls=D,V.SliderComponent=w.default,V.SliderOverlayComponent=F.default;var L=function(e){function t(){return(0,l.default)(this,t),(0,p.default)(this,e.apply(this,arguments))}return(0,m.default)(t,e),t.prototype.componentDidMount=function(){this._ui=new V(_.SDKUtils.extend({},this.props,{container:this.refs.container}))},t.prototype.render=function(){var e=_.SDKUtils.extend({},this.props.style||{});return _.React.createElement('div',{style:e,ref:'container'})},(0,n.default)(t,[{key:'ui',get:function(){return this._ui}}]),t}(_.React.Component);V.ReactComponent=L,_.SDK.UI=_.SDK.UI||{},_.SDK.UI.ReactUI=V,t.default=V},function(e,t,o){o(112);var i=o(7).Object;e.exports=function(e,t,o){return i.defineProperty(e,t,o)}},function(e,t,o){var i=o(16);i(i.S+i.F*!o(18),'Object',{defineProperty:o(13).f})},function(e){e.exports=function(e){if('function'!=typeof e)throw TypeError(e+' is not a function!');return e}},function(e,t,o){e.exports={default:o(115),__esModule:!0}},function(e,t,o){o(31),o(53),e.exports=o(54).f('iterator')},function(e,t,o){var r=o(43),n=o(44);e.exports=function(e){return function(t,o){var d=n(t)+'',s=r(o),i=d.length,l,a;return 0>s||s>=i?e?'':void 0:(l=d.charCodeAt(s),55296>l||56319<l||s+1===i||56320>(a=d.charCodeAt(s+1))||57343<a?e?d.charAt(s):l:e?d.slice(s,s+2):(l-55296<<10)+(a-56320)+65536)}}},function(e,t,o){'use strict';var i=o(46),r=o(27),a=o(51),n={};o(21)(n,o(8)('iterator'),function(){return this}),e.exports=function(e,t,o){e.prototype=i(n,{next:r(1,o)}),a(e,t+' Iterator')}},function(e,t,o){var r=o(13),a=o(17),n=o(28);e.exports=o(18)?Object.defineProperties:function(e,t){a(e);for(var o=n(t),s=o.length,l=0,i;s>l;)r.f(e,i=o[l++],t[i]);return e}},function(e,t,o){var i=o(20),r=o(78),a=o(120);e.exports=function(e){return function(t,o,n){var s=i(t),l=r(s.length),d=a(n,l),p;if(e&&o!=o){for(;l>d;)if(p=s[d++],p!=p)return!0;}else for(;l>d;d++)if((e||d in s)&&s[d]===o)return e||d||0;return!e&&-1}}},function(e,t,o){var i=o(43);e.exports=function(e,t){return e=i(e),0>e?c(e+t,0):p(e,t)}},function(e,t,o){e.exports=o(12).document&&document.documentElement},function(e,t,o){var i=o(19),r=o(52),a=o(48)('IE_PROTO'),n=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,a)?e[a]:'function'==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?n:null}},function(e,t,o){'use strict';var i=o(124),r=o(125),a=o(22),n=o(20);e.exports=o(74)(Array,'Array',function(e,t){this._t=n(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,o=this._i++;return!e||o>=e.length?(this._t=void 0,r(1)):'keys'==t?r(0,o):'values'==t?r(0,e[o]):r(0,[o,e[o]])},'values'),a.Arguments=a.Array,i('keys'),i('values'),i('entries')},function(e){e.exports=function(){}},function(e){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,o){e.exports={default:o(127),__esModule:!0}},function(e,t,o){o(128),o(134),o(135),o(136),e.exports=o(7).Symbol},function(e,t,o){'use strict';var r=o(12),a=o(19),n=o(18),s=o(16),l=o(75),d=o(129).KEY,p=o(26),c=o(49),m=o(51),_=o(32),u=o(8),g=o(54),f=o(55),y=o(130),h=o(131),b=o(132),k=o(17),v=o(20),S=o(42),E=o(27),M=o(46),C=o(133),B=o(80),R=o(13),x=o(28),T=B.f,P=R.f,D=C.f,O=r.Symbol,w=r.JSON,I=w&&w.stringify,F='prototype',z=u('_hidden'),N=u('toPrimitive'),A={}.propertyIsEnumerable,V=c('symbol-registry'),L=c('symbols'),U=c('op-symbols'),W=Object[F],j='function'==typeof O,K=r.QObject,H=!K||!K[F]||!K[F].findChild,$=n&&p(function(){return 7!=M(P({},'a',{get:function(){return P(this,'a',{value:7}).a}})).a})?function(e,t,o){var i=T(W,t);i&&delete W[t],P(e,t,o),i&&e!==W&&P(W,t,i)}:P,q=function(e){var t=L[e]=M(O[F]);return t._k=e,t},G=j&&'symbol'==typeof O.iterator?function(e){return'symbol'==typeof e}:function(e){return e instanceof O},Z=function(e,t,o){return e===W&&Z(U,t,o),k(e),t=S(t,!0),k(o),a(L,t)?(o.enumerable?(a(e,z)&&e[z][t]&&(e[z][t]=!1),o=M(o,{enumerable:E(0,!1)})):(!a(e,z)&&P(e,z,E(1,{})),e[z][t]=!0),$(e,t,o)):P(e,t,o)},Y=function(e,t){k(e);for(var o=h(t=v(t)),r=0,i=o.length,a;i>r;)Z(e,a=o[r++],t[a]);return e},J=function(e){var t=A.call(this,e=S(e,!0));return this===W&&a(L,e)&&!a(U,e)?!1:t||!a(this,e)||!a(L,e)||a(this,z)&&this[z][e]?t:!0},X=function(e,t){if(e=v(e),t=S(t,!0),e!==W||!a(L,t)||a(U,t)){var o=T(e,t);return o&&a(L,t)&&!(a(e,z)&&e[z][t])&&(o.enumerable=!0),o}},Q=function(e){for(var t=D(v(e)),o=[],r=0,i;t.length>r;)a(L,i=t[r++])||i==z||i==d||o.push(i);return o},ee=function(e){for(var t=e===W,o=D(t?U:v(e)),r=[],n=0,i;o.length>n;)a(L,i=o[n++])&&(!t||a(W,i))&&r.push(L[i]);return r};j||(O=function(){if(this instanceof O)throw TypeError('Symbol is not a constructor!');var e=_(0<arguments.length?arguments[0]:void 0),t=function(o){this===W&&t.call(U,o),a(this,z)&&a(this[z],e)&&(this[z][e]=!1),$(this,e,E(1,o))};return n&&H&&$(W,e,{configurable:!0,set:t}),q(e)},l(O[F],'toString',function(){return this._k}),B.f=X,R.f=Z,o(79).f=C.f=Q,o(33).f=J,o(56).f=ee,n&&!o(45)&&l(W,'propertyIsEnumerable',J,!0),g.f=function(e){return q(u(e))}),s(s.G+s.W+s.F*!j,{Symbol:O});for(var te=['hasInstance','isConcatSpreadable','iterator','match','replace','search','species','split','toPrimitive','toStringTag','unscopables'],oe=0;te.length>oe;)u(te[oe++]);for(var te=x(u.store),oe=0;te.length>oe;)f(te[oe++]);s(s.S+s.F*!j,'Symbol',{for:function(e){return a(V,e+='')?V[e]:V[e]=O(e)},keyFor:function(e){if(G(e))return y(V,e);throw TypeError(e+' is not a symbol!')},useSetter:function(){H=!0},useSimple:function(){H=!1}}),s(s.S+s.F*!j,'Object',{create:function(e,t){return t===void 0?M(e):Y(M(e),t)},defineProperty:Z,defineProperties:Y,getOwnPropertyDescriptor:X,getOwnPropertyNames:Q,getOwnPropertySymbols:ee}),w&&s(s.S+s.F*(!j||p(function(){var e=O();return'[null]'!=I([e])||'{}'!=I({a:e})||'{}'!=I(Object(e))})),'JSON',{stringify:function(e){if(!(void 0===e||G(e))){for(var t=[e],o=1,i,r;arguments.length>o;)t.push(arguments[o++]);return i=t[1],'function'==typeof i&&(r=i),(r||!b(i))&&(i=function(e,t){if(r&&(t=r.call(this,e,t)),!G(t))return t}),t[1]=i,I.apply(w,t)}}}),O[F][N]||o(21)(O[F],N,O[F].valueOf),m(O,'Symbol'),m(Math,'Math',!0),m(r.JSON,'JSON',!0)},function(e,t,o){var i=o(32)('meta'),r=o(25),a=o(19),n=o(13).f,s=0,l=Object.isExtensible||function(){return!0},d=!o(26)(function(){return l(Object.preventExtensions({}))}),p=function(e){n(e,i,{value:{i:'O'+ ++s,w:{}}})},c=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!r(e))return'symbol'==typeof e?e:('string'==typeof e?'S':'P')+e;if(!a(e,i)){if(!l(e))return'F';if(!t)return'E';p(e)}return e[i].i},getWeak:function(e,t){if(!a(e,i)){if(!l(e))return!0;if(!t)return!1;p(e)}return e[i].w},onFreeze:function(e){return d&&c.NEED&&l(e)&&!a(e,i)&&p(e),e}}},function(e,t,o){var i=o(28),r=o(20);e.exports=function(e,t){for(var o=r(e),a=i(o),n=a.length,s=0,l;n>s;)if(o[l=a[s++]]===t)return l}},function(e,t,o){var r=o(28),a=o(56),n=o(33);e.exports=function(e){var t=r(e),o=a.f;if(o)for(var s=o(e),l=n.f,d=0,i;s.length>d;)l.call(e,i=s[d++])&&t.push(i);return t}},function(e,t,o){var i=o(47);e.exports=Array.isArray||function(e){return'Array'==i(e)}},function(e,t,o){var i=o(20),r=o(79).f,a={}.toString,n='object'==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return r(e)}catch(t){return n.slice()}};e.exports.f=function(e){return n&&'[object Window]'==a.call(e)?s(e):r(i(e))}},function(){},function(e,t,o){o(55)('asyncIterator')},function(e,t,o){o(55)('observable')},function(e,t,o){e.exports={default:o(138),__esModule:!0}},function(e,t,o){o(139),e.exports=o(7).Object.setPrototypeOf},function(e,t,o){var i=o(16);i(i.S,'Object',{setPrototypeOf:o(140).set})},function(e,t,o){var i=o(25),r=o(17),a=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+': can\'t set as prototype!')};e.exports={set:Object.setPrototypeOf||('__proto__'in{}?function(e,t,i){try{i=o(41)(Function.call,o(80).f(Object.prototype,'__proto__').set,2),i(e,[]),t=!(e instanceof Array)}catch(o){t=!0}return function(e,o){return a(e,o),t?e.__proto__=o:i(e,o),e}}({},!1):void 0),check:a}},function(e,t,o){e.exports={default:o(142),__esModule:!0}},function(e,t,o){o(143);var i=o(7).Object;e.exports=function(e,t){return i.create(e,t)}},function(e,t,o){var i=o(16);i(i.S,'Object',{create:o(46)})},function(e){e.exports=o},function(e,t,o){'use strict';var r=o(58),i=o(59),a=o(82),n=o(60),s=o(146);e.exports=function(e,t){function o(e){var t=e&&(h&&e[h]||e[b]);if('function'==typeof t)return t}function l(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function d(e){this.message=e,this.stack=''}function p(e){function o(o,l,p,c,m,_,u){if(c=c||k,_=_||p,u!==n)if(t)i(!1,'Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types');else if('production'!=={ENV:'"production"'}.NODE_ENV&&'undefined'!=typeof console){var g=c+':'+p;!r[g]&&3>s&&(a(!1,'You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.',_,c),r[g]=!0,s++)}return null==l[p]?o?null===l[p]?new d('The '+m+' `'+_+'` is marked as required '+('in `'+c+'`, but its value is `null`.')):new d('The '+m+' `'+_+'` is marked as required in '+('`'+c+'`, but its value is `undefined`.')):null:e(l,p,c,m,_)}if('production'!=={ENV:'"production"'}.NODE_ENV)var r={},s=0;var l=o.bind(null,!1);return l.isRequired=o.bind(null,!0),l}function c(e){return p(function(t,o,i,r,a){var n=t[o],s=u(n);if(s!==e){var l=g(n);return new d('Invalid '+r+' `'+a+'` of type '+('`'+l+'` supplied to `'+i+'`, expected ')+('`'+e+'`.'))}return null})}function m(t){switch(typeof t){case'number':case'string':case'undefined':return!0;case'boolean':return!t;case'object':if(Array.isArray(t))return t.every(m);if(null===t||e(t))return!0;var i=o(t);if(i){var r=i.call(t),a;if(i!==t.entries){for(;!(a=r.next()).done;)if(!m(a.value))return!1;}else for(;!(a=r.next()).done;){var n=a.value;if(n&&!m(n[1]))return!1}}else return!1;return!0;default:return!1;}}function _(e,t){return'symbol'===e||'Symbol'===t['@@toStringTag']||'function'==typeof Symbol&&t instanceof Symbol}function u(e){var t=typeof e;return Array.isArray(e)?'array':e instanceof RegExp?'object':_(t,e)?'symbol':t}function g(e){if('undefined'==typeof e||null===e)return''+e;var t=u(e);if('object'===t){if(e instanceof Date)return'date';if(e instanceof RegExp)return'regexp'}return t}function f(e){var t=g(e);return'array'===t||'object'===t?'an '+t:'boolean'===t||'date'===t||'regexp'===t?'a '+t:t}function y(e){return e.constructor&&e.constructor.name?e.constructor.name:k}var h='function'==typeof Symbol&&Symbol.iterator,b='@@iterator',k='<<anonymous>>',v={array:c('array'),bool:c('boolean'),func:c('function'),number:c('number'),object:c('object'),string:c('string'),symbol:c('symbol'),any:function(){return p(r.thatReturnsNull)}(),arrayOf:function(e){return p(function(t,o,r,a,s){if('function'!=typeof e)return new d('Property `'+s+'` of component `'+r+'` has invalid PropType notation inside arrayOf.');var l=t[o];if(!Array.isArray(l)){var p=u(l);return new d('Invalid '+a+' `'+s+'` of type '+('`'+p+'` supplied to `'+r+'`, expected an array.'))}for(var c=0,i;c<l.length;c++)if(i=e(l,c,r,a,s+'['+c+']',n),i instanceof Error)return i;return null})},element:function(){return p(function(t,o,i,r,a){var n=t[o];if(!e(n)){var s=u(n);return new d('Invalid '+r+' `'+a+'` of type '+('`'+s+'` supplied to `'+i+'`, expected a single ReactElement.'))}return null})}(),instanceOf:function(e){return p(function(t,o,i,r,a){if(!(t[o]instanceof e)){var n=e.name||k,s=y(t[o]);return new d('Invalid '+r+' `'+a+'` of type '+('`'+s+'` supplied to `'+i+'`, expected ')+('instance of `'+n+'`.'))}return null})},node:function(){return p(function(e,t,o,i,r){return m(e[t])?null:new d('Invalid '+i+' `'+r+'` supplied to '+('`'+o+'`, expected a ReactNode.'))})}(),objectOf:function(e){return p(function(t,o,i,r,a){if('function'!=typeof e)return new d('Property `'+a+'` of component `'+i+'` has invalid PropType notation inside objectOf.');var s=t[o],l=u(s);if('object'!==l)return new d('Invalid '+r+' `'+a+'` of type '+('`'+l+'` supplied to `'+i+'`, expected an object.'));for(var p in s)if(s.hasOwnProperty(p)){var c=e(s,p,i,r,a+'.'+p,n);if(c instanceof Error)return c}return null})},oneOf:function(e){return Array.isArray(e)?p(function(t,o,r,a,n){for(var s=t[o],p=0;p<e.length;p++)if(l(s,e[p]))return null;var i=JSON.stringify(e);return new d('Invalid '+a+' `'+n+'` of value `'+s+'` '+('supplied to `'+r+'`, expected one of '+i+'.'))}):('production'==={ENV:'"production"'}.NODE_ENV?void 0:a(!1,'Invalid argument supplied to oneOf, expected an instance of array.'),r.thatReturnsNull)},oneOfType:function(e){if(!Array.isArray(e))return'production'==={ENV:'"production"'}.NODE_ENV?void 0:a(!1,'Invalid argument supplied to oneOfType, expected an instance of array.'),r.thatReturnsNull;for(var t=0,o;t<e.length;t++)if(o=e[t],'function'!=typeof o)return a(!1,'Invalid argument supplid to oneOfType. Expected an array of check functions, but received %s at index %s.',f(o),t),r.thatReturnsNull;return p(function(t,o,r,a,s){for(var l=0,i;l<e.length;l++)if(i=e[l],null==i(t,o,r,a,s,n))return null;return new d('Invalid '+a+' `'+s+'` supplied to '+('`'+r+'`.'))})},shape:function(e){return p(function(t,o,i,r,a){var s=t[o],l=u(s);if('object'!==l)return new d('Invalid '+r+' `'+a+'` of type `'+l+'` '+('supplied to `'+i+'`, expected `object`.'));for(var p in e){var c=e[p];if(c){var m=c(s,p,i,r,a+'.'+p,n);if(m)return m}}return null})}};return d.prototype=Error.prototype,v.checkPropTypes=s,v.PropTypes=v,v}},function(e,t,o){'use strict';if('production'!=={ENV:'"production"'}.NODE_ENV)var i=o(59),r=o(82),a=o(60),n={};e.exports=function(e,t,o,s,l){if('production'!=={ENV:'"production"'}.NODE_ENV)for(var d in e)if(e.hasOwnProperty(d)){var p;try{i('function'==typeof e[d],'%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.',s||'React class',o,d),p=e[d](t,d,s,o,null,a)}catch(e){p=e}if(r(!p||p instanceof Error,'%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).',s||'React class',o,d,typeof p),p instanceof Error&&!(p.message in n)){n[p.message]=!0;var c=l?l():'';r(!1,'Failed %s type: %s%s',o,p.message,null==c?'':c)}}}},function(e,t,o){'use strict';var i=o(58),r=o(59),a=o(60);e.exports=function(){function e(e,t,o,i,n,s){s===a||r(!1,'Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types')}function t(){return e}e.isRequired=e;var o={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t};return o.checkPropTypes=i,o.PropTypes=o,o}},function(e,t,o){'use strict';t.__esModule=!0;var i=o(149),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return(0,r.default)(e)}},function(e,t,o){e.exports={default:o(150),__esModule:!0}},function(e,t,o){o(31),o(151),e.exports=o(7).Array.from},function(e,t,o){'use strict';var i=o(41),r=o(16),a=o(52),n=o(152),s=o(153),l=o(78),d=o(154),p=o(86);r(r.S+r.F*!o(155)(function(e){Array.from(e)}),'Array',{from:function(e){var t=a(e),o='function'==typeof this?this:Array,r=arguments.length,c=1<r?arguments[1]:void 0,m=void 0!==c,_=0,u=p(t),g,f,y,h;if(m&&(c=i(c,2<r?arguments[2]:void 0,2)),void 0!=u&&!(o==Array&&s(u)))for(h=u.call(t),f=new o;!(y=h.next()).done;_++)d(f,_,m?n(h,c,[y.value,_],!0):y.value);else for(g=l(t.length),f=new o(g);g>_;_++)d(f,_,m?c(t[_],_):t[_]);return f.length=_,f}})},function(e,t,o){var i=o(17);e.exports=function(t,e,o,r){try{return r?e(i(o)[0],o[1]):e(o)}catch(o){var a=t['return'];throw void 0!==a&&i(a.call(t)),o}}},function(e,t,o){var i=o(22),r=o(8)('iterator'),a=Array.prototype;e.exports=function(e){return e!==void 0&&(i.Array===e||a[r]===e)}},function(e,t,o){'use strict';var i=o(13),r=o(27);e.exports=function(e,t,o){t in e?i.f(e,t,r(0,o)):e[t]=o}},function(e,t,o){var i=o(8)('iterator'),r=!1;try{var a=[7][i]();a['return']=function(){r=!0},Array.from(a,function(){throw 2})}catch(t){}e.exports=function(e,t){if(!t&&!r)return!1;var o=!1;try{var a=[7],n=a[i]();n.next=function(){return{done:o=!0}},a[i]=function(){return n},e(a)}catch(t){}return o}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(57),c=i(p),m=o(81),_=i(m),u=o(85),g=i(u),f=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._events={},n._needsStyleFixes=!1,n._bindAll('_onSharedStateUpdate','fixStyles'),n}return(0,d.default)(t,e),t.prototype.fixStyles=function(){},t.prototype.componentDidMount=function(){this._bindEvents(),this.props.sharedState&&this.props.sharedState.on('update',this._onSharedStateUpdate),this._needsStyleFixes&&(this.fixStyles(),this.context.options.responsive&&window.addEventListener('resize',this.fixStyles))},t.prototype.componentWillUnmount=function(){this._unbindEvents(),this.props.sharedState&&this.props.sharedState.off('update',this._onSharedStateUpdate),this.context.options.responsive&&this._needsStyleFixes&&window.removeEventListener('resize',this.fixStyles)},t.prototype.componentWillReceiveProps=function(e){e.sharedState&&(this.props.sharedState&&this.props.sharedState.off('update',this._onSharedStateUpdate),e.sharedState.on('update',this._onSharedStateUpdate))},t.prototype._bindAll=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];o.forEach(function(t){if('function'!=typeof e[t])throw new Error('_bindAll: '+e.constructor.name+'.'+t+' is not a function.');e[t]=e[t].bind(e)})},t.prototype._t=function(e,t){return this.context.ui.translate(e,t)},t.prototype._getAssetPath=function(){var e;return(e=this.context.ui).getAssetPath.apply(e,arguments)},t.prototype._onSharedStateUpdate=function(e,t){this.sharedStateDidChange(t),this.shouldSharedComponentUpdate(e,t)&&this.forceUpdate()},t.prototype.shouldSharedComponentUpdate=function(){return!0},t.prototype.sharedStateDidChange=function(){},t.prototype.setSharedState=function(e,t){this.props.sharedState.set(e,t)},t.prototype.getSharedState=function(e){return this.props.sharedState.get(e)},t.prototype.forceSharedUpdate=function(){this.props.sharedState.broadcastUpdate()},t.prototype._bindEvents=function(){for(var e in this._events){var t=this._events[e];this.context.mediator.on(e,t)}},t.prototype._unbindEvents=function(){for(var e in this._events){var t=this._events[e];this.context.mediator.off(e,t)}},t.prototype._emitEvent=function(e){for(var t=arguments.length,o=Array(1<t?t-1:0),i=1,r;i<t;i++)o[i-1]=arguments[i];(r=this.context.mediator).emit.apply(r,[e].concat(o))},t.prototype.renderWithBEM=function(){return g.default.createElement('div')},t.prototype.render=function(){return g.default.transform(this.renderWithBEM())},t}(c.default.Component);t.default=f,f.contextTypes={editor:_.default.object,ui:_.default.object,options:_.default.object,mediator:_.default.object,editorScreen:_.default.object},f.propTypes={sharedState:_.default.any}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(34),a=i(r),n=o(88),s=i(n),l=o(158),d=i(l),p=o(62),c=i(p),m=a.default.Utils,_=a.default.Math.Vector2,u={getInnerDimensionsForElement:function(e){var t=new _(e.offsetWidth,e.offsetHeight),o=window.getComputedStyle(e,null);return t.x-=parseInt(o.getPropertyValue('padding-left'),10),t.x-=parseInt(o.getPropertyValue('padding-right'),10),t.y-=parseInt(o.getPropertyValue('padding-top'),10),t.y-=parseInt(o.getPropertyValue('padding-bottom'),10),t},getEventPosition:function(t){var e=t.clientX,o=t.clientY;if(-1!==t.type.indexOf('touch')){if(!t.touches.length)return;e=t.touches[0].clientX,o=t.touches[0].clientY}return new _(e,o)},createTransparentPatternCanvas:function(){var e=document.createElement('canvas'),t=e.getContext('2d');return e.width=10,e.height=10,t.fillStyle='white',t.fillRect(0,0,e.width,e.height),t.fillStyle='#cccccc',t.fillRect(0,0,e.width/2,e.height/2),t.fillRect(e.width/2,e.height/2,e.width,e.height),e},supportsMSBlob:function(){var e=document.createElement('canvas');return'undefined'!=typeof e.msToBlob},translate:function(e,t){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},i=this.fetch(e,t);if(!i)return s.default.info('Utils#translate','Unable to translate `'+t+'`'),null;for(var r in o)i=i.replace('${'+r+'}',o[r]);return i},fetch:function(e,t){t=t.replace(/\[(\w+)]/g,'.$1'),t=t.replace(/^\./,'');for(var o=t.split('.'),r=0,i;r<o.length&&(i=o[r],e=e[i],!!e);r++);return'undefined'!=typeof e&&e},isMobile:function(){var e=navigator.userAgent||navigator.vendor||window.opera;return /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},isTouchDevice:function(){return!!('ontouchstart'in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},select:function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;o||(o=function(e){return e});var i=[];return t.forEach(function(t){e.forEach(function(e){var r=o(e);r===t&&i.push(e)})}),i},getJSONP:function(e){var t=new c.default(e);return t.load()},cloneCategories:function(e,t){return e.map(function(e){return e=m.clone(e),e[t]=e[t].slice(0),e})},mergeCategories:function(e,t,o){e=this.cloneCategories(e,o);var i=null;return t.forEach(function(t){e.forEach(function(e){t.identifier===e.identifier&&(i=e)}),i?i[o]=i[o].concat(t[o]):e.push(t)}),e},getStyleObject:function(e){var t=window.getComputedStyle(e),o={};for(var i in t){var r=t.getPropertyValue(i),a=i.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});''!==r&&(o[a]=r)}return o},debounce:function(e,t,o){var i;return function(){var r=this,a=arguments,n=o&&!i;clearTimeout(i),i=setTimeout(function(){i=null,o||e.apply(r,a)},t),n&&e.apply(this,a)}},getScrollbarWidth:function(){var e=document.createElement('div');e.style.visibility='hidden',e.style.width='100px',e.style.msOverflowStyle='scrollbar',document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow='scroll';var o=document.createElement('div');o.style.width='100%',e.appendChild(o);var i=o.offsetWidth;return e.parentNode.removeChild(e),t-i},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Browser:d.default};t.default=u},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.default={getIEVersion:function(){var e=navigator,t=e.userAgent,o=e.appVersion;return-1===o.indexOf('MSIE')?-1!==t.indexOf('Trident')&&t.match(/rv:([0-9]+)/i)[1]:o.match(/MSIE\s+?([0-9]+)/i)[1]},isIE10:function(){var e=this.getIEVersion();return!1!==e&&10===e},isIE11:function(){var e=this.getIEVersion();return!1!==e&&11===e},isIElte:function(e){var t=this.getIEVersion();return!1!==t&&t<=e}}},function(e,t,o){'use strict';(function(e,i){/*!
 * Native Promise Only
 * v0.8.0-a (c) Kyle Simpson
 * MIT License: http://getify.mit-license.org
 */Object.defineProperty(t,'__esModule',{value:!0});var r=o(14),a=function(e){return e&&e.__esModule?e:{default:e}}(r),n='undefined'==typeof i?window:i,s='undefined'==typeof Promise?function(){function t(e,t){f.add(e,t),g||(g=_(f.drain))}function o(e){var t='undefined'==typeof e?'undefined':(0,a.default)(e),i;return null!=e&&('object'==t||'function'==t)&&(i=e.then),'function'==typeof i&&i}function i(){for(var e=0;e<this.chain.length;e++)r(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function r(e,t,i){var r,a;try{!1===t?i.reject(e.msg):(r=!0===t?e.msg:t.call(void 0,e.msg),r===i.promise?i.reject(TypeError('Promise-chain cycle')):(a=o(r))?a.call(r,i.resolve,i.reject):i.resolve(r))}catch(e){i.reject(e)}}function n(e){var r=this,a;if(!r.triggered){r.triggered=!0,r.def&&(r=r.def);try{(a=o(e))?t(function(){var t=new d(r);try{a.call(e,function(){n.apply(t,arguments)},function(){s.apply(t,arguments)})}catch(e){s.call(t,e)}}):(r.msg=e,r.state=1,0<r.chain.length&&t(i,r))}catch(e){s.call(new d(r),e)}}}function s(e){var o=this;o.triggered||(o.triggered=!0,o.def&&(o=o.def),o.msg=e,o.state=2,0<o.chain.length&&t(i,o))}function l(e,t,o,i){for(var r=0;r<t.length;r++)(function(r){e.resolve(t[r]).then(function(e){o(r,e)},i)})(r)}function d(e){this.def=e,this.triggered=!1}function p(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(e){if('function'!=typeof e)throw TypeError('Not a function');if(0!==this.__NPO__)throw TypeError('Not a promise');this.__NPO__=1;var r=new p(this);this.then=function(e,a){var n={success:'function'!=typeof e||e,failure:'function'==typeof a&&a};return n.promise=new this.constructor(function(e,t){if('function'!=typeof e||'function'!=typeof t)throw TypeError('Not a function');n.resolve=e,n.reject=t}),r.chain.push(n),0!==r.state&&t(i,r),n.promise},this['catch']=function(e){return this.then(void 0,e)};try{e.call(void 0,function(e){n.call(r,e)},function(e){s.call(r,e)})}catch(e){s.call(r,e)}}var m=Object.prototype.toString,_='undefined'==typeof e?setTimeout:function(t){return e(t)},u,g,f;try{Object.defineProperty({},'x',{}),u=function(e,t,o,i){return Object.defineProperty(e,t,{value:o,writable:!0,configurable:!1!==i})}}catch(e){u=function(e,t,o){return e[t]=o,e}}f=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,o,i;return{add:function(r,a){i=new e(r,a),o?o.next=i:t=i,o=i,i=void 0},drain:function(){var e=t;for(t=o=g=void 0;e;)e.fn.call(e.self),e=e.next}}}();var y=u({},'constructor',c,!1);return c.prototype=y,u(y,'__NPO__',0,!1),u(c,'resolve',function(e){var t=this;return e&&'object'==('undefined'==typeof e?'undefined':(0,a.default)(e))&&1===e.__NPO__?e:new t(function(t,o){if('function'!=typeof t||'function'!=typeof o)throw TypeError('Not a function');t(e)})}),u(c,'reject',function(e){return new this(function(t,o){if('function'!=typeof t||'function'!=typeof o)throw TypeError('Not a function');o(e)})}),u(c,'all',function(e){var t=this;return'[object Array]'==m.call(e)?0===e.length?t.resolve([]):new t(function(o,i){if('function'!=typeof o||'function'!=typeof i)throw TypeError('Not a function');var r=e.length,a=Array(r),n=0;l(t,e,function(e,t){a[e]=t,++n===r&&o(a)},i)}):t.reject(TypeError('Not an array'))}),u(c,'race',function(e){var t=this;return'[object Array]'==m.call(e)?new t(function(o,i){if('function'!=typeof o||'function'!=typeof i)throw TypeError('Not a function');l(t,e,function(e,t){o(t)},i)}):t.reject(TypeError('Not an array'))}),c}():Promise;n.Promise=n.Promise||s,t.default=s}).call(t,o(160).setImmediate,o(35))},function(e,t,o){function i(e,t){this._id=e,this._clearFn=t}var r=Function.prototype.apply;t.setTimeout=function(){return new i(r.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(r.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},o(161),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,o){(function(e,t){(function(e){'use strict';function o(e){'function'!=typeof e&&(e=new Function(''+e));for(var t=Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var i={callback:e,args:t};return _[m]=i,y(m),m++}function i(e){delete _[e]}function r(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(void 0,o);}}function a(e){if(u)setTimeout(a,0,e);else{var t=_[e];if(t){u=!0;try{r(t)}finally{i(e),u=!1}}}}function n(){y=function(e){t.nextTick(function(){a(e)})}}function s(){if(e.postMessage&&!e.importScripts){var t=!0,o=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage('','*'),e.onmessage=o,t}}function l(){var t='setImmediate$'+Math.random()+'$',o=function(o){o.source===e&&'string'==typeof o.data&&0===o.data.indexOf(t)&&a(+o.data.slice(t.length))};e.addEventListener?e.addEventListener('message',o,!1):e.attachEvent('onmessage',o),y=function(o){e.postMessage(t+o,'*')}}function d(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},y=function(t){e.port2.postMessage(t)}}function p(){var e=g.documentElement;y=function(t){var o=g.createElement('script');o.onreadystatechange=function(){a(t),o.onreadystatechange=null,e.removeChild(o),o=null},e.appendChild(o)}}function c(){y=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var m=1,_={},u=!1,g=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e),y;f=f&&f.setTimeout?f:e,'[object process]'==={}.toString.call(e.process)?n():s()?l():e.MessageChannel?d():g&&'onreadystatechange'in g.createElement('script')?p():c(),f.setImmediate=o,f.clearImmediate=i}})('undefined'==typeof self?'undefined'==typeof e?this:e:self)}).call(t,o(35),o(61))},function(e,t,o){'use strict';function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(e,t,o){if(e&&n.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,o),r}var a=o(163),n=o(165);t.parse=r,t.resolve=function(e,t){return r(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?r(e,!1,!0).resolveObject(t):t},t.format=function(e){return n.isString(e)&&(e=r(e)),e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var d=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=['{','}','|','\\','^','`'].concat(['<','>','"','`',' ','\r','\n','\t']),c=['\''].concat(p),m=['%','/','?',';','#'].concat(c),_=['/','?','#'],u=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=o(166);i.prototype.parse=function(e,t,o){if(!n.isString(e))throw new TypeError('Parameter \'url\' must be a string, not '+typeof e);var r=e.indexOf('?'),E=-1!==r&&r<e.indexOf('#')?'?':'#',S=e.split(E),M=/\\/g;S[0]=S[0].replace(M,'/'),e=S.join(E);var C=e;if(C=C.trim(),!o&&1===e.split('#').length){var B=l.exec(C);if(B)return this.path=C,this.href=C,this.pathname=B[1],B[2]?(this.search=B[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search='',this.query={}),this}var R=d.exec(C);if(R){R=R[0];var x=R.toLowerCase();this.protocol=x,C=C.substr(R.length)}if(o||R||C.match(/^\/\/[^@\/]+@[^@\/]+/)){var T='//'===C.substr(0,2);T&&!(R&&y[R])&&(C=C.substr(2),this.slashes=!0)}if(!y[R]&&(T||R&&!b[R])){for(var P=-1,D=0,i;D<_.length;D++)i=C.indexOf(_[D]),-1!==i&&(-1==P||i<P)&&(P=i);var O,w;w=-1===P?C.lastIndexOf('@'):C.lastIndexOf('@',P),-1!==w&&(O=C.slice(0,w),C=C.slice(w+1),this.auth=decodeURIComponent(O)),P=-1;for(var D=0,i;D<m.length;D++)i=C.indexOf(m[D]),-1!==i&&(-1===P||i<P)&&(P=i);-1===P&&(P=C.length),this.host=C.slice(0,P),C=C.slice(P),this.parseHost(),this.hostname=this.hostname||'';var I='['===this.hostname[0]&&']'===this.hostname[this.hostname.length-1];if(!I)for(var F=this.hostname.split(/\./),D=0,z=F.length,N;D<z;D++)if(N=F[D],N&&!N.match(u)){for(var A='',V=0,L=N.length;V<L;V++)A+=127<N.charCodeAt(V)?'x':N[V];if(!A.match(u)){var k=F.slice(0,D),U=F.slice(D+1),W=N.match(g);W&&(k.push(W[1]),U.unshift(W[2])),U.length&&(C='/'+U.join('.')+C),this.hostname=k.join('.');break}}this.hostname=this.hostname.length>255?'':this.hostname.toLowerCase(),I||(this.hostname=a.toASCII(this.hostname));var j=this.port?':'+this.port:'',p=this.hostname||'';this.host=p+j,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),'/'!==C[0]&&(C='/'+C))}if(!f[x])for(var D=0,z=c.length,h;D<z;D++)if(h=c[D],-1!==C.indexOf(h)){var K=encodeURIComponent(h);K===h&&(K=escape(h)),C=C.split(h).join(K)}var H=C.indexOf('#');-1!==H&&(this.hash=C.substr(H),C=C.slice(0,H));var $=C.indexOf('?');if(-1===$?t&&(this.search='',this.query={}):(this.search=C.substr($),this.query=C.substr($+1),t&&(this.query=v.parse(this.query)),C=C.slice(0,$)),C&&(this.pathname=C),b[x]&&this.hostname&&!this.pathname&&(this.pathname='/'),this.pathname||this.search){var j=this.pathname||'',q=this.search||'';this.path=j+q}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||'';e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,':'),e+='@');var t=this.protocol||'',o=this.pathname||'',i=this.hash||'',r=!1,a='';this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(':')?this.hostname:'['+this.hostname+']'),this.port&&(r+=':'+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(a=v.stringify(this.query));var s=this.search||a&&'?'+a||'';return t&&':'!==t.substr(-1)&&(t+=':'),this.slashes||(!t||b[t])&&!1!==r?(r='//'+(r||''),o&&'/'!==o.charAt(0)&&(o='/'+o)):!r&&(r=''),i&&'#'!==i.charAt(0)&&(i='#'+i),s&&'?'!==s.charAt(0)&&(s='?'+s),o=o.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace('#','%23'),t+r+o+s+i},i.prototype.resolve=function(e){return this.resolveObject(r(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(n.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var o=new i,r=Object.keys(this),a=0,l;a<r.length;a++)l=r[a],o[l]=this[l];if(o.hash=e.hash,''===e.href)return o.href=o.format(),o;if(e.slashes&&!e.protocol){for(var d=Object.keys(e),c=0,m;c<d.length;c++)m=d[c],'protocol'!==m&&(o[m]=e[m]);return b[o.protocol]&&o.hostname&&!o.pathname&&(o.path=o.pathname='/'),o.href=o.format(),o}if(e.protocol&&e.protocol!==o.protocol){if(!b[e.protocol]){for(var _=Object.keys(e),u=0,g;u<_.length;u++)g=_[u],o[g]=e[g];return o.href=o.format(),o}if(o.protocol=e.protocol,!e.host&&!y[e.protocol]){for(var f=(e.pathname||'').split('/');f.length&&!(e.host=f.shift()););e.host||(e.host=''),e.hostname||(e.hostname=''),''!==f[0]&&f.unshift(''),2>f.length&&f.unshift(''),o.pathname=f.join('/')}else o.pathname=e.pathname;if(o.search=e.search,o.query=e.query,o.host=e.host||'',o.auth=e.auth,o.hostname=e.hostname||e.host,o.port=e.port,o.pathname||o.search){var h=o.pathname||'',p=o.search||'';o.path=h+p}return o.slashes=o.slashes||e.slashes,o.href=o.format(),o}var s=o.pathname&&'/'===o.pathname.charAt(0),k=e.host||e.pathname&&'/'===e.pathname.charAt(0),v=k||s||o.host&&e.pathname,E=v,S=o.pathname&&o.pathname.split('/')||[],f=e.pathname&&e.pathname.split('/')||[],M=o.protocol&&!b[o.protocol];if(M&&(o.hostname='',o.port=null,o.host&&(''===S[0]?S[0]=o.host:S.unshift(o.host)),o.host='',e.protocol&&(e.hostname=null,e.port=null,e.host&&(''===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),v=v&&(''===f[0]||''===S[0])),k)o.host=e.host||''===e.host?e.host:o.host,o.hostname=e.hostname||''===e.hostname?e.hostname:o.hostname,o.search=e.search,o.query=e.query,S=f;else if(f.length)S||(S=[]),S.pop(),S=S.concat(f),o.search=e.search,o.query=e.query;else if(!n.isNullOrUndefined(e.search)){if(M){o.hostname=o.host=S.shift();var C=o.host&&0<o.host.indexOf('@')&&o.host.split('@');C&&(o.auth=C.shift(),o.host=o.hostname=C.shift())}return o.search=e.search,o.query=e.query,n.isNull(o.pathname)&&n.isNull(o.search)||(o.path=(o.pathname?o.pathname:'')+(o.search?o.search:'')),o.href=o.format(),o}if(!S.length)return o.pathname=null,o.path=o.search?'/'+o.search:null,o.href=o.format(),o;for(var B=S.slice(-1)[0],R=(o.host||e.host||1<S.length)&&('.'===B||'..'===B)||''===B,x=0,T=S.length;0<=T;T--)B=S[T],'.'===B?S.splice(T,1):'..'===B?(S.splice(T,1),x++):x&&(S.splice(T,1),x--);if(!v&&!E)for(;x--;x)S.unshift('..');v&&''!==S[0]&&(!S[0]||'/'!==S[0].charAt(0))&&S.unshift(''),R&&'/'!==S.join('/').substr(-1)&&S.push('');var P=''===S[0]||S[0]&&'/'===S[0].charAt(0);if(M){o.hostname=o.host=P?'':S.length?S.shift():'';var C=o.host&&0<o.host.indexOf('@')&&o.host.split('@');C&&(o.auth=C.shift(),o.host=o.hostname=C.shift())}return v=v||o.host&&S.length,v&&!P&&S.unshift(''),S.length?o.pathname=S.join('/'):(o.pathname=null,o.path=null),n.isNull(o.pathname)&&n.isNull(o.search)||(o.path=(o.pathname?o.pathname:'')+(o.search?o.search:'')),o.auth=e.auth||o.auth,o.slashes=o.slashes||e.slashes,o.href=o.format(),o},i.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(t=t[0],':'!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,o){(function(e,i){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(a){function l(e){throw new RangeError(O[e])}function n(e,t){for(var o=e.length,i=[];o--;)i[o]=t(e[o]);return i}function d(e,t){var o=e.split('@'),i='';1<o.length&&(i=o[0]+'@',e=o[1]),e=e.replace(D,'.');var r=e.split('.'),a=n(r,t).join('.');return i+a}function p(e){for(var t=[],o=0,i=e.length,r,a;o<i;)r=e.charCodeAt(o++),55296<=r&&56319>=r&&o<i?(a=e.charCodeAt(o++),56320==(64512&a)?t.push(((1023&r)<<10)+(1023&a)+65536):(t.push(r),o--)):t.push(r);return t}function c(e){return n(e,function(e){var t='';return 65535<e&&(e-=65536,t+=F(55296|1023&e>>>10),e=56320|1023&e),t+=F(e),t}).join('')}function m(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:E}function _(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function u(e,t,o){var i=0;for(e=o?I(e/B):e>>1,e+=I(e/t);e>w*M>>1;i+=E)e=I(e/w);return I(i+(w+1)*e/(e+C))}function g(e){var o=[],r=e.length,a=0,i=x,n=R,s,d,p,_,g,f,y,h,b,t;for(d=e.lastIndexOf(T),0>d&&(d=0),p=0;p<d;++p)128<=e.charCodeAt(p)&&l('not-basic'),o.push(e.charCodeAt(p));for(_=0<d?d+1:0;_<r;){for(g=a,f=1,y=E;;y+=E){if(_>=r&&l('invalid-input'),h=m(e.charCodeAt(_++)),(h>=E||h>I((v-a)/f))&&l('overflow'),a+=h*f,b=y<=n?S:y>=n+M?M:y-n,h<b)break;t=E-b,f>I(v/t)&&l('overflow'),f*=t}s=o.length+1,n=u(a-g,s,0==g),I(a/s)>v-i&&l('overflow'),i+=I(a/s),a%=s,o.splice(a++,0,i)}return c(o)}function f(e){var o=[],i,r,a,n,s,d,c,m,g,f,t,y,h,b,k;for(e=p(e),y=e.length,i=x,r=0,s=R,d=0;d<y;++d)t=e[d],128>t&&o.push(F(t));for(a=n=o.length,n&&o.push(T);a<y;){for(c=v,d=0;d<y;++d)t=e[d],t>=i&&t<c&&(c=t);for(h=a+1,c-i>I((v-r)/h)&&l('overflow'),r+=(c-i)*h,i=c,d=0;d<y;++d)if(t=e[d],t<i&&++r>v&&l('overflow'),t==i){for(m=r,g=E;;g+=E){if(f=g<=s?S:g>=s+M?M:g-s,m<f)break;k=m-f,b=E-f,o.push(F(_(f+k%b,0))),m=I(k/b)}o.push(F(_(m,0))),s=u(r,h,a==n),r=0,++a}++r,++i}return o.join('')}var y='object'==typeof t&&t&&!t.nodeType&&t,h='object'==typeof e&&e&&!e.nodeType&&e,b='object'==typeof i&&i;(b.global===b||b.window===b||b.self===b)&&(a=b);var v=2147483647,E=36,S=1,M=26,C=38,B=700,R=72,x=128,T='-',k=/^xn--/,P=/[^\x20-\x7E]/,D=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:'Overflow: input needs wider integers to process',"not-basic":'Illegal input >= 0x80 (not a basic code point)',"invalid-input":'Invalid input'},w=E-S,I=s,F=String.fromCharCode,z;z={version:'1.4.1',ucs2:{decode:p,encode:c},decode:g,encode:f,toASCII:function(e){return d(e,function(e){return P.test(e)?'xn--'+f(e):e})},toUnicode:function(e){return d(e,function(e){return k.test(e)?g(e.slice(4).toLowerCase()):e})}};r=function(){return z}.call(t,o,t,e),!(void 0!==r&&(e.exports=r))})(this)}).call(t,o(164)(e),o(35))},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,'loaded',{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,'id',{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e){'use strict';e.exports={isString:function(e){return'string'==typeof e},isObject:function(e){return'object'==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,o){'use strict';t.decode=t.parse=o(167),t.encode=t.stringify=o(168)},function(e){'use strict';function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,r,a,n){r=r||'&',a=a||'=';var s={};if('string'!=typeof e||0===e.length)return s;var l=/\+/g;e=e.split(r);var d=1e3;n&&'number'==typeof n.maxKeys&&(d=n.maxKeys);var p=e.length;0<d&&p>d&&(p=d);for(var c=0;c<p;++c){var i=e[c].replace(l,'%20'),m=i.indexOf(a),_,u,g,f;0<=m?(_=i.substr(0,m),u=i.substr(m+1)):(_=i,u=''),g=decodeURIComponent(_),f=decodeURIComponent(u),t(s,g)?o(s[g])?s[g].push(f):s[g]=[s[g],f]:s[g]=f}return s};var o=Array.isArray||function(e){return'[object Array]'===Object.prototype.toString.call(e)}},function(e){'use strict';function t(e,t){if(e.map)return e.map(t);for(var o=[],r=0;r<e.length;r++)o.push(t(e[r],r));return o}var o=function(e){switch(typeof e){case'string':return e;case'boolean':return e?'true':'false';case'number':return isFinite(e)?e:'';default:return'';}};e.exports=function(e,a,n,s){return a=a||'&',n=n||'=',null===e&&(e=void 0),'object'==typeof e?t(r(e),function(r){var s=encodeURIComponent(o(r))+n;return i(e[r])?t(e[r],function(e){return s+encodeURIComponent(o(e))}).join(a):s+encodeURIComponent(o(e[r]))}).join(a):s?encodeURIComponent(o(s))+n+encodeURIComponent(o(e)):''};var i=Array.isArray||function(e){return'[object Array]'===Object.prototype.toString.call(e)},r=Object.keys||function(e){var t=[];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.push(o);return t}},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(34),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default={EVENTS:{RENDER:'render',EXPORT:'export',CLOSE:'close',ZOOM_DONE:'zoom:done',OPERATION_CREATED:'operation:created',OPERATION_UPDATED:'operation:updated',OPERATION_REMOVED:'operation:removed',FEATURES_DISABLED:'editor:features:disabled',FEATURES_ENABLED:'editor:features:enabled',FEATURES_UPDATED:'editor:features:updated',COLORPICKER_OPEN:'colorpicker:open',HISTORY_UPDATED:'history:update',HISTORY_BEFORE_UNDO:'history:before_undo',HISTORY_UNDO:'history:undo',WINDOW_RESIZE:'window:resize',CONTROLS_SWITCHED:'controls:switched',TRANSFORM_REAPPLY_RATIO:'transform:reapply_ratio'},DEFAULTS:{TRANSFORM_RATIOS:[[{identifier:'imgly_transform_common_custom',defaultName:'Custom',ratio:'*',selected:!0},{identifier:'imgly_transform_common_square',defaultName:'Square',ratio:1},{identifier:'imgly_transform_common_4-3',defaultName:'4:3',ratio:1.33},{identifier:'imgly_transform_common_16-9',defaultName:'16:9',ratio:1.77}],[{identifier:'imgly_transform_facebook_profile',defaultName:'FB Profile',ratio:1},{identifier:'imgly_transform_facebook_ad',defaultName:'FB Ad',dimensions:new r.default.Math.Vector2(1200,627)},{identifier:'imgly_transform_facebook_post',defaultName:'FB Post',dimensions:new r.default.Math.Vector2(940,788)},{identifier:'imgly_transform_facebook_cover',defaultName:'FB Cover',dimensions:new r.default.Math.Vector2(851,315)}]],BRUSHES:[r.default.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush],FONTS:[{fontFamily:'Aleo',variations:[{identifier:'imgly_font_aleo_bold',fontWeight:'bold',provider:'file',filePath:'fonts/imgly_font_aleo_bold.woff'}]},{fontFamily:'Amatic SC',variations:[{identifier:'imgly_font_amaticsc',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_amaticsc.woff'}]},{fontFamily:'Bernier',variations:[{identifier:'imgly_font_bernier_regular',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_bernier_regular.woff'}]},{fontFamily:'Cheque',variations:[{identifier:'imgly_font_cheque_regular',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_cheque_regular.woff'}]},{fontFamily:'Open Sans',variations:[{identifier:'imgly_font_open_sans_bold',fontWeight:'bold',provider:'file',filePath:'fonts/imgly_font_open_sans_bold.woff',default:!0}]},{fontFamily:'Gagalin',variations:[{identifier:'imgly_font_gagalin_regular',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_gagalin_regular.woff'}]},{fontFamily:'Hagin',variations:[{identifier:'imgly_font_hagin_caps_thin',fontWeight:200,provider:'file',filePath:'fonts/imgly_font_hagin_caps_thin.woff'}]},{fontFamily:'Intro',variations:[{identifier:'imgly_font_intro_inline',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_intro_inline.woff'}]},{fontFamily:'Lobster',variations:[{identifier:'imgly_font_lobster',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_lobster.woff'}]},{fontFamily:'Nexa',variations:[{identifier:'imgly_font_nexa_script',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_nexa_script.woff'}]},{fontFamily:'Ostrich',variations:[{identifier:'imgly_font_ostrich_sans_black',fontWeight:800,provider:'file',filePath:'fonts/imgly_font_ostrich_sans_black.woff'},{identifier:'imgly_font_ostrich_sans_bold',fontWeight:'bold',provider:'file',filePath:'fonts/imgly_font_ostrich_sans_bold.woff'}]},{fontFamily:'Panton',variations:[{identifier:'imgly_font_panton_blackitalic_caps',fontWeight:800,fontStyle:'italic',provider:'file',filePath:'fonts/imgly_font_panton_blackitalic_caps.woff'},{identifier:'imgly_font_panton_lightitalic_caps',fontWeight:200,fontStyle:'italic',provider:'file',filePath:'fonts/imgly_font_panton_lightitalic_caps.woff'}]},{fontFamily:'Perfograma',variations:[{identifier:'imgly_font_perfograma',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_perfograma.woff'}]},{fontFamily:'Trashhand',variations:[{identifier:'imgly_font_trash_hand',fontWeight:'normal',provider:'file',filePath:'fonts/imgly_font_trash_hand.woff'}]}]}}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(14),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(34),_=i(m),u=_.default.EventEmitter,g=_.default.Utils,f=_.default.Log,y=function(e){function t(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(0,s.default)(this,t);var i=(0,d.default)(this,e.call(this));return i._state=o,i}return(0,c.default)(t,e),t.prototype.set=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;'object'!==('undefined'==typeof e?'undefined':(0,a.default)(e))&&f.warn('SharedState#set expects an object as first parameter');var o=g.extend({},this._state);this._state=g.extend(this._state,e),t&&this.broadcastUpdate(o,this._state)},t.prototype.get=function(e){return this._state[e]},t.prototype.broadcastUpdate=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.emit('update',e,t)},t.prototype.clear=function(){this._state={}},t}(u);t.default=y},function(e,t,o){'use strict';(function(e){Object.defineProperty(t,'__esModule',{value:!0});/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */for(var o='undefined'==typeof window?e:window,i=o.requestAnimationFrame,r=o.cancelAnimationFrame,a=0,n=['ms','moz','webkit','o'],s=0;s<n.length&&!i;++s)t.requestAnimationFrame=i=o[n[s]+'RequestAnimationFrame'],t.cancelAnimationFrame=r=o[n[s]+'CancelAnimationFrame']||o[n[s]+'CancelRequestAnimationFrame'];i||(t.requestAnimationFrame=i=function(e){var t=new Date().getTime(),o=c(0,16-(t-a)),i=setTimeout(function(){e(t+o)},o);return a=t+o,i}),r||(t.cancelAnimationFrame=r=function(e){clearTimeout(e)}),t.requestAnimationFrame=i,t.cancelAnimationFrame=r}).call(t,o(35))},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.default={DEFAULTS:{FILTERS:[{identifier:'imgly_filters_analog',defaultName:'Analog',filters:[{identifier:'imgly_lut_cool',defaultName:'Cool',lutImage:'filters/imgly_lut_cool_5_5_128.png'},{identifier:'imgly_lut_blues',defaultName:'Blues',lutImage:'filters/imgly_lut_blues_5_5_128.png'},{identifier:'imgly_lut_blueshadows',defaultName:'Blue Shadows',lutImage:'filters/imgly_lut_blueshadows_5_5_128.png'},{identifier:'imgly_lut_k6',defaultName:'K6',lutImage:'filters/imgly_lut_k6_5_5_128.png'},{identifier:'imgly_lut_kdynamic',defaultName:'KDynamic',lutImage:'filters/imgly_lut_kdynamic_5_5_128.png'},{identifier:'imgly_lut_lucid',defaultName:'Lucid',lutImage:'filters/imgly_lut_lucid_5_5_128.png'},{identifier:'imgly_lut_pale',defaultName:'Pale',lutImage:'filters/imgly_lut_pale_5_5_128.png'}]},{identifier:'imgly_filters_bw',defaultName:'Black & White',filters:[{identifier:'imgly_lut_sin',defaultName:'Sin',lutImage:'filters/imgly_lut_sin_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_ad1920',defaultName:'1920 A.D.',lutImage:'filters/imgly_lut_ad1920_5_5_128.png'},{identifier:'imgly_lut_bw',defaultName:'B & W',lutImage:'filters/imgly_lut_bw_5_5_128.png'},{identifier:'imgly_lut_litho',defaultName:'Litho',lutImage:'filters/imgly_lut_litho_5_5_128.png'},{identifier:'imgly_lut_plate',defaultName:'Plate',lutImage:'filters/imgly_lut_plate_5_5_128.png'},{identifier:'imgly_lut_x400',defaultName:'X400',lutImage:'filters/imgly_lut_x400_5_5_128.png'}]},{identifier:'imgly_filters_retro',defaultName:'Retro',filters:[{identifier:'imgly_lut_celsius',defaultName:'Celsius',lutImage:'filters/imgly_lut_celsius_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_k2',defaultName:'K2',lutImage:'filters/imgly_lut_k2_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_sepiahigh',defaultName:'Sepia High',lutImage:'filters/imgly_lut_sepiahigh_5_5_128.png'},{identifier:'imgly_lut_ancient',defaultName:'Ancient',lutImage:'filters/imgly_lut_ancient_5_5_128.png'},{identifier:'imgly_lut_classic',defaultName:'Classic',lutImage:'filters/imgly_lut_classic_5_5_128.png'},{identifier:'imgly_lut_eighties',defaultName:'Eighties',lutImage:'filters/imgly_lut_eighties_5_5_128.png'},{identifier:'imgly_lut_elder',defaultName:'Elder',lutImage:'filters/imgly_lut_elder_5_5_128.png'},{identifier:'imgly_lut_glam',defaultName:'Glam',lutImage:'filters/imgly_lut_glam_5_5_128.png'},{identifier:'imgly_lut_gobblin',defaultName:'Gobblin',lutImage:'filters/imgly_lut_gobblin_5_5_128.png'},{identifier:'imgly_lut_orchid',defaultName:'Orchid',lutImage:'filters/imgly_lut_orchid_5_5_128.png'},{identifier:'imgly_lut_seventies',defaultName:'Seventies',lutImage:'filters/imgly_lut_seventies_5_5_128.png'}]},{identifier:'imgly_filters_special',defaultName:'Special',filters:[{identifier:'imgly_lut_fixie',defaultName:'Fixie',lutImage:'filters/imgly_lut_fixie_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_colorful',defaultName:'Colorful',lutImage:'filters/imgly_lut_colorful_5_5_128.png'},{identifier:'imgly_lut_cottoncandy',defaultName:'Cotton Candy',lutImage:'filters/imgly_lut_cottoncandy_5_5_128.png'},{identifier:'imgly_lut_food',defaultName:'Food',lutImage:'filters/imgly_lut_food_5_5_128.png'},{identifier:'imgly_lut_highcontrast',defaultName:'High Contrast',lutImage:'filters/imgly_lut_highcontrast_5_5_128.png'},{identifier:'imgly_lut_k1',defaultName:'K1',lutImage:'filters/imgly_lut_k1_5_5_128.png'},{identifier:'imgly_lut_lomo100',defaultName:'Lomo 100',lutImage:'filters/imgly_lut_lomo100_5_5_128.png'},{identifier:'imgly_lut_neat',defaultName:'Neat',lutImage:'filters/imgly_lut_neat_5_5_128.png'},{identifier:'imgly_lut_nogreen',defaultName:'No Green',lutImage:'filters/imgly_lut_nogreen_5_5_128.png'},{identifier:'imgly_lut_pola669',defaultName:'Pola 669',lutImage:'filters/imgly_lut_pola669_5_5_128.png'},{identifier:'imgly_lut_polasx',defaultName:'Pola SX',lutImage:'filters/imgly_lut_polasx_5_5_128.png'},{identifier:'imgly_lut_pro400',defaultName:'Pro 400',lutImage:'filters/imgly_lut_pro400_5_5_128.png'},{identifier:'imgly_lut_twilight',defaultName:'Twilight',lutImage:'filters/imgly_lut_twilight_5_5_128.png'},{identifier:'imgly_lut_settled',defaultName:'Settled',lutImage:'filters/imgly_lut_settled_5_5_128.png'},{identifier:'imgly_lut_steel',defaultName:'Steel',lutImage:'filters/imgly_lut_steel_5_5_128.png'}]},{identifier:'imgly_filters_summer',defaultName:'Summer',filters:[{identifier:'imgly_lut_texas',defaultName:'Texas',lutImage:'filters/imgly_lut_texas_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_mellow',defaultName:'Mellow',lutImage:'filters/imgly_lut_mellow_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_chest',defaultName:'Chest',lutImage:'filters/imgly_lut_chest_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_creamy',defaultName:'Creamy',lutImage:'filters/imgly_lut_creamy_5_5_128.png'},{identifier:'imgly_lut_evening',defaultName:'Evening',lutImage:'filters/imgly_lut_evening_5_5_128.png'},{identifier:'imgly_lut_fall',defaultName:'Fall',lutImage:'filters/imgly_lut_fall_5_5_128.png'},{identifier:'imgly_lut_front',defaultName:'Front',lutImage:'filters/imgly_lut_front_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_highcarb',defaultName:'High Carb',lutImage:'filters/imgly_lut_highcarb_5_5_128.png'},{identifier:'imgly_lut_keen',defaultName:'Keen',lutImage:'filters/imgly_lut_keen_5_5_128.png'},{identifier:'imgly_lut_pitched',defaultName:'Pitched',lutImage:'filters/imgly_lut_pitched_5_5_128.png'},{identifier:'imgly_lut_soft',defaultName:'Soft',lutImage:'filters/imgly_lut_soft_5_5_128.png'},{identifier:'imgly_lut_summer',defaultName:'Summer',lutImage:'filters/imgly_lut_summer_5_5_128.png'},{identifier:'imgly_lut_sunset',defaultName:'Sunset',lutImage:'filters/imgly_lut_sunset_5_5_128.png'},{identifier:'imgly_lut_tender',defaultName:'Tender',lutImage:'filters/imgly_lut_tender_5_5_128.png'}]},{identifier:'imgly_filters_winter',defaultName:'Winter',filters:[{identifier:'imgly_lut_fridge',defaultName:'Fridge',lutImage:'filters/imgly_lut_fridge_8_8_512.png',resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:'imgly_lut_bleached',defaultName:'Bleached',lutImage:'filters/imgly_lut_bleached_5_5_128.png'},{identifier:'imgly_lut_bleachedblue',defaultName:'Bleached Blue',lutImage:'filters/imgly_lut_bleachedblue_5_5_128.png'},{identifier:'imgly_lut_breeze',defaultName:'Breeze',lutImage:'filters/imgly_lut_breeze_5_5_128.png'},{identifier:'imgly_lut_lenin',defaultName:'Lenin',lutImage:'filters/imgly_lut_lenin_5_5_128.png'},{identifier:'imgly_lut_quozi',defaultName:'Quozi',lutImage:'filters/imgly_lut_quozi_5_5_128.png'},{identifier:'imgly_lut_winter',defaultName:'Winter',lutImage:'filters/imgly_lut_winter_5_5_128.png'}]}],OVERLAYS:[{identifier:'imgly_overlay_golden',defaultName:'Golden',image:'overlays/imgly_overlay_golden.jpg',thumbnail:'overlays/imgly_overlay_golden_thumb.jpg',blendMode:'lighten'},{identifier:'imgly_overlay_bokeh',defaultName:'Bokeh',image:'overlays/imgly_overlay_bokeh.jpg',thumbnail:'overlays/imgly_overlay_bokeh_thumb.jpg',blendMode:'lighten'},{identifier:'imgly_overlay_hearts',defaultName:'Hearts',image:'overlays/imgly_overlay_hearts.jpg',thumbnail:'overlays/imgly_overlay_hearts_thumb.jpg',blendMode:'screen'},{identifier:'imgly_overlay_lightleak1',defaultName:'Light Leak',image:'overlays/imgly_overlay_lightleak1.jpg',thumbnail:'overlays/imgly_overlay_lightleak1_thumb.jpg',blendMode:'screen'},{identifier:'imgly_overlay_lightleak2',defaultName:'Light Leak 2',image:'overlays/imgly_overlay_lightleak2.jpg',thumbnail:'overlays/imgly_overlay_lightleak2_thumb.jpg',blendMode:'lighten'},{identifier:'imgly_overlay_rain',defaultName:'Rain',image:'overlays/imgly_overlay_rain.jpg',thumbnail:'overlays/imgly_overlay_rain_thumb.jpg',blendMode:'overlay'},{identifier:'imgly_overlay_wood',defaultName:'Wood',image:'overlays/imgly_overlay_wood.jpg',thumbnail:'overlays/imgly_overlay_wood_thumb.jpg',blendMode:'multiply'},{identifier:'imgly_overlay_mosaic',defaultName:'Mosaic',image:'overlays/imgly_overlay_mosaic.jpg',thumbnail:'overlays/imgly_overlay_mosaic_thumb.jpg',blendMode:'multiply'},{identifier:'imgly_overlay_chop',defaultName:'Chop',image:'overlays/imgly_overlay_chop.jpg',thumbnail:'overlays/imgly_overlay_chop_thumb.jpg',blendMode:'multiply'},{identifier:'imgly_overlay_vintage',defaultName:'Vintage',image:'overlays/imgly_overlay_vintage.jpg',thumbnail:'overlays/imgly_overlay_vintage_thumb.jpg',blendMode:'darken'},{identifier:'imgly_overlay_metal',defaultName:'Metal',image:'overlays/imgly_overlay_metal.jpg',thumbnail:'overlays/imgly_overlay_metal_thumb.jpg',blendMode:'overlay'},{identifier:'imgly_overlay_paper',defaultName:'Paper',image:'overlays/imgly_overlay_paper.jpg',thumbnail:'overlays/imgly_overlay_paper_thumb.jpg',blendMode:'multiply'},{identifier:'imgly_overlay_painting',defaultName:'Painting',image:'overlays/imgly_overlay_painting.jpg',thumbnail:'overlays/imgly_overlay_painting_thumb.jpg',blendMode:'overlay'},{identifier:'imgly_overlay_grain',defaultName:'Grain',image:'overlays/imgly_overlay_grain.jpg',thumbnail:'overlays/imgly_overlay_grain_thumb.jpg',blendMode:'overlay'},{identifier:'imgly_overlay_clouds',defaultName:'Clouds',image:'overlays/imgly_overlay_clouds.jpg',thumbnail:'overlays/imgly_overlay_clouds_thumb.jpg',blendMode:'softLight'},{identifier:'imgly_overlay_wall1',defaultName:'Wall',image:'overlays/imgly_overlay_wall1.jpg',thumbnail:'overlays/imgly_overlay_wall1_thumb.jpg',blendMode:'lighten'},{identifier:'imgly_overlay_wall2',defaultName:'Wall 2',image:'overlays/imgly_overlay_wall2.jpg',thumbnail:'overlays/imgly_overlay_wall2_thumb.jpg',blendMode:'overlay'}],FRAME_CATEGORIES:[{identifier:'imgly_frame_generic',defaultName:'Generic',metaData:{backgroundImage:'frames/generic.png'},frames:[{identifier:'imgly_frame_dia',defaultName:'Dia',layoutMode:'horizontal-inside',thumbnail:'frames/imgly_frame_dia/imgly_frame_dia_thumb.png',imageGroups:{top:{mid:{image:'frames/imgly_frame_dia/imgly_frame_dia_top.png',mode:'repeat'}},left:{start:'frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png',mid:'frames/imgly_frame_dia/imgly_frame_dia_left.png',end:'frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png'},right:{start:'frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png',mid:'frames/imgly_frame_dia/imgly_frame_dia_right.png',end:'frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png'},bottom:{mid:{image:'frames/imgly_frame_dia/imgly_frame_dia_bottom.png',mode:'repeat'}}}},{identifier:'imgly_frame_art_decor',defaultName:'Art Decor',tintable:!0,layoutMode:'horizontal-inside',thumbnail:'frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png',imageGroups:{top:{start:'frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png',mid:{image:'frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png',mode:'stretch'},end:'frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png'},left:{mid:{image:'frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png',mode:'stretch'}},right:{mid:{image:'frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png',mode:'stretch'}},bottom:{start:'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png',mid:{image:'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png',mode:'stretch'},end:'frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png'}}},{identifier:'imgly_frame_black_passepartout',defaultName:'Black Passepartout',layoutMode:'horizontal-inside',thumbnail:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png',imageGroups:{top:{start:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png',mid:{image:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png',mode:'stretch'},end:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png'},left:{mid:{image:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png',mode:'stretch'}},right:{mid:{image:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png',mode:'stretch'}},bottom:{start:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png',mid:{image:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png',mode:'stretch'},end:'frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png'}}},{identifier:'imgly_frame_lowpoly_shadow',defaultName:'Low Poly',layoutMode:'horizontal-inside',thumbnail:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png',imageGroups:{top:{start:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png',mid:{image:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png',mode:'stretch'},end:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png'},left:{mid:{image:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png',mode:'stretch'}},right:{mid:{image:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png',mode:'stretch'}},bottom:{start:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png',mid:{image:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png',mode:'stretch'},end:'frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png'}}},{identifier:'imgly_frame_wood_passepartout',defaultName:'Wood Passepartout',layoutMode:'horizontal-inside',thumbnail:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png',imageGroups:{top:{start:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png',mid:{image:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png',mode:'stretch'},end:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png'},left:{mid:{image:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png',mode:'stretch'}},right:{mid:{image:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png',mode:'stretch'}},bottom:{start:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png',mid:{image:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png',mode:'stretch'},end:'frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png'}}}]}],STICKER_CATEGORIES:[{identifier:'imgly_sticker_emoticons',defaultName:'Emoticons',metaData:{backgroundImage:'stickers/emoticons/background.png'},stickers:[{identifier:'imgly_sticker_emoticons_alien',defaultName:'Alien',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_angel',defaultName:'Angel',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png'],width:62,height:64},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png'],width:62,height:64}}},{identifier:'imgly_sticker_emoticons_angry',defaultName:'Angry',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png'],width:62,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png'],width:62,height:62}}},{identifier:'imgly_sticker_emoticons_anxious',defaultName:'Anxious',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_asleep',defaultName:'Asleep',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_attention',defaultName:'Attention',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png'],width:62,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png'],width:62,height:60}}},{identifier:'imgly_sticker_emoticons_baby_chicken',defaultName:'Baby Chicken',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png'],width:61,height:42},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png'],width:61,height:42}}},{identifier:'imgly_sticker_emoticons_batman',defaultName:'Batman',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_beer',defaultName:'Beer',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png'],width:62,height:59},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png'],width:62,height:59}}},{identifier:'imgly_sticker_emoticons_blush',defaultName:'Blush',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_boxer',defaultName:'Boxer',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png'],width:62,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png'],width:62,height:62}}},{identifier:'imgly_sticker_emoticons_business',defaultName:'Business',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png'],width:60,height:63},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png'],width:60,height:63}}},{identifier:'imgly_sticker_emoticons_chicken',defaultName:'Chicken',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png'],width:63,height:55},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png'],width:63,height:55}}},{identifier:'imgly_sticker_emoticons_cool',defaultName:'Cool',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_cry',defaultName:'Cry',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_deceased',defaultName:'Deceased',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_devil',defaultName:'Devil',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_duckface',defaultName:'Duckface',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_furious',defaultName:'Furious',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png'],width:62,height:61},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png'],width:62,height:61}}},{identifier:'imgly_sticker_emoticons_grin',defaultName:'Grin',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_guitar',defaultName:'Guitar',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png'],width:64,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png'],width:64,height:60}}},{identifier:'imgly_sticker_emoticons_harry_potter',defaultName:'Harry Potter',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png'],width:64,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png'],width:64,height:62}}},{identifier:'imgly_sticker_emoticons_hippie',defaultName:'Hippie',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png'],width:62,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png'],width:62,height:62}}},{identifier:'imgly_sticker_emoticons_hitman',defaultName:'Hitman',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png'],width:64,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png'],width:64,height:60}}},{identifier:'imgly_sticker_emoticons_humourous',defaultName:'Humourous',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png'],width:64,height:64},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png'],width:64,height:64}}},{identifier:'imgly_sticker_emoticons_idea',defaultName:'Idea',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png'],width:64,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png'],width:64,height:62}}},{identifier:'imgly_sticker_emoticons_impatient',defaultName:'Impatient',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_kiss',defaultName:'Kiss',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_kisses',defaultName:'Kisses',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_laugh',defaultName:'Laugh',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_loud_cry',defaultName:'Loud Cry',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png'],width:64,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png'],width:64,height:58}}},{identifier:'imgly_sticker_emoticons_loving',defaultName:'Loving',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_masked',defaultName:'Masked',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png'],width:62,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png'],width:62,height:62}}},{identifier:'imgly_sticker_emoticons_music',defaultName:'Music',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png'],width:62,height:54},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png'],width:62,height:54}}},{identifier:'imgly_sticker_emoticons_nerd',defaultName:'Nerd',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png'],width:64,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png'],width:64,height:58}}},{identifier:'imgly_sticker_emoticons_ninja',defaultName:'Ninja',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_not_speaking_to_you',defaultName:'Not Speaking To You',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_pig',defaultName:'Pig',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png'],width:63,height:41},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png'],width:63,height:41}}},{identifier:'imgly_sticker_emoticons_pumpkin',defaultName:'Pumpkin',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png'],width:62,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png'],width:62,height:60}}},{identifier:'imgly_sticker_emoticons_question',defaultName:'Question',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png'],width:62,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png'],width:62,height:62}}},{identifier:'imgly_sticker_emoticons_rabbit',defaultName:'Rabbit',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png'],width:65,height:47},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png'],width:65,height:47}}},{identifier:'imgly_sticker_emoticons_sad',defaultName:'Sad',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_sick',defaultName:'Sick',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_skateboard',defaultName:'Skateboard',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png'],width:62,height:64},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png'],width:62,height:64}}},{identifier:'imgly_sticker_emoticons_skull',defaultName:'Skull',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png'],width:62,height:62},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png'],width:62,height:62}}},{identifier:'imgly_sticker_emoticons_sleepy',defaultName:'Sleepy',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png'],width:62,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png'],width:62,height:60}}},{identifier:'imgly_sticker_emoticons_smile',defaultName:'Smile',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_smoking',defaultName:'Smoking',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_sobbing',defaultName:'Sobbing',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png'],width:62,height:59},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png'],width:62,height:59}}},{identifier:'imgly_sticker_emoticons_star',defaultName:'Star',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png'],width:64,height:64},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png'],width:64,height:64}}},{identifier:'imgly_sticker_emoticons_steaming_furious',defaultName:'Steaming Furious',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_sunbathing',defaultName:'Sunbathing',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_tired',defaultName:'Tired',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png'],width:62,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png'],width:62,height:60}}},{identifier:'imgly_sticker_emoticons_tongue_out_wink',defaultName:'Tongue Out Wink',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_wave',defaultName:'Wave',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png'],width:62,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png'],width:62,height:60}}},{identifier:'imgly_sticker_emoticons_wide_grin',defaultName:'Wide Grin',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_wink',defaultName:'Wink',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png'],width:62,height:58},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png'],width:62,height:58}}},{identifier:'imgly_sticker_emoticons_wrestler',defaultName:'Wrestler',images:{mediaThumb:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg','stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png'],width:62,height:60},mediaBase:{uris:['stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg','stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png'],width:62,height:60}}}]},{identifier:'imgly_sticker_shapes',defaultName:'Shapes',metaData:{backgroundImage:'stickers/shapes/background.png'},stickers:[{identifier:'imgly_sticker_shapes_arrow_02',defaultName:'Arrow 1',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png'],width:2e3,height:1236},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png'],width:2e3,height:1236}}},{identifier:'imgly_sticker_shapes_arrow_03',defaultName:'Arrow 2',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png'],width:2e3,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png'],width:2e3,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_01',defaultName:'Badge 1',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png'],width:2e3,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png'],width:2e3,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_04',defaultName:'Badge 2',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png'],width:2e3,height:1589},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png'],width:2e3,height:1589}}},{identifier:'imgly_sticker_shapes_badge_06',defaultName:'Badge 3',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png'],width:2e3,height:1733},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png'],width:2e3,height:1733}}},{identifier:'imgly_sticker_shapes_badge_08',defaultName:'Badge 4',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png'],width:2e3,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png'],width:2e3,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_11',defaultName:'Badge 5',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png'],width:2e3,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png'],width:2e3,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_12',defaultName:'Badge 6',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png'],width:2001,height:1903},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png'],width:2001,height:1903}}},{identifier:'imgly_sticker_shapes_badge_13',defaultName:'Badge 7',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png'],width:2e3,height:1718},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png'],width:2e3,height:1718}}},{identifier:'imgly_sticker_shapes_badge_15',defaultName:'Badge 8',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png'],width:1618,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png'],width:1618,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_18',defaultName:'Badge 9',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png'],width:1198,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png'],width:1198,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_19',defaultName:'Badge 10',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png'],width:2127,height:481},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png'],width:2127,height:481}}},{identifier:'imgly_sticker_shapes_badge_20',defaultName:'Badge 11',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png'],width:2e3,height:1404},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png'],width:2e3,height:1404}}},{identifier:'imgly_sticker_shapes_badge_28',defaultName:'Badge 12',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png'],width:2e3,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png'],width:2e3,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_32',defaultName:'Badge 13',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png'],width:1960,height:2e3},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png'],width:1960,height:2e3}}},{identifier:'imgly_sticker_shapes_badge_35',defaultName:'Badge 14',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png'],width:2e3,height:2002},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png'],width:2e3,height:2002}}},{identifier:'imgly_sticker_shapes_badge_36',defaultName:'Badge 15',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png'],width:2e3,height:1668},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png'],width:2e3,height:1668}}},{identifier:'imgly_sticker_shapes_spray_01',defaultName:'Spray 1',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png'],width:1912,height:2039},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png'],width:1912,height:2039}}},{identifier:'imgly_sticker_shapes_spray_03',defaultName:'Spray 2',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png'],width:1681,height:1779},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png'],width:1681,height:1779}}},{identifier:'imgly_sticker_shapes_spray_04',defaultName:'Spray 3',tintMode:'solid',images:{mediaThumb:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg','stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png'],width:1407,height:2248},mediaBase:{uris:['stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg','stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png'],width:1407,height:2248}}}]}]}}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(174),u=i(_),g=o(176),f=i(g),y=o(186),h=i(y),b=o(203),k=i(b),v=o(205),E=i(v),S=o(23),M=i(S),C=o(282),B=i(C),R=o(5),x=i(R),T=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,d.default)(this,e.call.apply(e,[this].concat(i)));n._screens={loading:u.default,splash:f.default,photoRoll:h.default,webcam:k.default,editor:E.default,empty:M.default};var l;return n.props.options.preloader&&(l='loading'),n._screenAfterLoading,n._screenAfterLoading=n.props.options.editor.image?'editor':'splash',l||(l=n._screenAfterLoading),n._previousScreensStack=[],n.state={activeScreen:n._screens[l],activeScreenName:l,screens:(0,a.default)({},l,n._screens[l])},n}return(0,c.default)(t,e),t.prototype.hasPreviousScreen=function(){return!!this._previousScreensStack.length},t.prototype.getPreviousScreen=function(){var e=this._previousScreensStack;return e[e.length-1]},t.prototype.switchToScreen=function(e){var t=this,o=null;if('back'!==e){if('post-loading'===e&&(e=this._screenAfterLoading),o=this._screens[e],!o)throw new Error('Unknown screen `'+e+'`');this._previousScreensStack.push(this.state.activeScreen)}else if(o=this._previousScreensStack.pop(),!o)throw new Error('Unable to switch to previous screen - no previous screen found.');return this.state.screens[e]||(this.state.screens[e]=o),'editor'!==this.state.activeScreenName&&delete this.state.screens[this.state.activeScreenName],new m.Promise(function(i){t.setState({activeScreen:o,activeScreenName:e},function(){i()})})},t.prototype.setImage=function(e,t){var o=this,i=this.props.options;i.editor.image=e;var r=!this.refs.editorScreen;this.switchToScreen('editor').then(function(){r||o.refs.editorScreen.setImage(e,t)})},t.prototype.export=function(){if(this.state.activeScreen!==this._screens.editor)return m.Promise.reject(new Error('Unable to export: Active screen is not the editor screen.'));if(this.state.screens.editor){var e;return(e=this.refs.editorScreen).export.apply(e,arguments)}},t.prototype.getEditor=function(){return this.state.activeScreen===this._screens.editor?this.state.screens.editor?this.refs.editorScreen.getEditor():void 0:m.Promise.reject(new Error('Unable to get editor: Active screen is not the editor screen.'))},t.prototype.serialize=function(){var e;return this.state.screens.editor?(e=this.refs.editorScreen).serialize.apply(e,arguments):m.Promise.reject(new Error('Editor screen unavailable'))},t.prototype.deserialize=function(e){return this.state.screens.editor?this.refs.editorScreen.deserialize(e):m.Promise.reject(new Error('Editor screen unavailable'))},t.prototype.getChildContext=function(){return{ui:this.props.ui,options:this.props.options,mediator:this.props.mediator}},t.prototype._renderScreens=function(){var e=[];for(var t in this.state.screens){var o=this.state.screens[t],i=this.state.activeScreen===o;e.push(m.ReactBEM.createElement(o,{ref:t+'Screen',app:this,visible:i}))}return e},t.prototype.render=function(){return m.ReactBEM.transform(m.ReactBEM.createElement('div',{bem:'b:editor'},m.ReactBEM.createElement(B.default,{modalManager:x.default.instance}),this._renderScreens()))},t}(m.React.Component);t.default=T,T.childContextTypes={ui:m.PropTypes.object.isRequired,mediator:m.PropTypes.object.isRequired,options:m.PropTypes.object.isRequired},T.propTypes={ui:m.PropTypes.object.isRequired,mediator:m.PropTypes.object.isRequired,options:m.PropTypes.object.isRequired}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),s=o(2),l=i(s),d=o(3),p=i(d),c=o(1),m=o(23),_=i(m),u=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,l.default)(this,e.call.apply(e,[this].concat(i)));return n.state={progress:0},n._preloader=n.context.ui.getPreloader(),n._preloader.on('progress',function(e){n.state.progress=e}),n._preloader.on('done',function(){n.props.app.switchToScreen('post-loading')}),n}return(0,p.default)(t,e),t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=window,i=o.devicePixelRatio;this._canvas=this.refs.canvas,this._canvas.width=this._canvas.offsetWidth*i,this._canvas.height=this._canvas.offsetHeight*i,this._context=this._canvas.getContext('2d'),this._preloaderImage=new window.Image,this._preloaderImage.addEventListener('load',function(){t._preloader.load(),(0,c.requestAnimationFrame)(t._tick)}),this._preloaderImage.crossOrigin='Anonymous',this._preloaderImage.src=this.context.ui.getAssetPath('preloader.png',!0),this._running=!0,this._tick=this._tick.bind(this)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._running=!1},t.prototype._tick=function(){this._renderLoadingIndicator(),this._running&&(0,c.requestAnimationFrame)(this._tick)},t.prototype._renderLoadingIndicator=function(){var e=this._canvas,t=e.width,o=e.height,i=this._context;i.clearRect(0,0,t,o),i.save(),i.beginPath(),i.moveTo(t/2,o/2),i.arc(t/2,o/2,t/2,0.5*-n,2*n*this.state.progress-0.5*n,!1),i.lineTo(t/2,o/2),i.clip(),i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,t,o),i.restore(),i.save(),i.globalAlpha=0.05,i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,t,o),i.restore()},t.prototype._renderScreen=function(){return c.ReactBEM.createElement('div',{bem:'$b:loadingScreen'},c.ReactBEM.createElement('div',{bem:'e:container'},c.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'})))},t}(_.default);t.default=u,u.contextTypes=c.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onCloseClick'),n}return(0,d.default)(t,e),t.prototype._onCloseClick=function(){this.context.mediator.emit(p.Constants.EVENTS.CLOSE)},t.prototype.renderWithBEM=function(){var e;return this.context.options.showCloseButton&&(e=p.ReactBEM.createElement('div',{bem:'$e:close',onClick:this._onCloseClick},p.ReactBEM.createElement('img',{bem:'e:image',src:this._getAssetPath('close.png',!0)}))),p.ReactBEM.createElement('div',{bem:'$b:header'},p.ReactBEM.createElement('div',{bem:'e:label'},this.context.options.title),e)},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(23),m=i(c),_=o(177),u=i(_),g=o(184),f=i(g),y=o(185),h=i(y),b=function(e){function t(){(0,a.default)(this,t);var o=(0,s.default)(this,e.call(this));return o._bindAll('_onWebcamClick','_onPhotoRollClick','_onImage'),o}return(0,d.default)(t,e),t.prototype._onPhotoRollClick=function(){this.props.app.switchToScreen('photoRoll')},t.prototype._onWebcamClick=function(){this.props.app.switchToScreen('webcam')},t.prototype._onImage=function(e){this.props.app.setImage(e)},t.prototype._isWebcamAvailable=function(){return!p.Utils.isMobile()&&!1!==this.context.options.enableWebcam},t.prototype._isPhotoRollAvailable=function(){return!!this.context.options.photoRoll.provider},t.prototype._renderScreen=function(){var e=[],t=0,o=this.context.options.enableUpload;o&&t++;var i=this._isWebcamAvailable();i&&t++;var r=this._isPhotoRollAvailable();return r&&t++,o&&e.push(p.ReactBEM.createElement(u.default,{onImage:this._onImage,totalRows:t})),i&&e.push(p.ReactBEM.createElement(f.default,{onClick:this._onWebcamClick,totalRows:t})),r&&e.push(p.ReactBEM.createElement(h.default,{onClick:this._onPhotoRollClick,totalRows:t})),p.ReactBEM.createElement('div',{bem:'$b:splashScreen'},p.ReactBEM.createElement('div',{bem:'e:container'},e))},t}(m.default);t.default=b,b.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(29),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(5),u=i(_),g=o(63),f=i(g),y=o(182),h=i(y),b=o(64),k=i(b),v=function(e){function t(){(0,s.default)(this,t);var o=(0,d.default)(this,e.call(this));return o._modifier='upload',o._bindAll('_onImage','_onDragEnter','_onDragOver','_onDragLeave','_onDrop'),o._dragCounter=0,o.state={dragAreaHovered:!1},o}return(0,c.default)(t,e),t.prototype._onDragEnter=function(t){t.preventDefault(),this._dragCounter++,this.setState({dragAreaHovered:!0})},t.prototype._onDragOver=function(t){t.preventDefault()},t.prototype._onDragLeave=function(t){t.preventDefault(),this._dragCounter--,0===this._dragCounter&&this.setState({dragAreaHovered:!1})},t.prototype._onDrop=function(t){var e=this;t.stopPropagation(),t.preventDefault(),t=t.nativeEvent,t.returnValue=!1,this.setState({dragAreaHovered:!1},function(){return t.dataTransfer?t.dataTransfer.files[0].type.match(/^image\//i)?void e._handleFile(t.dataTransfer.files[0]):u.default.instance.displayError(e._t('errors.title'),e._t('errors.invalidFileType.text',{fileType:t.dataTransfer.files[0].type})):void 0})},t.prototype._onClick=function(){this.refs.upload.open()},t.prototype._handleFile=function(e){var t=this,o=new window.FileReader;o.onload=function(){return function(o){var e=o.target.result,i=new window.Image;i.addEventListener('load',function(){t._onImage(i)}),i.src=e}}(e),o.readAsDataURL(e)},t.prototype._onImage=function(e){this.props.onImage&&this.props.onImage(e)},t.prototype._renderContent=function(){var e={onDragEnter:this._onDragEnter,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop};this.state.dragAreaHovered&&(e.className='is-hovered');var t='e:contentCell';return(!1!==this.context.options.enableWebcam||null!==this.context.options.photoRoll.provider)&&(t+=' m:withBorder'),m.ReactBEM.createElement('div',{bem:'e:contentWrapper'},m.ReactBEM.createElement('div',{bem:'e:contentRow'},m.ReactBEM.createElement('div',(0,a.default)({bem:t,onClick:this._onClick},e),m.ReactBEM.createElement(k.default,{ref:'upload',onNewFile:this._onImage}),m.ReactBEM.createElement(h.default,{bem:'e:button',uppercase:!0},this._t('splash.upload.button')),m.ReactBEM.createElement('div',{bem:'e:description'},this._t('splash.upload.description')))))},t}(f.default);t.default=v,v.propTypes={onImage:m.PropTypes.func.isRequired},v.contextTypes=f.default.contextTypes},function(e,t,o){e.exports={default:o(179),__esModule:!0}},function(e,t,o){o(180),e.exports=o(7).Object.assign},function(e,t,o){var i=o(16);i(i.S+i.F,'Object',{assign:o(181)})},function(e,t,o){'use strict';var i=o(28),r=o(56),a=o(33),n=o(52),s=o(77),l=Object.assign;e.exports=!l||o(26)(function(){var e={},t={},o=Symbol(),i='abcdefghijklmnopqrst';return e[o]=7,i.split('').forEach(function(e){t[e]=e}),7!=l({},e)[o]||Object.keys(l({},t)).join('')!=i})?function(e){for(var t=n(e),o=arguments.length,l=1,d=r.f,p=a.f;o>l;)for(var c=s(arguments[l++]),m=d?i(c).concat(d(c)):i(c),_=m.length,u=0,g;_>u;)p.call(c,g=m[u++])&&(t[g]=c[g]);return t}:l},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){var e='b:button';return this.props.uppercase&&(e+=' m:uppercase'),p.ReactBEM.createElement('button',{bem:e,className:this.props.className,onClick:this.props.onClick},this.props.children)},t}(p.BaseComponent);t.default=c,c.propTypes={onClick:p.PropTypes.func,children:p.PropTypes.any.isRequired,className:p.PropTypes.string},c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(5),m=i(c),_=function(e){function t(o){(0,a.default)(this,t);var i=(0,s.default)(this,e.call(this));return i._input=o,i._onFileChange=i._onFileChange.bind(i),i._input.addEventListener('change',i._onFileChange),i}return(0,d.default)(t,e),t.prototype.open=function(){this._input.value=null,this._input.click()},t.prototype._handleFile=function(e){var t=this,o=new window.FileReader;o.onload=function(){return function(o){var e=o.target.result,i=new window.Image;i.addEventListener('load',function(){t.emit('file',i)}),i.addEventListener('error',function(){return m.default.instance.displayError(t._t('errors.title'),t._t('errors.imageLoadingError.text'))}),i.src=e}}(e),o.readAsDataURL(e)},t.prototype._onFileChange=function(){var e=this._input.files;e.length&&this._handleFile(e[0])},t.prototype.dispose=function(){this._input.removeEventListener('change',this._onFileChange)},t}(p.EventEmitter);t.default=_},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(63),m=i(c),_=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._needsStyleFixes=!0,n._modifier='webcam',n}return(0,d.default)(t,e),t.prototype.fixStyles=function(){if(p.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,o=e.overlay,i=t.offsetHeight;o.style.height=i+'px'}},t.prototype._renderContent=function(){var e={backgroundImage:'url('+this._getAssetPath('splash/webcam.png',!0,!0)+')'};return p.ReactBEM.createElement('div',{bem:'e:contentWrapper'},p.ReactBEM.createElement('div',{bem:'e:contentRow'},p.ReactBEM.createElement('div',{bem:'e:contentCell',onClick:this._onClick,style:e,ref:'cell'},p.ReactBEM.createElement('div',{bem:'e:overlay',ref:'overlay'}),p.ReactBEM.createElement('div',{bem:'e:headline'},this._t('splash.webcam.headline')),p.ReactBEM.createElement('div',{bem:'e:description'},this._t('splash.webcam.description')))))},t}(m.default);t.default=_,_.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(63),m=i(c),_=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._needsStyleFixes=!0,n._modifier='photoRoll',n}return(0,d.default)(t,e),t.prototype.fixStyles=function(){if(p.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,o=e.overlay,i=t.offsetHeight;o.style.height=i+'px'}},t.prototype._renderContent=function(){var e={backgroundImage:'url('+this._getAssetPath('splash/photo-roll.png',!0,!0)+')'};return p.ReactBEM.createElement('div',{bem:'e:contentWrapper'},p.ReactBEM.createElement('div',{bem:'e:contentRow'},p.ReactBEM.createElement('div',{bem:'e:contentCell',onClick:this._onClick,style:e,ref:'cell'},p.ReactBEM.createElement('div',{bem:'e:overlay',ref:'overlay'}),p.ReactBEM.createElement('div',{bem:'e:headline'},this._t('splash.photoRoll.headline')),p.ReactBEM.createElement('div',{bem:'e:description'},this._t('splash.photoRoll.description')))))},t}(m.default);t.default=_,_.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(23),m=i(c),_=o(187),u=i(_),g=o(191),f=i(g),y=o(92),h=i(y),b=o(201),k=i(b),v=o(5),E=i(v),S=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n.state={section:'overview',sectionsHistory:[]},n._bindAll('_onLibraryClicked','_onSearchSuggestionClicked','_onPhotoClicked','_onFileUpload','_onWebcamClick','_onBackClicked','_onSearch'),n}return(0,d.default)(t,e),t.prototype.hasPreviousSection=function(){return!!this.state.sectionsHistory.length},t.prototype.switchToSection=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;if('back'===e){if(!this.hasPreviousSection())return t?this.props.app.switchToScreen('back'):this.switchToSection('overview');e=this.state.sectionsHistory.pop()}else this.state.section!==e&&o&&this.state.sectionsHistory.push(this.state.section);this.setState({section:e})},t.prototype._onLibraryClicked=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.state.library=e,this.switchToSection('library',!0,!t)},t.prototype._onSearchSuggestionClicked=function(e){this.state.searchQuery=e.query,this.switchToSection('search')},t.prototype._onPhotoClicked=function(e){var t=this,o=E.default.instance.displayLoading(this._t('loading.loading')),i=new window.Image;i.addEventListener('load',function(){o.close(),t.props.app.setImage(i,!0)}),i.addEventListener('error',function(){o.close(),E.default.instance.displayError(t._t('errors.imageLoadFail.title'),t._t('errors.imageLoadFail.text',{path:i.src}))}),i.crossOrigin='Anonymous',i.src=e.urls.raw},t.prototype._onBackClicked=function(){this.switchToSection('back')},t.prototype._onSearch=function(e){return e.trim().length?void(this.state.searchQuery=e,this.switchToSection('search')):(this.state.searchQuery=null,this.switchToSection('back',!1))},t.prototype._onWebcamClick=function(){this.props.app.switchToScreen('webcam')},t.prototype._onFileUpload=function(e){this.props.app.setImage(e)},t.prototype._isBackButtonVisible=function(){return 0!==this.state.sectionsHistory.length||this.props.app.hasPreviousScreen()},t.prototype._renderContent=function(){switch(this.state.section){case'search':return p.ReactBEM.createElement(k.default,{query:this.state.searchQuery,onPhotoClicked:this._onPhotoClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});case'library':return p.ReactBEM.createElement(h.default,{library:this.state.library,onPhotoClicked:this._onPhotoClicked});case'overview':return p.ReactBEM.createElement(f.default,{onLibraryClicked:this._onLibraryClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});}},t.prototype._renderScreen=function(){var e=this._renderContent();return p.ReactBEM.createElement('div',{bem:'$b:photoRollScreen'},p.ReactBEM.createElement(u.default,{onBackClicked:this._onBackClicked,onSearch:this._onSearch,searchQuery:this.state.searchQuery,onFileUpload:this._onFileUpload,onWebcamClick:this._onWebcamClick,backButton:this._isBackButtonVisible(),backButtonLabel:this._t('generic.back'),ref:'topBarControls'}),e)},t}(m.default);t.default=S,S.childContextTypes={ui:p.PropTypes.object.isRequired,editor:p.PropTypes.object.isRequired,mediator:p.PropTypes.object.isRequired,options:p.PropTypes.object.isRequired,editorScreen:p.PropTypes.object.isRequired},S.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(36),m=i(c),_=o(188),u=i(_),g=o(64),f=i(g),y=o(189),h=i(y),b=o(190),k=i(b),v=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onUploadButtonClicked','_onWebcamButtonClicked','_onBackClicked','_onSearchValueChange','_onNewFile'),n._onSearchValueChange=p.Utils.debounce(n._onSearchValueChange,250),n}return(0,d.default)(t,e),t.prototype._onBackClicked=function(){this.props.onBackClicked&&this.props.onBackClicked()},t.prototype._onSearchValueChange=function(e){this.props.onSearch&&this.props.onSearch(e)},t.prototype._onUploadButtonClicked=function(){this.refs.upload.open()},t.prototype._onWebcamButtonClicked=function(){this.props.onWebcamClick&&this.props.onWebcamClick()},t.prototype._onNewFile=function(e){this.props.onFileUpload&&this.props.onFileUpload(e)},t.prototype._isWebcamAvailable=function(){return!p.Utils.isMobile()&&!1!==this.context.options.enableWebcam},t.prototype._renderRightButtons=function(){var e=this.context.options,t=[];return e.enableUpload&&t.push(p.ReactBEM.createElement(u.default,{icon:this._getAssetPath('photo-roll/upload.png',!0),onClick:this._onUploadButtonClicked})),this._isWebcamAvailable()&&t.push(p.ReactBEM.createElement(u.default,{icon:this._getAssetPath('photo-roll/webcam.png',!0),onClick:this._onWebcamButtonClicked})),t},t.prototype.renderWithBEM=function(){var e;return this.props.backButton&&(e=p.ReactBEM.createElement(k.default,{label:this.props.backButtonLabel,onClick:this._onBackClicked})),p.ReactBEM.createElement('div',{bem:'$b:topBar e:row'},p.ReactBEM.createElement('div',{bem:'e:cell'},p.ReactBEM.createElement('div',{bem:'e:table'},p.ReactBEM.createElement('div',{bem:'e:cell m:left'},e),p.ReactBEM.createElement('div',{bem:'e:cell m:fullWidth'},p.ReactBEM.createElement(h.default,{searchQuery:this.props.searchQuery,onChange:this._onSearchValueChange}),p.ReactBEM.createElement(f.default,{onNewFile:this._onNewFile,ref:'upload'})),p.ReactBEM.createElement('div',{bem:'e:cell m:right'},this._renderRightButtons()))))},t}(m.default);t.default=v,v.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('bem',{specifier:'$b:topBar'},p.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this.props.onClick},p.ReactBEM.createElement('img',{bem:'e:icon',src:this.props.icon})))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onFocus','_onBlur','_onChange','_onBarClick'),n.state={active:!1,placeholder:n._t('photoRoll.search.placeholder'),value:n.props.searchQuery||''},n}return(0,d.default)(t,e),t.prototype.componentWillReceiveProps=function(e){this.state.active=e.searchQuery||this.state.value,this.setState({value:e.searchQuery||''})},t.prototype.componentDidUpdate=function(){this.refs.input.value=this.state.value},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this),this._hiddenInputDummy=document.createElement('div');var o=p.Utils.getStyleObject(this.refs.input);['font','lineHeight','textAlign','textIndent','textTransform','textDecoration','textRendering','textShadow','textOverflow','wordSpacing','letterSpacing','whiteSpace'].forEach(function(e){t._hiddenInputDummy.style[e]=o[e]}),this._hiddenInputDummy.style.position='absolute',this._hiddenInputDummy.style.top='-9999px',this._hiddenInputDummy.style.left='-9999px',this.refs.root.appendChild(this._hiddenInputDummy),this._updateInputWidth()},t.prototype._updateInputWidth=function(){var e=this;this._hiddenInputDummy.innerHTML=this.state.value||this.state.placeholder,setTimeout(function(){e.setState({inputWidth:e._hiddenInputDummy.offsetWidth+5})},0)},t.prototype._onBarClick=function(){this.refs.input.focus()},t.prototype._onFocus=function(){this.setState({active:!0})},t.prototype._onBlur=function(){''!==this.state.value||this.props.searchQuery||this.setState({active:!1})},t.prototype._onChange=function(t){this.state.value=t.target.value,this.forceUpdate(),this.props.onChange&&this.props.onChange(this.state.value)},t.prototype.renderWithBEM=function(){var e='$e:searchBar',t='photo-roll/search-light.png';this.state.active&&(e+=' m:active',t='photo-roll/search-dark.png'),t=this._getAssetPath(t,!0);var o={width:this.state.inputWidth+'px'};return p.ReactBEM.createElement('bem',{specifier:'$b:photoRollScreen'},p.ReactBEM.createElement('div',{bem:e,ref:'root',onClick:this._onBarClick},p.ReactBEM.createElement('div',{bem:'e:content'},p.ReactBEM.createElement('div',{bem:'$e:icon'},p.ReactBEM.createElement('img',{src:t,bem:'e:image'})),p.ReactBEM.createElement('div',{bem:'e:inputContainer'},p.ReactBEM.createElement('input',{bem:'e:input',ref:'input',placeholder:this.state.placeholder,onBlur:this._onBlur,onFocus:this._onFocus,onChange:this._onChange,defaultValue:this.state.value,style:o})))))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('bem',{specifier:'$b:topBar'},p.ReactBEM.createElement('div',{bem:'$e:backButton',onClick:this.props.onClick},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('top-bar/back.png',!0)}),p.ReactBEM.createElement('div',{bem:'e:label'},this.props.label)))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(192),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(5),u=i(_),g=o(199),f=i(g),y=o(91),h=i(y),b=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,d.default)(this,e.call.apply(e,[this].concat(i)));a._needsStyleFixes=!0,a.state={loading:!0,libraries:[],searchSuggestions:[]},a._bindAll('_onLibraryClick','_onSearchSuggestionClick');var n=a.context.options.photoRoll.provider;return a._provider=new n,a}return(0,c.default)(t,e),t.prototype.fixStyles=function(){if(m.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,o=e.container;if(!(t&&o))return;var i=t.offsetHeight;o.style.height=i+'px'}},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=u.default.instance.displayLoading(this._t('loading.loading'));this._load().then(function(e){var i=(0,a.default)(e,2),r=i[0],n=i[1];o.close(),1===r.length?t._onLibraryClick(r[0],!0):t.setState({loading:!1,libraries:r,searchSuggestions:n})})},t.prototype._onLibraryClick=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.props.onLibraryClicked&&this.props.onLibraryClicked(e,t)},t.prototype._onSearchSuggestionClick=function(e){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(e)},t.prototype._load=function(){var e=[this._provider.getLibraries(),this._provider.getSearchSuggestions()];return m.Promise.all(e)},t.prototype._renderLibraries=function(){var e=this,t=this.state.libraries.map(function(t){return m.ReactBEM.createElement(f.default,{onClick:e._onLibraryClick,library:t})});return m.ReactBEM.createElement('li',{bem:'e:item'},m.ReactBEM.createElement('bem',{specifier:'b:photoRoll'},m.ReactBEM.createElement('div',{bem:'e:headline'},'Browse libraries'),m.ReactBEM.createElement('ul',{bem:'$e:libraryList'},t)))},t.prototype._renderSearchSuggestions=function(){var e=this;if(!this.state.searchSuggestions.length)return null;var t=this.state.searchSuggestions.map(function(t){return m.ReactBEM.createElement(h.default,{onClick:e._onSearchSuggestionClick,searchSuggestion:t})});return m.ReactBEM.createElement('li',{bem:'e:item'},m.ReactBEM.createElement('bem',{specifier:'b:photoRoll'},m.ReactBEM.createElement('div',{bem:'e:headline'},'Search suggestions'),m.ReactBEM.createElement('ul',{bem:'$e:libraryList'},t)))},t.prototype._renderContent=function(){return m.ReactBEM.createElement('div',{bem:'$b:photoRoll e:row m:fullHeight'},m.ReactBEM.createElement('div',{bem:'e:cell',ref:'cell'},m.ReactBEM.createElement('div',{bem:'e:container',ref:'container'},m.ReactBEM.createElement('div',{bem:'e:innerContainer'},m.ReactBEM.createElement('ul',{bem:'$e:groupList'},this._renderLibraries(),this._renderSearchSuggestions())))))},t.prototype.renderWithBEM=function(){return this.state.loading?m.ReactBEM.createElement('div',null):this._renderContent()},t}(m.BaseComponent);t.default=b,b.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=o(193),a=i(r),n=o(196),s=i(n);t.default=function(){function e(e,t){var o=[],i=!0,r=!1,a;try{for(var n=(0,s.default)(e),l;!(i=(l=n.next()).done)&&(o.push(l.value),!(t&&o.length===t));i=!0);}catch(e){r=!0,a=e}finally{try{!i&&n['return']&&n['return']()}finally{if(r)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,o);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}()},function(e,t,o){e.exports={default:o(194),__esModule:!0}},function(e,t,o){o(53),o(31),e.exports=o(195)},function(e,t,o){var i=o(87),r=o(8)('iterator'),a=o(22);e.exports=o(7).isIterable=function(e){var t=Object(e);return t[r]!==void 0||'@@iterator'in t||a.hasOwnProperty(i(t))}},function(e,t,o){e.exports={default:o(197),__esModule:!0}},function(e,t,o){o(53),o(31),e.exports=o(198)},function(e,t,o){var i=o(17),r=o(86);e.exports=o(7).getIterator=function(e){var t=r(e);if('function'!=typeof t)throw TypeError(e+' is not iterable!');return i(t.call(e))}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onClick'),n}return(0,d.default)(t,e),t.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.library)},t.prototype.renderWithBEM=function(){var e=this.props.library,t={backgroundImage:'url('+e.coverImage+')'};return p.ReactBEM.createElement('bem',{specifier:'b:photoRoll e:libraryList'},p.ReactBEM.createElement('li',{bem:'e:item',style:t,onClick:this._onClick},p.ReactBEM.createElement('div',{bem:'e:overlay'}),p.ReactBEM.createElement('div',{bem:'e:name'},e.name)))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){var e=this.props.photo;return p.ReactBEM.createElement('bem',{specifier:'b:photoRoll e:photoList'},p.ReactBEM.createElement('li',{bem:'$e:item',onClick:this.props.onClick},p.ReactBEM.createElement('div',{bem:'e:overlay'}),p.ReactBEM.createElement('div',{bem:'e:title'},e.title),p.ReactBEM.createElement('img',{bem:'e:image',src:e.urls.thumb})))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(92),m=i(c),_=o(202),u=i(_),g=o(5),f=i(g),y=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.componentWillReceiveProps=function(e){e.query!==this.props.query&&this._loadPhotos(e.query)},t.prototype._getHeadline=function(){return this._t('photoRoll.search.results.headline',{query:this.props.query})},t.prototype._loadPhotos=function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.props.query;this._totalPhotosHeight=0;var o=f.default.instance.displayProgress(this._t('loading.loading')),i=this.context.options.photoRoll.provider,r=new i;r.searchPhotos(t).then(function(t){return e._preloadPhotos(t,o)}).then(function(t){e.setState({photos:t,loading:!1}),o.close()})},t.prototype._renderNotFound=function(){return p.ReactBEM.createElement(u.default,{query:this.props.query,onSearchSuggestionClicked:this.props.onSearchSuggestionClicked})},t.prototype.renderWithBEM=function(){return this.state.loading?p.ReactBEM.createElement('div',null):0===this.state.photos.length?this._renderNotFound():this._renderPhotos()},t}(m.default);t.default=y,y.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(91),m=i(c),_=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));n._bindAll('_onSearchSuggestionClick');var l=n.context.options.photoRoll.provider;return n._provider=new l,n.state={searchSuggestions:[]},n}return(0,d.default)(t,e),t.prototype._onSearchSuggestionClick=function(e){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(e)},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this),this._provider.getSearchSuggestions().then(function(e){t.setState({searchSuggestions:e})})},t.prototype._renderMessage=function(){return{__html:this._t('photoRoll.search.noSearchResults',{query:this.props.query})}},t.prototype._renderSearchSuggestions=function(){var e=this;if(!this.state.searchSuggestions.length)return null;var t=this.state.searchSuggestions.map(function(t){return p.ReactBEM.createElement(m.default,{onClick:e._onSearchSuggestionClick,searchSuggestion:t})});return p.ReactBEM.createElement('div',null,p.ReactBEM.createElement('div',{bem:'e:headline'},'Search suggestions'),p.ReactBEM.createElement('ul',{bem:'$e:libraryList'},t))},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:photoRoll e:row m:fullHeight'},p.ReactBEM.createElement('div',{bem:'e:cell'},p.ReactBEM.createElement('div',{bem:'e:container'},p.ReactBEM.createElement('div',{bem:'e:innerContainer'},p.ReactBEM.createElement('div',{bem:'e:noSearchResults',dangerouslySetInnerHTML:this._renderMessage()}),this._renderSearchSuggestions()))))},t}(p.BaseComponent);t.default=_,_.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(23),m=i(c),_=o(36),u=i(_),g=o(204),f=i(g),y=function(e){function t(){(0,a.default)(this,t);var o=(0,s.default)(this,e.call(this));return o._bindAll('_onCancel','_onWebcamReady','_onShutterClicked'),o.state={webcamReady:!1},o}return(0,d.default)(t,e),t.prototype._onWebcamReady=function(){this.setState({webcamReady:!0})},t.prototype._onCancel=function(){this.props.app.switchToScreen('back')},t.prototype._onShutterClicked=function(){var e=this,t=this.refs.webcam;t.makePhoto().then(function(t){e.props.app.setImage(t)}).catch(function(t){p.Log.error(t)})},t.prototype._renderScreen=function(){return p.ReactBEM.createElement('div',{bem:'$b:webcamScreen'},p.ReactBEM.createElement(u.default,{label:this._t('webcam.headline')},p.ReactBEM.createElement('bem',{specifier:'$b:topBar'},p.ReactBEM.createElement('div',{bem:'e:cancelButton',onClick:this._onCancel},this._t('generic.cancel')),p.ReactBEM.createElement('div',{bem:'e:label'},this._t('webcam.headline')))),p.ReactBEM.createElement('div',{bem:'$b:canvas e:container e:row'},p.ReactBEM.createElement('div',{bem:'e:container e:cell'},p.ReactBEM.createElement(f.default,{ref:'webcam',onReady:this._onWebcamReady,onBack:this._onCancel}))),p.ReactBEM.createElement('div',{bem:'$b:controls $e:container e:row'},p.ReactBEM.createElement('div',{bem:'e:cell'},p.ReactBEM.createElement('bem',{specifier:'b:webcamScreen'},p.ReactBEM.createElement('div',{bem:'$e:shutterButton',onClick:this._onShutterClicked,className:!!this.state.webcamReady&&'is-active'},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/webcam/shutter.png',!0)}))))))},t}(m.default);t.default=y,y.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(5),m=i(c),_=function(e){function t(){(0,a.default)(this,t);var o=(0,s.default)(this,e.call(this));return o._bindAll('_onWebcamReady'),o.state={webcamReady:!1},o}return(0,d.default)(t,e),t.prototype.shouldComponentUpdate=function(){return!1},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this);var t=this.refs.video;if(this._stream){var o=this._stream.getTracks()[0];o&&o.stop(),this._stream.stop&&this._stream.stop()}t.pause()},t.prototype.componentDidMount=function(){this._resizeVideo(),this._initVideoStream()},t.prototype._onWebcamReady=function(){this.props.onReady&&this.props.onReady(),this.setState({webcamReady:!0})},t.prototype.makePhoto=function(){if(!this.state.webcamReady)return p.Promise.reject(new Error('UserMedia stream not ready'));var e=this.refs.video;return new p.Promise(function(t){var o=document.createElement('canvas');o.width=e.videoWidth,o.height=e.videoHeight;var i=o.getContext('2d');i.drawImage(e,0,0);var r=new window.Image;r.addEventListener('load',function(){t(r)}),r.src=o.toDataURL('image/png')})},t.prototype._resizeVideo=function(){var e=this.refs,t=e.video,o=e.container,i=p.Utils.getInnerDimensionsForElement(o);t.width=i.x,t.height=i.y},t.prototype._initVideoStream=function(){var e=this,t=this.refs.video,o=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!o){var i=m.default.instance.displayError(this._t('errors.webcamNotSupported.title'),this._t('errors.webcamNotSupported.text'));return void i.on('close',function(){return e.props.onBack()})}o.call(navigator,{video:!0},function(o){e._stream=o,t.onloadedmetadata=e._onWebcamReady,t.src=window.URL.createObjectURL(o)},function(t){p.Log.error(t);var o=m.default.instance.displayError(e._t('errors.webcamUnavailable.title'),e._t('errors.webcamUnavailable.text',{error:t.name}),!0);o.on('close',function(){return e.props.onBack()})})},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:webcam',ref:'container'},p.ReactBEM.createElement('video',{bem:'e:video',ref:'video',autoPlay:!0}))},t}(p.BaseComponent);t.default=_,_.propTypes={onReady:p.PropTypes.func},_.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(93),m=i(c),_=o(23),u=i(_),g=o(208),f=i(g),y=o(5),h=i(y),b=o(209),k=i(b),v=o(94),E=i(v),S=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._overviewControls=m.default,n._bindAll('switchToControls','_startEditor','_onWindowResize','_onWindowResizeDone','_onImageResize','_onNewImage','_onRenderError'),n._previousControlsStack=[],n.state={zoom:null,controls:k.default,dragEnabled:!0,sharedState:new p.SharedState},n._editor=new E.default(n.context.ui,n.context.options,n.context.mediator),n._editor.on('new-image',n._onNewImage),n._editor.on('ready',n._startEditor),n._editor.on('resize',n._onImageResize),n._editor.on('render-error',n._onRenderError),n._forceControls=n.context.options.editor.forceControls,n._forceControlIndex=0,n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.options.editor.image;this.setImage(t),this._editor.render(),this._switchToNextForceControl();var o=this.context.options;o.responsive&&window.addEventListener('resize',this._onWindowResize)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._editor.dispose();var t=this.context.options;t.responsive&&window.removeEventListener('resize',this._onWindowResize)},t.prototype._startEditor=function(){this._editor.start()},t.prototype._switchToNextForceControl=function(){if(this._forceControlIndex<this._forceControls.length){var e=this._forceControls[this._forceControlIndex],t=e.control,o=e.options,i=this._editor.controls.getAvailable(),r=i[t],a=p.SDKUtils.defaults({forcedControl:!0},o);if(!r)throw new Error('Force controls: Could not find control with identifier `'+t+'`');this.switchToControls(r,{},null,a),this._forceControlIndex++}},t.prototype._onRenderError=function(t){h.default.instance.displayError(this._t('errors.renderingError.title'),this._t('errors.renderingError.text'),!0),p.Log.error(this.constructor.name,'An error occurred while rendering: '+t.message),p.Log.printError(t)},t.prototype._onNewImage=function(){this.switchToControls(k.default)},t.prototype._onImageResize=function(){var e=this,t=h.default.instance.displayLoading(this._t('loading.resizing'));this._editor.once('resized',function(o){var i=o.dimensions,r=o.reason;t.close(),e.context.options.editor.displayResizeMessage&&h.default.instance.displayWarning(e._t('warnings.imageResized_'+r+'.title'),e._t('warnings.imageResized_'+r+'.text',{maxMegaPixels:e._editor.getMaxMegapixels(),width:i.x,height:i.y}))})},t.prototype._onWindowResize=function(){this._resizeTimeout&&(window.clearTimeout(this._resizeTimeout),this._resizeTimeout=null),this._resizeTimeout=window.setTimeout(this._onWindowResizeDone,500)},t.prototype._onWindowResizeDone=function(){this._emitEvent(p.Constants.EVENTS.WINDOW_RESIZE)},t.prototype.switchToControls=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=null;if('back'===e)r=this._previousControlsStack.pop();else if('home'===e||e===k.default){if(this._forceControlIndex<this._forceControls.length)return this._switchToNextForceControl();r=k.default,this._previousControlsStack=[]}else r=e,this._previousControlsStack.push(this.state.controls);var a=this.state.controls!==r;this.state.controls.onExit&&this.state.controls.onExit.call(this.refs.controls),this.state.sharedState.clear(),this.state.sharedState.set(t,!1);var n=p.SDKUtils.defaults(p.SDKUtils.defaults(i,this.context.options.editor.controlsOptions[r.identifier]),r.defaultOptions);return r.onEnter&&r.onEnter.call(this.refs.controls,this.state.sharedState,n),a?void this.setState({controls:r,controlsOptions:n},o):o&&o()},t.prototype.getZoom=function(){return this.state.zoom},t.prototype.export=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];return new Promise(function(t,i){e.switchToControls('home',{},function(){var r;(r=e._editor).export.apply(r,o).then(t).catch(i)})})},t.prototype.getEditor=function(){return this._editor},t.prototype.serialize=function(){var e;return(e=this._editor).serialize.apply(e,arguments)},t.prototype.deserialize=function(e){return this._editor.deserialize(e)},t.prototype._showUndoButton=function(){return this._editor.history.isAvailable()},t.prototype.getChildContext=function(){return{editor:this._editor,ui:this.context.ui,options:this.context.options,editorScreen:this,mediator:this.context.mediator}},t.prototype.setImage=function(e,t){this._forceControlIndex=0,this._editor.setImage(e,t)},t.prototype._renderScreen=function(){var e=this.state.controls.controlsComponent,t=this.state.controls.canvasControlsComponent;t||(t=k.default.canvasControlsComponent);var o=this.state.controls.topBarControlsComponent;o||(o=k.default.topBarControlsComponent);var i,r,a;o&&this.context.options.showTopBar&&(a=p.ReactBEM.createElement(o,{sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,ref:'topBarControls'})),e&&(i=p.ReactBEM.createElement(e,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+'-controls',ref:'controls'})),t&&(r=p.ReactBEM.createElement(t,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+'-canvasControls',ref:'canvasControls'}));var n='$b:editorScreen';return this.context.options.showHeader||(n+=' m:noHeader'),p.ReactBEM.createElement('div',{bem:n},a,p.ReactBEM.createElement(f.default,{ref:'canvas',largeControls:this.state.controls.largeCanvasControls},r),p.ReactBEM.createElement('div',{bem:'$b:controls $e:container e:row'},p.ReactBEM.createElement('div',{bem:'e:cell'},i)))},t}(u.default);t.default=S,S.childContextTypes={ui:p.PropTypes.object.isRequired,editor:p.PropTypes.object.isRequired,mediator:p.PropTypes.object.isRequired,options:p.PropTypes.object.isRequired,editorScreen:p.PropTypes.object.isRequired},S.contextTypes=u.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('bem',{specifier:'$b:controls'},p.ReactBEM.createElement('div',{bem:'e:cell m:largeButton'},p.ReactBEM.createElement('div',{bem:'$e:largeButton',onClick:this.props.onClick},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/back.png',!0)}))))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('bem',{specifier:'$b:controls'},p.ReactBEM.createElement('div',{bem:'e:cell m:largeButton'},p.ReactBEM.createElement('div',{bem:'$e:largeButton',onClick:this.props.onClick},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/tick.png',!0)}))))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=function(e){function t(){var o;(0,s.default)(this,t);for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];var l=(0,d.default)(this,e.call.apply(e,[this].concat(r)));return l._bindAll('_onDragStart','_onDragMove','_onDragEnd','_onWindowResize','_onFeaturesUpdated','_onZoomChange'),l._events=(o={},(0,a.default)(o,m.Constants.EVENTS.WINDOW_RESIZE,l._onWindowResize),(0,a.default)(o,m.Constants.EVENTS.FEATURES_UPDATED,l._onFeaturesUpdated),o),l._initialRenderDone=!1,l.state={canvasPosition:new m.Vector2,canvasOffset:new m.Vector2},l}return(0,c.default)(t,e),t.prototype._onWindowResize=function(){var e=this.context.editor,t=e.getSDK();t.resizeTo(this._getContainerDimensions()),e.zoom.set('auto')},t.prototype._onFeaturesUpdated=function(e){-1!==e.indexOf('drag')&&this.forceUpdate()},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.editor,o=t.getRenderer(),i=this.refs,r=i.canvasCell,a=i.canvas,n=r.offsetWidth,s=r.offsetHeight;o.setCanvas(a),o.resizeTo(new m.Vector2(n,s),!0),t.zoom.on('set',this._onZoomChange)},t.prototype.componentWillUnmount=function(){var e=this.context.editor;e.zoom.off('set',this._onZoomChange)},t.prototype._onZoomChange=function(){this.forceUpdate()},t.prototype._onDragStart=function(t){var e=this.context.editor;e.features.isEnabled('drag')&&(t.preventDefault(),this._dragStartPosition=m.Utils.getEventPosition(t.nativeEvent),this._dragInitialOffset=e.getOffset().clone(),document.addEventListener('mousemove',this._onDragMove),document.addEventListener('touchmove',this._onDragMove),document.addEventListener('mouseup',this._onDragEnd),document.addEventListener('touchend',this._onDragEnd))},t.prototype._onDragMove=function(t){var e=m.Utils.getEventPosition(t),o=e.clone().subtract(this._dragStartPosition),i=this._dragInitialOffset.clone().add(o),r=this.context.editor,a=r.getOffset().clone();r.setOffset(i),r.getOffset().equals(a)||r.render()},t.prototype._onDragEnd=function(){document.removeEventListener('mousemove',this._onDragMove),document.removeEventListener('touchmove',this._onDragMove),document.removeEventListener('mouseup',this._onDragEnd),document.removeEventListener('touchend',this._onDragEnd)},t.prototype._getContainerDimensions=function(){var e=this.refs.canvasCell;return new m.Vector2(e.offsetWidth,e.offsetHeight)},t.prototype._getDraggableStyle=function(){return{top:this.state.canvasPosition.y+this.state.canvasOffset.y,left:this.state.canvasPosition.x+this.state.canvasOffset.x}},t.prototype.renderWithBEM=function(){var e=null,t=null;this.props.largeControls?t=this.props.children:e=this.props.children;var o=this.context.editor,i=o.isReady()&&o.zoom.get()>o.zoom.getDefault(),r=o.features.isEnabled('drag')&&i;return m.ReactBEM.createElement('div',{bem:'$b:canvas e:container e:row'},m.ReactBEM.createElement('div',{bem:'e:container e:cell',ref:'canvasCell'},m.ReactBEM.createElement('div',{bem:'e:innerContainer',className:r?'is-draggable':null,onTouchStart:this._onDragStart,onMouseDown:this._onDragStart,style:this._getDraggableStyle()},m.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),e),t))},t}(m.BaseComponent);t.default=_,_.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(10),c=i(p),m=o(210),_=i(m),u=o(93),g=i(u),f=o(215),y=i(f),h=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t}(c.default);h.topBarControlsComponent=_.default,h.controlsComponent=g.default,h.canvasControlsComponent=y.default,t.default=h},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(36),m=i(c),_=o(211),u=i(_),g=o(212),f=i(g),y=o(213),h=i(y),b=o(214),k=i(b),v=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderContent=function(){var e=null;this.context.options.enableUpload&&(e=p.ReactBEM.createElement(u.default,{app:this.props.app}));var t=null;return this.context.options.editor.enableZoom&&(t=p.ReactBEM.createElement(k.default,null)),p.ReactBEM.createElement('bem',{specifier:'$b:topBar'},p.ReactBEM.createElement('div',{bem:'e:left'},e),p.ReactBEM.createElement('div',{bem:'e:right'},p.ReactBEM.createElement(h.default,null),p.ReactBEM.createElement(f.default,null)),t)},t}(m.default);t.default=v,v.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(65),m=i(c),_=o(64),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onNewFile','_onButtonClick'),n}return(0,d.default)(t,e),t.prototype._onNewFile=function(e){var t=this.context.editor;t.reset(),t.setImage(e),t.zoom.set('auto')},t.prototype._onButtonClick=function(){var e=this.context.options,t=!1===e.enableWebcam||p.Utils.isMobile(),o=!!e.photoRoll.provider;t&&!o?this.refs.upload.open():o?this.props.app.switchToScreen('photoRoll'):this.props.app.switchToScreen('splash')},t.prototype.renderWithBEM=function(){var e=this.context.options,t=null;return t=e.photoRoll.provider?this._t('editor.backgroundImage'):this._t('editor.new'),p.ReactBEM.createElement('div',null,p.ReactBEM.createElement(u.default,{onNewFile:this._onNewFile,ref:'upload'}),p.ReactBEM.createElement(m.default,{label:t,icon:'editor/new.png',onClick:this._onButtonClick}))},t}(p.BaseComponent);t.default=g,g.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(5),m=i(c),_=o(65),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onButtonClick'),n}return(0,d.default)(t,e),t.prototype._onButtonClick=function(){var t=this,e=this.context,o=e.options,i=e.editor,r=e.editorScreen,a=o.editor.export;r.switchToControls('home',null,function(){var o=m.default.instance.displayLoading(t._t('loading.exporting'));setTimeout(function(){i.export(a.download).then(function(){o.close()}).catch(function(i){m.default.instance.displayError(t._t('errors.title'),i.message),o.close()})},100)})},t.prototype.renderWithBEM=function(){var e=this.context.options;return e.editor.export.showButton?p.ReactBEM.createElement(u.default,{style:'blue',label:this._t('editor.export'),icon:'editor/export.png',onClick:this._onButtonClick}):null},t}(p.BaseComponent);t.default=g,g.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(65),u=i(_),g=function(e){function t(){var o;(0,s.default)(this,t);for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];var l=(0,d.default)(this,e.call.apply(e,[this].concat(r)));return l._bindAll('_onButtonClick','_onHistoryUpdated','_onFeaturesUpdated'),l._events=(o={},(0,a.default)(o,m.Constants.EVENTS.HISTORY_UPDATED,l._onHistoryUpdated),(0,a.default)(o,m.Constants.EVENTS.FEATURES_UPDATED,l._onFeaturesUpdated),o),l}return(0,c.default)(t,e),t.prototype._onFeaturesUpdated=function(){this.forceUpdate()},t.prototype._onHistoryUpdated=function(){this.forceUpdate()},t.prototype._onButtonClick=function(){var e=this.context.editor;e.history.undo()},t.prototype.renderWithBEM=function(){var e=this.context.editor;return e.history.isAvailable()?m.ReactBEM.createElement(u.default,{label:this._t('editor.undo'),icon:'editor/undo.png',onClick:this._onButtonClick}):null},t}(m.BaseComponent);t.default=g,g.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),p=i(l),c=o(3),m=i(c),_=o(1),u=function(e){function t(){var o;(0,s.default)(this,t);for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];var l=(0,p.default)(this,e.call.apply(e,[this].concat(r)));return l._bindAll('_onZoomOutClick','_onZoomInClick','_onZoomDone','_onFeaturesUpdated'),l._events=(o={},(0,a.default)(o,_.Constants.EVENTS.ZOOM_DONE,l._onZoomDone),(0,a.default)(o,_.Constants.EVENTS.FEATURES_UPDATED,l._onFeaturesUpdated),o),l}return(0,m.default)(t,e),t.prototype._onFeaturesUpdated=function(){this.forceUpdate()},t.prototype._onZoomDone=function(){this.forceUpdate()},t.prototype._onZoomOutClick=function(){var e=this.context.editor;e.features.isEnabled('zoom')&&e.zoom.out()},t.prototype._onZoomInClick=function(){var e=this.context.editor;e.features.isEnabled('zoom')&&e.zoom.in()},t.prototype.renderWithBEM=function(){var e=this.context.editor,t=e.zoom.get(),o=e.features.isEnabled('zoom');return _.ReactBEM.createElement('bem',{specifier:'b:editorScreen'},_.ReactBEM.createElement('div',{bem:'$e:zoom'},_.ReactBEM.createElement('div',{bem:'$e:button m:zoomOut',onClick:this._onZoomOutClick,className:o?null:'is-disabled'},_.ReactBEM.createElement('img',{bem:'e:image',src:this._getAssetPath('controls/minus.png',!0)})),_.ReactBEM.createElement('div',{bem:'e:label'},this._t('editor.zoom'),_.ReactBEM.createElement('br',null),d(100*t),'%'),_.ReactBEM.createElement('div',{bem:'$e:button m:zoomIn',onClick:this._onZoomInClick,className:o?null:'is-disabled'},_.ReactBEM.createElement('img',{bem:'e:image',src:this._getAssetPath('controls/plus.png',!0)}))))},t}(_.BaseComponent);t.default=u,u.contextTypes=_.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(24),m=i(c),_=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onClick'),n}return(0,d.default)(t,e),t.prototype._onClick=function(t){this._performHitTest(p.Utils.getEventPosition(t))},t.prototype._getContainerStyle=function(){if(!this.context.editor.isReady())return{left:0,top:0,width:1,height:1};var e=this.context.editor.getSDK().getSprite().getBounds(),t=e.x,o=e.y,i=e.width,r=e.height;return{left:t,top:o,width:i,height:r}},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:canvasControls e:container m:full',ref:'container'},p.ReactBEM.createElement('div',{bem:'$b:canvasControls e:innerContainer',ref:'innerContainer',style:this._getContainerStyle(),onClick:this._onClick,onTouchStart:this._onClick}))},t}(m.default);t.default=_,_.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(1),s=o(217),l=i(s),d=function(){function e(t,o,i){(0,a.default)(this,e),this._sdk=t,this._options=o,this._download=i}return e.prototype.export=function(){var e=this,t=this._getRenderType();return this._sdk.export(t,this._options.format,this._options.quality).then(function(o){return e._download&&e._downloadData(t,o),o})},e.prototype._downloadData=function(e,t){e===n.RenderType.DATAURL?l.default.downloadDataURL(t,this._options.fileBasename):e===n.RenderType.MSBLOB?l.default.downloadMSBlob(t,this._options.fileBasename):void 0},e.prototype._getRenderType=function(){var e=this._options;return e.type===n.RenderType.IMAGE&&this._download?n.Utils.supportsMSBlob()?n.RenderType.MSBLOB:n.RenderType.DATAURL:e.type},e}();t.default=d},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(){(0,r.default)(this,e)}return e.downloadDataURL=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'photoeditorsdk-export',o=this.createBlobURLFromDataURL(e),i=this.getExtensionFromDataURL(e),r=document.createElement('a');r.download=t+'.'+i,r.href=o,document.body.appendChild(r),r.click(),document.body.removeChild(r)},e.downloadMSBlob=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'photoeditorsdk-export';navigator.msSaveBlob(e,t+'.png')},e.getExtensionFromDataURL=function(e){var t=e.split(',')[0].split(':')[1].split(';')[0];return t.split('/').pop()},e.createBlobURLFromDataURL=function(e){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return e;for(var t=a.Base64.decode(e.split(',')[1]),o=e.split(',')[0].split(':')[1].split(';')[0],r=new ArrayBuffer(t.length),n=new Uint8Array(r),s=0;s<t.length;s++)n[s]=t[s];var i=new window.Blob([r],{type:o});return window.URL.createObjectURL(i)},e}();t.default=n},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t,o,i){(0,r.default)(this,e),this._image=t,this._maxPixels=o,this._maxDimensions=i}return e.prototype.needsResize=function(){var e=new a.Vector2(this._image.width,this._image.height),t=e.x*e.y,o=t>this._maxPixels,i=null!==this._maxDimensions&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return o||i},e.prototype.resize=function(){var e=this,t=null,o=null,i=this._maxDimensions;return new a.Promise(function(r){window.setTimeout(function(){var n=new a.Vector2(e._image.width,e._image.height),s=n.clone();if(s.x*s.y>e._maxPixels&&(s.copy(e._getDimensionsByMaxPixels()),t='maxMegaPixels'),null!==i&&(s.x>i||s.y>i)){var l=p(i/s.x,i/s.y);s.multiply(l),t='maxDimensions'}s.floor(),o=e._createResizedImageCanvas(s),r({canvas:o,dimensions:s,reason:t})},1e3)})},e.prototype._createResizedImageCanvas=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,o=this._image,i=document.createElement('canvas');i.width=e.x,i.height=e.y;var r=e.clone().subtract(t).divide(2),a=i.getContext('2d');return a.drawImage(o,0,0,o.width,o.height,r.x,r.y,t.x,t.y),i},e.prototype._getDimensionsByMaxPixels=function(){var e=Math.sqrt,t=this._image,o=this._maxPixels,i=t.width/t.height,r=t.height/t.width;return new a.Vector2(e(o*i),e(o*r)).floor()},e}();t.default=n},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t,o,i){(0,r.default)(this,e),this._editor=t,this._sdk=o,this._mediator=i,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}return e.prototype.exists=function(e){return!!this._map[e]},e.prototype.add=function(e){var t=this,o=e.constructor.identifier;e.on('updated',function(){t._mediator.emit(a.Constants.EVENTS.OPERATION_UPDATED,e)});var i=this._preferredOrder.indexOf(o);if(-1===i)throw new Error('EditorOperations#add: `'+o+'` does not appear in `operationsOrder`');this._stack.set(i,e),this._map[o]=e,this._mediator.emit(a.Constants.EVENTS.OPERATION_CREATED,e)},e.prototype.remove=function(e){var t=e.constructor.identifier,o=this._stack.getStack();delete this._map[t];var r=o.map(function(e){return e.constructor.identifier}).indexOf(e.constructor.identifier);if(-1!==r){this._stack.removeAt(r);for(var n=r+1,i;n<o.length;n++)i=o[n],i&&i.setDirty(!0);this._mediator.emit(a.Constants.EVENTS.OPERATION_REMOVED,e)}},e.prototype.get=function(e){return this._map[e]},e.prototype.getOrCreate=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(this._map[e]){var o=this._map[e];return o}var i=this._available[e],r=new i(this._sdk,t);return this.add(r),r},e.prototype.getStack=function(){return this._stack},e.prototype.reset=function(){this._map={}},e.prototype._fixStack=function(){var e=this,t=this._stack.getStack().slice();this._stack.clear(),t.forEach(function(t){e.add(t)})},e}();t.default=n},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(95),n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(a),s=o(1),l=function(){function e(t,o,i){(0,r.default)(this,e),this._editor=t,this._sdk=o,this._mediator=i,this._options=this._editor.getOptions(),this._available=s.SDKUtils.extend({},n,this._options.extensions.controls)}return e.prototype.isEnabled=function(e){var t=this.get(e);return t?t.isAvailable&&t.isAvailable(this._editor):(s.Log.info('EditorControls#isEnabled: Unknown control: '+e),!1)},e.prototype.get=function(e){return this._available[e]},e.prototype.getAvailable=function(){return this._available},e}();t.default=l},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(10),c=i(p),m=o(222),_=i(m),u=['brightness','clarity','contrast','exposure','highlights','saturation','shadows','gamma'],g=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onEnter=function(){var e=this.context.editor,t=e.operations.exists('adjustments'),o=e.operations.getOrCreate('adjustments'),i=o.serializeOptions();this.setSharedState({operation:o,operationExistedBefore:t,initialOptions:i})},t.isAvailable=function(e){return e.isToolAllowed('adjustment')&&0<u.filter(function(t){return e.isToolEnabled(t)}).length},t.getPreloadAssets=function(e){return u.filter(function(t){return e.isToolEnabled(t)}).map(function(e){return'controls/adjustments/'+e+'.png'})},t}(c.default);g.controlsComponent=_.default,g.identifier='adjustments',g.iconPath='controls/overview/adjustments.png',g.languageKey='controls.overview.adjustments',g.defaultOptions={},t.default=g},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(9),m=i(c),_=o(6),u=i(_),g=o(15),f=i(g),y=o(223),h=i(y),b=p.SDK.Operations.AdjustmentsOperation,k=['brightness','saturation','contrast','gamma','clarity','exposure','shadows','highlights'],v=function(t){function e(){(0,a.default)(this,e);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,t.call.apply(t,[this].concat(i)));n._bindAll('_onSliderValueChange');var l=n.context.editor;return n._operation=l.operations.getOrCreate('adjustments'),n.state={selectedControls:null},n}return(0,d.default)(e,t),e.prototype._onBackClick=function(o){var e=this.context.editor,i=this.getSharedState('operationExistedBefore'),r=this.getSharedState('initialOptions');this._operation.optionsEqual(r)||e.history.add(this._operation,r,i);var a=this._operation.getDefaultOptions();this._operation.optionsEqual(a)&&e.operations.remove(this._operation),t.prototype._onBackClick.call(this,o)},e.prototype._onSliderValueChange=function(e){var t=this.state.selectedControls,o=b.prototype.availableOptions[t],i=o.minValue,r=o.midValue,a=o.maxValue;e=0>e?r+(r-i)*e/100:r+(a-r)*e/100,this._operation.setOption(t,e);var n=this.context.editor;n.render()},e.prototype._onButtonClick=function(e){this.setState({selectedControls:e})},e.prototype._buildSliderProps=function(e){var t=b.prototype.availableOptions[e],o=t.minValue,i=t.midValue,r=t.maxValue,a=this._operation?this._operation.getOption(e):i,n=100*(a<=i?(a-o)/(i-o)-1:(a-i)/(r-i));return{minValue:-100,maxValue:100,value:n,valueUnit:'%',positiveValuePrefix:'+',label:this._t('controls.adjustments.'+e),middleDot:!0,onChange:this._onSliderValueChange}},e.prototype.renderOverlayControls=function(){var e=this.state.selectedControls;if(e){var t=this._buildSliderProps(e);return p.ReactBEM.createElement(f.default,t)}},e.prototype._renderListItems=function(){var e=this;return k.filter(function(t){return e.context.editor.isToolEnabled(t)}).map(function(t){var o=e.state.selectedControls===t,i=o?'is-active':null,r;return p.ReactBEM.createElement('li',{bem:'e:item',key:t,"data-identifier":t},p.ReactBEM.createElement('bem',{specifier:'$b:controls'},p.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',onClick:e._onButtonClick.bind(e,t),className:i},p.ReactBEM.createElement('img',{bem:'e:icon',src:e._getAssetPath('controls/adjustments/'+t+'.png',!0)}),p.ReactBEM.createElement('div',{bem:'e:label'},e._t('controls.adjustments.'+t)),r)))})},e.prototype.renderControls=function(){var e=this._renderListItems();return p.ReactBEM.createElement('div',{bem:'e:cell m:list'},p.ReactBEM.createElement(u.default,null,p.ReactBEM.createElement('ul',{bem:'$e:list'},e)))},e}(m.default);t.default=v,v.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(29),a=i(r),n=o(0),s=i(n),p=o(2),c=i(p),m=o(3),_=i(m),u=o(1),g=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,c.default)(this,e.call.apply(e,[this].concat(i)));return a.state={value:a.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},a}return(0,_.default)(t,e),t.prototype.componentDidMount=function(){this._setValue(this.state.value,!1)},t.prototype.componentWillReceiveProps=function(e){e.value!==this.state.value&&this._setValue(e.value,!1)},t.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition}},t.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}},t.prototype._displayMiddleDot=function(){return!1!==this.props.middleDot},t.prototype._setValue=function(e){1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;e=d(e);var t=this.props,o=t.minValue,i=t.maxValue,r=(e-o)/(i-o),a=this.refs.bar,n=a.offsetWidth,s=r*n,p=0;this._displayMiddleDot()&&(s=l(r-0.5)*n,p=0.5>r?0.5*n-s:'50%'),this.setState({value:e,sliderPosition:n*r,foregroundWidth:s,foregroundLeft:p})},t.prototype.renderWithBEM=function(){var e={style:this._getForegroundStyle()};return u.ReactBEM.createElement('div',{bem:'$b:miniSlider'},u.ReactBEM.createElement('div',{bem:'$e:bar',ref:'bar'},u.ReactBEM.createElement('div',{bem:'$e:background'}),u.ReactBEM.createElement('div',(0,a.default)({bem:'$e:foreground'},e)),u.ReactBEM.createElement('div',{bem:'e:knob',style:this._getKnobStyle()})))},t}(u.BaseComponent);t.default=g,g.contextTypes=u.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(10),u=i(_),g=o(225),f=i(g),y=o(226),h=i(y),b=o(227),k=i(b),v=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,e.apply(this,arguments))}return(0,c.default)(t,e),t.onEnter=function(){var e=this.context.editor,t=e.operations.exists('transform'),o=e.operations.getOrCreate('transform');o.setEnabled(!1,!1);var i=e.operations.exists('orientation'),n=e.operations.getOrCreate('orientation'),s={end:new m.Vector2(1,1),rotation:0,start:new m.Vector2(0,0),textureScale:1},l=o.getInputDimensions(!1),d=o.getNewDimensions(l),p=s;if(t){p=o.serializeOptions(),delete p.enabled;var c=p,_=c.start,u=c.end,g=c.rotation,f=o.calculateScale(g),y=o.getInputDimensions(!1),h=a(g),b=r(g),k=u.clone().subtract(_).divide(2),v=_.clone().add(k).multiply(y),E=v.subtract(y.clone().multiply(0.5)),S=new m.Vector2(E.x*h-E.y*b,E.x*b+E.y*h).multiply(f),M=y.clone().multiply(0.5).add(S),C=M.clone().divide(y),B=C.clone().subtract(k.clone().multiply(f)),R=C.clone().add(k.clone().multiply(f));p.start=B,p.end=R}e.broadcastTransform(o,s);var x=n.serializeOptions(),T=[10,0,68,0];e.setSpriteScale(o.calculateScale()),e.setRotation(p.rotation),e.setPadding(T),o.set(s,t),e.zoom.set('auto',function(){e.features.disable('zoom','drag')},!1),this.setSharedState({initialTransformOptions:p,initialOrientationOptions:x,operation:o,orientationOperation:n,activePadding:T,orientationOperationExistedBefore:i,transformOperationExistedBefore:t,start:m.Vector2.fromObject(p.start),end:m.Vector2.fromObject(p.end),rotation:p.rotation,orientationRotation:n.getRotation(),flipVertically:n.getFlipVertically(),flipHorizontally:n.getFlipHorizontally(),initialDimensions:d,inputDimensions:l})},t.isAvailable=function(e){return e.isToolAllowed('transform')&&e.isToolEnabled('transform')},t.getPreloadAssets=function(e){var t=e.getOptions(),o=m.SDKUtils.defaults(t.editor.controlsOptions.transform,this.defaultOptions),i=['controls/transform/rotate-ccw.png','controls/transform/rotate-cw.png','controls/transform/flip-h.png','controls/transform/flip-v.png'],r=f.default.getRatios(o);return r.forEach(function(e){Array.isArray(e)?e.forEach(function(e){var t=e.identifier;i.push('controls/transform/'+t+'.png')}):i.push('controls/transform/'+e.identifier+'.png')}),i},t}(u.default);v.topBarControlsComponent=k.default,v.controlsComponent=f.default,v.canvasControlsComponent=h.default,v.identifier='transform',v.iconPath='controls/overview/transform.png',v.languageKey='controls.overview.transform',v.defaultOptions={},t.default=v},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var s=o(4),d=i(s),p=o(0),c=i(p),m=o(2),_=i(m),u=o(3),g=i(u),f=o(1),y=o(9),h=i(y),b=o(6),k=i(b),v=o(15),E=i(v),S=function(t){function e(){(0,c.default)(this,e);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,_.default)(this,t.call.apply(t,[this].concat(i)));return a._bindAll('_selectRatio','_onRotationChange','_reapplyRatio'),a.state={ratio:null},a._ratios=a.constructor.getRatios(a.props.options),a._events=(0,d.default)({},f.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO,a._reapplyRatio),a._selectInitialRatio(!a.getSharedState('transformOperationExistedBefore')),a}return(0,g.default)(e,t),e.getRatios=function(e){var t=e.ratios,o=e.replaceRatios,i=e.selectableRatios;t=t||[];var r;if(r=f.Constants.DEFAULTS.TRANSFORM_RATIOS,r=o?t:r.concat(t),i&&i.length){var a=function e(t){return Array.isArray(t)?t.map(e).filter(function(e){return e}):-1===i.indexOf(t.identifier)?null:t};r=r.map(a).filter(function(e){return e})}return r},e.prototype.shouldSharedComponentUpdate=function(e,t){return e.ratio!==t.ratio},e.prototype._onRotationChange=function(e){var t=this.getSharedState('operation'),o=this.context.editor;e=e*n/180,o.setRotation(e),o.setSpriteScale(t.calculateScale(e)),o.render(),this.setSharedState({rotation:e})},e.prototype._getRotatedSpriteDimensions=function(){var e=this.context.editor,t=e.getRotation(),o=e.getOutputDimensions(!1);return new f.Vector2(l(o.x*a(t))+l(o.y*r(t)),l(o.x*r(t))+l(o.y*a(t)))},e.prototype._calculateTextureScale=function(){var e=this.getSharedState('operation'),t=this.getSharedState('ratio');if(!t||!t.dimensions)return 1;var o=this.getSharedState('start'),i=this.getSharedState('end'),r=i.clone().subtract(o),a=e.getInputDimensions(!1).multiply(r);return t.dimensions.x/a.x},e.prototype._getHistoryItems=function(){var e=[],t=this._getTransformHistoryItem();t&&e.push(t);var o=this._getOrientationHistoryItem();return o&&e.push(o),e},e.prototype._getTransformHistoryItem=function(){var e=this.context.editor,t=this.getSharedState('operation'),o=this.getSharedState('initialTransformOptions'),i=this.getSharedState('transformOperationExistedBefore');if(!t.optionsEqual(o))return{operation:t,options:o,existent:i,undo:function(t,o){e.broadcastTransform(t,o)}}},e.prototype._getOrientationHistoryItem=function(){var e=this.context.editor,t=this.getSharedState('orientationOperation'),o=this.getSharedState('initialOrientationOptions'),i=this.getSharedState('orientationOperationExistedBefore');if(!t.optionsEqual(o))return{operation:t,options:o,existent:i,undo:function(t,o){t.getRotation()!==o.rotation&&e.broadcastRotate(o.rotation-t.getRotation());var i=o.rotation,r=90===i||270===i;t.getFlipVertically()===o.flipVertically?t.getFlipHorizontally()!==o.flipHorizontally&&e.broadcastFlip(r?'vertical':'horizontal'):e.broadcastFlip(r?'horizontal':'vertical')}}},e.prototype._reapplyRatio=function(){var e=this.getSharedState('ratio');this._selectRatio(e)},e.prototype._onBackClick=function(o){var e=this.context.editor,i=this.getSharedState('ratio'),n=this.getSharedState('operation'),s=this.getSharedState('orientationOperation'),l=e.getRotation(),d=this.getSharedState('start').clone(),p=this.getSharedState('end').clone();if((null===i||d.equals(0,0)&&p.equals(1,1))&&0===l)e.operations.remove(n);else{var c=this._calculateTextureScale(),m={rotation:l,start:d,end:p,textureScale:c,enabled:!0},_=n.calculateScale(l),u=n.getInputDimensions(!1),g=a(-l),y=r(-l),h=p.clone().subtract(d).divide(2),b=d.clone().add(h).multiply(u),k=b.subtract(u.clone().multiply(0.5)),v=new f.Vector2(k.x*g-k.y*y,k.x*y+k.y*g).divide(_),E=u.clone().multiply(0.5).add(v),S=E.clone().divide(u);m.start=S.clone().subtract(h.clone().divide(_)),m.end=S.clone().add(h.clone().divide(_)),e.broadcastTransform(n,m),n.set(m)}0!==s.getRotation()||s.getFlipVertically()||s.getFlipHorizontally()||e.operations.remove(s),e.setPadding(!1),e.setRotation(0),e.setSpriteScale(1);var M=this._getHistoryItems();M.length&&e.history.add(M),e.features.enable('zoom','drag'),e.zoom.set('auto'),t.prototype._onBackClick.call(this,o)},e.prototype._selectInitialRatio=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,t=this.getSharedState('operation'),o=null,i=f.SDKUtils.flatten(this._ratios),r=t._ratio;if(r){var a=i.filter(function(e){return e===r});o=a[0]}if(!o){var n=i.filter(function(e){return e.selected});o=n.pop()}return o||(o=i[0]),this._selectRatio(o,e,!1)},e.prototype._selectRatio=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,i=this.getSharedState('operation');t&&e&&this._setDefaultOptionsForRatio(e,o),i._ratio=e;var r={ratio:e},a=this.context.editor;e?a.setPadding(this.getSharedState('activePadding')):(a.setPadding(!1),a.setRotation(0),a.setSpriteScale(1),r.rotation=0,r.start=new f.Vector2(0,0),r.end=new f.Vector2(1,1)),a.render(),this.setSharedState(r,o)},e.prototype._setDefaultOptionsForRatio=function(e){var t=e.ratio,o=e.name,i=e.dimensions,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=this.context.editor,n=new f.Vector2,s=new f.Vector2;if(i&&!t&&(t=i.x/i.y),'*'===t)n=new f.Vector2(0,0),s=new f.Vector2(1,1);else{var l=a.getOutputDimensions(),d=l.x/l.y;if(d<=t){var p=1/l.y*(l.x/t);n.set(0,(1-p)/2),s.set(1,1-n.y)}else{var c=1/l.x*(t*l.y);n.set((1-c)/2,0),s.set(1-n.x,1)}}this.setSharedState({start:n,end:s},r)},e.prototype.renderOverlayControls=function(){var e=180*this.getSharedState('rotation')/n;return this.getSharedState('ratio')?f.ReactBEM.createElement(E.default,{value:e,minValue:-45,middleDot:!0,maxValue:45,valueUnit:'\xB0',label:this._t('controls.transform.rotation'),onChange:this._onRotationChange}):null},e.prototype._renderListItems=function(){var e=this,t=[],o=function(t){return f.ReactBEM.createElement('li',{bem:'e:item',key:t.identifier,"data-identifier":t.identifier},f.ReactBEM.createElement('bem',{specifier:'$b:controls'},f.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:e.getSharedState('ratio')===t?'is-active':null,onClick:e._selectRatio.bind(e,t)},f.ReactBEM.createElement('img',{bem:'e:icon',src:e._getAssetPath('controls/transform/'+t.identifier+'.png',!0)}),f.ReactBEM.createElement('div',{bem:'e:label'},e._t('controls.transform.ratios.'+t.identifier)||t.defaultName))))};this._ratios.forEach(function(e){if(Array.isArray(e)){var i=[];e.forEach(function(e){i.push(o(e))}),i.length&&t.push(i)}else{t.push(o(e))}});var i=[];t.forEach(function(e){i=i.concat(e),Array.isArray(e)&&e!==t[t.length-1]&&i.push(f.ReactBEM.createElement('li',{bem:'e:separator'}))});var r=f.ReactBEM.createElement('li',{bem:'e:item',"data-identifier":'none',key:'noTransform'},f.ReactBEM.createElement('bem',{specifier:'$b:controls'},f.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:this.getSharedState('ratio')?null:'is-active',onClick:this._selectRatio.bind(this,null)},f.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/transform/no-transform.png',!0)}),f.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.transform.none')))));return[r,f.ReactBEM.createElement('li',{bem:'e:separator'})].concat(i)},e.prototype.renderControls=function(){var e=this._renderListItems();return f.ReactBEM.createElement('div',{bem:'e:cell m:list'},f.ReactBEM.createElement(k.default,null,f.ReactBEM.createElement('ul',{bem:'$e:list'},e)))},e}(h.default);t.default=S,S.contextTypes=h.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),m=o(1),_=o(11),u=i(_),g=o(24),f=i(g),y=new m.Vector2(50,50),h=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._needsStyleFixes=!0,n._bindAll('_onCenterDragStart','_onCenterDrag'),n.state={dimensions:n.getSharedState('initialDimensions')},n}return(0,d.default)(t,e),t.prototype.fixStyles=function(){if(m.Utils.Browser.isIElte(11)){var e=this.context.editor,t=this.refs.container,o=e.getCanvasDimensions(!1),i=o.y;t.style.height=i+'px'}},t.prototype.sharedStateDidChange=function(e){e!==this.getSharedState('ratio')&&this._updateDimensions()},t.prototype._updateDimensions=function(){var e=this.getSharedState('operation'),t=this.getSharedState('ratio')||{ratio:'*'},o;if(t.dimensions)o=t.dimensions.clone();else{var i=e.getInputDimensions(!1),r=this.getSharedState('start'),a=this.getSharedState('end'),n=a.clone().subtract(r);o=n.multiply(i).floor()}this.setState({dimensions:o})},t.prototype._onCenterDragStart=function(){var e=this.getSharedState('start'),t=this.getSharedState('end');this._initialValues={start:e.clone(),end:t.clone(),size:t.clone().subtract(e)}},t.prototype._onCenterDrag=function(e){var t=this.context.editor,o=this._initialValues,i=o.start,r=o.size,a=t.getOutputDimensions(),n=e.clone().divide(a),s=new m.Vector2(0,0),l=new m.Vector2(1,1).subtract(r),d=i.clone().add(n).clamp(s,l),p=d.clone().add(r);this.setSharedState({start:d,end:p})},t.prototype._onKnobDragStart=function(e){this._currentDragOption=e,this._initialValues={start:this.getSharedState('start').clone(),end:this.getSharedState('end').clone()}},t.prototype._onKnobDrag=function(e,t){var o=this.context.editor,i=o.getOutputDimensions(),r=this.getSharedState('ratio')||{ratio:'*'},a=r.ratio,n=r.dimensions;n&&!a&&(a=n.x/n.y);var s=this._initialValues.end.clone().subtract(this._initialValues.start).multiply(i),l;'start'===e?(s.subtract(t),l=this._initialValues.end.clone().multiply(i)):'end'===e&&(s.add(t),l=new m.Vector2(1,1).subtract(this._initialValues.start).multiply(i));var d=i;if('undefined'!=typeof a&&'*'!==a&&(a>i.x/i.y?d=new m.Vector2(i.x,i.x/a):d=new m.Vector2(i.y*a,i.y)),s.x=p(c(p(y.x,d.x),s.x),l.x),'*'!==a&&(s.y=s.x/a),s.y=p(c(p(y.y,d.y),s.y),l.y),'*'!==a&&(s.x=s.y*a),'start'===e){var _=this._initialValues.end.clone().subtract(s.clone().divide(i));this.setSharedState({start:_},!1),this._updateDimensions()}else if('end'===e){var u=this._initialValues.start.clone().add(s.clone().divide(i));this.setSharedState({end:u},!1),this._updateDimensions()}},t.prototype._calculateDimensions=function(){var e=this.context.editor,t=this.getSharedState('start'),o=this.getSharedState('end');return o.clone().subtract(t).multiply(e.getInputDimensions(!1)).round()},t.prototype._getAreaStyles=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=e.getCanvasDimensions(),i=this.getSharedState('start').clone().multiply(t).floor(),r=this.getSharedState('end').clone().multiply(t).ceil(),a=r.clone().subtract(i),n=o.clone().subtract(t).divide(2).floor(),s=e.getPadding();return i.add(n).add(0,s[0]),{topLeft:this._getDimensionsStyles(i.x,i.y),topCenter:this._getDimensionsStyles(a.x,i.y),centerLeft:this._getDimensionsStyles(i.x,a.y),center:this._getDimensionsStyles(a.x,a.y)}},t.prototype._getDimensionsStyles=function(e,t){return{width:c(1,e),height:c(1,t)}},t.prototype.renderWithBEM=function(){var e=this.getSharedState('ratio'),t=this.state.dimensions,o;if(e){var i=this._getAreaStyles();o=m.ReactBEM.createElement('div',{bem:'$b:transformCanvasControls'},m.ReactBEM.createElement('div',{bem:'e:row'},m.ReactBEM.createElement('div',{bem:'e:cell m:dark',style:i.topLeft},'\xA0'),m.ReactBEM.createElement('div',{bem:'e:cell m:dark',style:i.topCenter},'\xA0'),m.ReactBEM.createElement('div',{bem:'e:cell m:dark'})),m.ReactBEM.createElement('div',{bem:'e:row'},m.ReactBEM.createElement('div',{bem:'e:cell m:dark',style:i.centerLeft},'\xA0'),m.ReactBEM.createElement(u.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},m.ReactBEM.createElement('div',{bem:'e:cell m:bordered',style:i.center},m.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart.bind(this,'start'),onDrag:this._onKnobDrag.bind(this,'start')},m.ReactBEM.createElement('div',{bem:'e:knob m:topLeft $b:knob'},m.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)}))),m.ReactBEM.createElement('div',{bem:'e:dimensions'},t.x+'x'+t.y),m.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart.bind(this,'end'),onDrag:this._onKnobDrag.bind(this,'end')},m.ReactBEM.createElement('div',{bem:'e:knob m:bottomRight $b:knob'},m.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)}))))),m.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0')),m.ReactBEM.createElement('div',{bem:'e:row'},m.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0'),m.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0'),m.ReactBEM.createElement('div',{bem:'e:cell m:dark'},'\xA0')))}else o=m.ReactBEM.createElement('div',{bem:'$b:transformCanvasControls'},m.ReactBEM.createElement('div',{bem:'e:dimensions'},t.x+'x'+t.y));return m.ReactBEM.createElement('div',{bem:'b:canvasControls e:container m:full',ref:'container'},o)},t}(f.default);t.default=h,h.contextTypes=f.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(36),u=i(_),g=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,e.apply(this,arguments))}return(0,c.default)(t,e),t.prototype._onRotateClick=function(e){var t;'cw'===e?t=90:'ccw'===e&&(t=-90);var o=this.context.editor,i=this.getSharedState('orientationOperation'),r=(i.getRotation()+t)%360;i.set({rotation:r});var a={orientationRotation:r},n=this.getSharedState('ratio');if(n&&!n.dimensions){var s=this.getSharedState('start'),l=this.getSharedState('end'),d=s.clone();'cw'===e?(s.set(1-l.y,d.x),l.set(1-d.y,l.x)):'ccw'===e&&(s.set(d.y,1-l.x),l.set(l.y,1-d.x)),a.start=s,a.end=l}n&&n.dimensions&&this._emitEvent(m.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO),this.setSharedState(a),o.broadcastRotate(t),o.zoom.set('auto')},t.prototype._onFlipClick=function(e){var t=this.context.editor,o=this.getSharedState('orientationOperation'),i=!this.getSharedState('flip'+e),r=-1*this.getSharedState('rotation'),n;this.setSharedState((n={},(0,a.default)(n,'flip'+e,i),(0,a.default)(n,'rotation',r),n)),t.setRotation(r),o.flip(e);var s=this.getSharedState('start'),l=this.getSharedState('end'),d=s.clone();'horizontal'===e?(s.set(1-l.x,s.y),l.set(1-d.x,l.y)):'vertical'===e&&(s.set(s.x,1-l.y),l.set(l.x,1-d.y)),this.setSharedState({start:s,end:l}),t.broadcastFlip(e),t.render()},t.prototype.shouldSharedComponentUpdate=function(){return!1},t.prototype.renderContent=function(){return m.ReactBEM.createElement('bem',{specifier:'$b:topBar'},m.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onFlipClick.bind(this,'vertical')},m.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/transform/flip-v.png',!0)})),m.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onFlipClick.bind(this,'horizontal')},m.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/transform/flip-h.png',!0)})),m.ReactBEM.createElement('div',{bem:'e:space'}),m.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onRotateClick.bind(this,'ccw')},m.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/transform/rotate-ccw.png',!0)})),m.ReactBEM.createElement('div',{bem:'$e:iconButton',onClick:this._onRotateClick.bind(this,'cw')},m.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/transform/rotate-cw.png',!0)})))},t}(u.default);t.default=g,g.contextTypes=u.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(10),m=i(c),_=o(229),u=i(_),g=o(66),f=i(g),y=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onEnter=function(){var e=this.context.editor,t=e.operations.exists('filter'),o=e.operations.getOrCreate('filter'),i=o.serializeOptions(['identifier','filter','intensity']);this.setSharedState({operation:o,operationExistedBefore:t,initialOptions:i})},t.onExit=function(){var e=this.getSharedState('initialOptions'),t=this._operation.getFilter().constructor,o=e.filter.constructor,i;'3d-lut'===o.identifier&&(i=e.filter.getImage());var r=this._operation.getIntensity();if(this._operation.getIdentifier()!==e.identifier||r!==e.intensity){var a=this.context.editor;a.history.add(this._operation,{identifier:e.identifier,intensity:r},this.getSharedState('operationExistedBefore'),function(){var e=a.operations.getOrCreate('filter');'3d-lut'===o.identifier?e.setFilter(new o({image:i})):e.setFilter(new o)})}if(t.isIdentity){var n=this.context.editor;n.operations.remove(this._operation)}},t.isAvailable=function(e){return e.isToolAllowed('filter')&&e.isToolEnabled(this.identifier)},t.getPreloadAssets=function(e){var t=e.getOptions(),o=p.SDKUtils.defaults(t.editor.controlsOptions.filter,this.defaultOptions),i=new f.default(e.getUI(),o),r=[],a=i.getCategories();return a.forEach(function(e){r.push('controls/filters/categories/'+e.identifier+'.png');var t=i.getFiltersForCategory(e.identifier);t.forEach(function(e){r.push('controls/filters/'+e.identifier+'.png'),e.lutImage&&r.push([e.lutImage,!1,!1])})}),r},t}(m.default);y.controlsComponent=u.default,y.identifier='filter',y.iconPath='controls/overview/filters.png',y.languageKey='controls.overview.filters',y.defaultOptions={categories:[],replaceCategories:!1,availableFilters:null,hideCategories:!1},t.default=y},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(9),u=i(_),g=o(6),f=i(g),y=o(96),h=i(y),b=o(15),k=i(b),v=o(66),E=i(v),S=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,d.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onItemClick','_onOperationUpdated','_onSliderValueChange','_onCategoryChange'),n._operation=n.getSharedState('operation'),n._events=(0,a.default)({},m.Constants.EVENTS.OPERATION_UPDATED,n._onOperationUpdated),n._initFilterManager(),n.state={category:n._filterManager.getCategoryByIdentifier('all')},n}return(0,c.default)(t,e),t.prototype._initFilterManager=function(){this._filterManager=new E.default(this.context.ui,this.props.options)},t.prototype._onSliderValueChange=function(e){this._operation.setIntensity(e/100);var t=this.context.editor;t.render()},t.prototype._onCategoryChange=function(e){var t=this;this.setState({category:e},function(){t.refs.scrollbar.update()})},t.prototype._onOperationUpdated=function(e){e===this._operation&&this.forceUpdate()},t.prototype._onItemClick=function(e){var t=this;this._filterManager.instantiateFilterWithIdentifier(e).then(function(o){t._operation.set({filter:o,identifier:e,intensity:1});var i=t.context.editor;i.render(),t.forceUpdate()})},t.prototype.renderOverlayControls=function(){var e=this._operation.getFilter();if(e.isIdentity)return null;var t=this._operation.getIntensity();return m.ReactBEM.createElement(k.default,{minValue:0,maxValue:100,value:100*t,valueUnit:'%',positiveValuePrefix:'+',label:this._t('controls.filter.intensity'),onChange:this._onSliderValueChange})},t.prototype._renderListItems=function(){var e=this,t=this._operation.getIdentifier(),o=this._filterManager.getFiltersForCategory(this.state.category.identifier);return[m.SDK.Filters.IdentityFilter].concat(o).map(function(o){var i=o.identifier;return m.ReactBEM.createElement('li',{bem:'e:item',key:i,onClick:e._onItemClick.bind(e,i)},m.ReactBEM.createElement('bem',{specifier:'$b:controls'},m.ReactBEM.createElement('div',{bem:'$e:button m:withInlineLabel'},m.ReactBEM.createElement('img',{bem:'e:icon',src:e._getAssetPath('controls/filters/'+i+'.png',!0)}),m.ReactBEM.createElement('div',{bem:'$e:inlineLabel',className:i===t?'is-active':null},m.ReactBEM.createElement('div',{bem:'e:label'},e._t('controls.filter.filters.'+o.identifier)||o.defaultName)))))})},t.prototype._renderCategoryDropdown=function(){var e=this,t=this._filterManager.getCategories(),o=!this.props.options.hideCategories&&1<t.length;if(!o)return null;var i=t.map(function(t){return{identifier:t.identifier,item:t,label:e._t('controls.filter.categories.'+t.identifier)||t.defaultName,icon:e._getAssetPath('controls/filters/categories/'+t.identifier+'.png',!0)}}),r={identifier:this.state.category.identifier,item:this.state.category,label:this._t('controls.filter.categories.'+this.state.category.identifier)||this.state.category.defaultName,icon:this._getAssetPath('controls/filters/categories/'+this.state.category.identifier+'.png',!0)};return m.ReactBEM.createElement('div',{bem:'e:cell m:categoryDropdown'},m.ReactBEM.createElement(h.default,{items:i,selectedItem:r,onChange:this._onCategoryChange}))},t.prototype.renderControls=function(){var e=this._renderListItems(),t=this._renderCategoryDropdown();return[t,m.ReactBEM.createElement('div',{bem:'e:cell m:list'},m.ReactBEM.createElement(f.default,{ref:'scrollbar'},m.ReactBEM.createElement('ul',{bem:'$e:list'},e)))]},t}(u.default);t.default=S,S.contextTypes=u.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._onItemClick=function(e){this.props.onChange&&this.props.onChange(e.item)},t.prototype._renderListItems=function(){var e=this;return this.props.items.map(function(t){var o=t.identifier===e.props.selectedItem.identifier;return p.ReactBEM.createElement('li',{bem:'$e:item',className:o?' is-active':'',onClick:e._onItemClick.bind(e,t)},p.ReactBEM.createElement('img',{bem:'e:icon',src:t.icon}),p.ReactBEM.createElement('div',{bem:'e:label'},t.label))})},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:categoryDropdown $e:overlay'},p.ReactBEM.createElement('ul',{bem:'$e:list'},this._renderListItems()))},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(10),c=i(p),m=o(232),_=i(m),u=o(233),g=i(u),f=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.isAvailable=function(e){return e.isToolAllowed('focus')&&(e.isToolEnabled('radial-focus')||e.isToolEnabled('mirrored-focus'))},t.onExit=function(){var e=this.context.editor;e.features.enable('zoom','drag');var t=this.getSharedState('initialOptions'),o=this.getSharedState('initialOperation'),i=this.getSharedState('operation');(!i&&o||i&&o&&i.constructor===o.constructor)&&e.history.add(o,t,!0),i&&!o&&e.history.add(i,{},!1),i&&o&&i.constructor!==o.constructor&&e.history.add([{operation:o,options:t,existent:!0},{operation:i,options:{},existent:!1}])},t.onEnter=function(){var e=this.context.editor,t=e.operations.get('mirrored-focus')||e.operations.get('radial-focus'),o={};t&&(o=t.serializeOptions(),delete o.enabled),this.setSharedState({operation:t,initialOperation:t,operationExistedBefore:!!t,initialOptions:o,inputDimensions:e.getOutputDimensions()})},t.getPreloadAssets=function(e){var t=[];return e.isToolEnabled('radial-focus')&&t.push('controls/focus/radial.png'),e.isToolEnabled('mirrored-focus')&&t.push('controls/focus/mirrored.png'),t},t}(c.default);f.controlsComponent=_.default,f.canvasControlsComponent=g.default,f.identifier='focus',f.iconPath='controls/overview/focus.png',f.languageKey='controls.overview.focus',f.defaultOptions={},t.default=f},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),c=i(l),m=o(3),_=i(m),u=o(1),g=o(9),f=i(g),y=o(6),h=i(y),b=o(15),k=i(b),v=[{toolName:'radial-focus',iconName:'radial',languageKey:'controls.focus.radial'},{toolName:'mirrored-focus',iconName:'mirrored',languageKey:'controls.focus.mirrored'}],E=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,c.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onBlurRadiusChange','_onOperationRemoved'),n._removedOperation=null,n._events=(0,a.default)({},u.Constants.EVENTS.OPERATION_REMOVED,n._onOperationRemoved),n}return(0,_.default)(t,e),t.prototype._onBlurRadiusChange=function(e){var t=this.getSharedState('operation'),o=this.getSharedState('inputDimensions');t.setBlurRadius(e/o.min());var i=this.context.editor;i.render()},t.prototype._onButtonClick=function(e){var t=this.context.editor,o=this.getSharedState('operation');o&&(this._removedOperation=o,t.operations.remove(o));var i=null;e&&(i=t.operations.getOrCreate(e)),this.setSharedState({operation:i}),t.render()},t.prototype._onOperationRemoved=function(e){var t=this.getSharedState('operation');if(t&&e===t&&e!==this._removedOperation&&!this._backButtonClicked){var o=this.context.editor,i=t.constructor.identifier,r=o.operations.getOrCreate(i);this.setSharedState({operation:r,operationExistedBefore:!1,initialOptions:{}})}},t.prototype.renderOverlayControls=function(){var e=this.getSharedState('operation');if(!e)return null;var t=this.getSharedState('inputDimensions'),o=t.min(),i=e.getBlurRadius()*o;return u.ReactBEM.createElement(k.default,{minValue:0,maxValue:p(180,d(0.1*o)),valueUnit:'px',middleDot:!1,label:this._t('controls.focus.blurRadius'),onChange:this._onBlurRadiusChange,value:i})},t.prototype._renderListItems=function(){var e=this,t=this.getSharedState('operation'),o=this.context.editor,i=u.ReactBEM.createElement('li',{bem:'e:item',key:'none'},u.ReactBEM.createElement('bem',{specifier:'$b:controls'},u.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:t?null:'is-active',onClick:this._onButtonClick.bind(this,null)},u.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/focus/none.png',!0)}),u.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.focus.none')))));return[i].concat(v.filter(function(e){var t=e.toolName;return o.isToolEnabled(t)}).map(function(o){var i=o.toolName,r=o.iconName,a=o.languageKey,n=t&&t.constructor.identifier===i;return u.ReactBEM.createElement('li',{bem:'e:item',"data-identifier":i,key:i},u.ReactBEM.createElement('bem',{specifier:'$b:controls'},u.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:n?'is-active':null,onClick:e._onButtonClick.bind(e,i)},u.ReactBEM.createElement('img',{bem:'e:icon',src:e._getAssetPath('controls/focus/'+r+'.png',!0)}),u.ReactBEM.createElement('div',{bem:'e:label'},e._t(a)))))}))},t.prototype.renderControls=function(){var e=this._renderListItems();return u.ReactBEM.createElement('div',{bem:'e:cell m:list'},u.ReactBEM.createElement(h.default,null,u.ReactBEM.createElement('ul',{bem:'$e:list'},e)))},t}(f.default);t.default=E,E.contextTypes=f.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(24),m=i(c),_=o(234),u=i(_),g=o(235),f=i(g),y=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._getControlsForOperation=function(e){if(!e)return null;switch(e.constructor.identifier){case'mirrored-focus':return u.default;case'radial-focus':return f.default;}},t.prototype.renderWithBEM=function(){var e=this.getSharedState('operation'),t=this._getControlsForOperation(e);return t?p.ReactBEM.createElement(t,this.props):p.ReactBEM.createElement('div',null)},t}(m.default);t.default=y,y.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var a=o(4),s=r(a),l=o(0),d=r(l),p=o(2),c=r(p),m=o(3),_=r(m),u=o(1),g=o(11),f=r(g),y=o(24),h=r(y),b=function(e){function t(){(0,d.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,c.default)(this,e.call.apply(e,[this].concat(i)));return a._bindAll('_onCenterDragStart','_onCenterDrag','_onKnobDragStart','_onKnobDrag','_onOperationUpdated'),a.state={areaPosition:new u.Vector2,areaDimensions:new u.Vector2,knobPosition:new u.Vector2},a._operation=a.getSharedState('operation'),a._events=(0,s.default)({},u.Constants.EVENTS.OPERATION_UPDATED,a._onOperationUpdated),a}return(0,_.default)(t,e),t.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions()},t.prototype._onOperationUpdated=function(e){e!==this.getSharedState('operation')||this._setStylesFromOptions()},t.prototype.sharedStateDidChange=function(e){e.operation&&(this._operation=e.operation,'mirrored-focus'===this._operation.constructor.identifier&&this._setStylesFromOptions())},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set('auto',function(){o.features.disable('zoom','drag'),t._setStylesFromOptions()})},t.prototype._onCenterDragStart=function(){this._initialStart=this._operation.getStart(),this._initialEnd=this._operation.getEnd(),this._initialDist=this._initialEnd.clone().subtract(this._initialStart)},t.prototype._onCenterDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=e.clone().divide(o),r=this._initialStart.clone().add(i).clamp(new u.Vector2(0,0),new u.Vector2(1,1).subtract(this._initialDist)),a=r.clone().add(this._initialDist);this._operation.set({start:r,end:a}),t.render(),this._setStylesFromOptions(),this.forceUpdate()},t.prototype._onKnobDragStart=function(){this._initialKnobPosition=this.state.knobPosition.clone()},t.prototype._onKnobDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=this._initialKnobPosition.clone().add(e).clamp(new u.Vector2(0,0),o),r=i.clone().subtract(this.state.areaPosition),a=this.state.areaPosition.clone().add(-r.y,r.x).divide(o),n=this.state.areaPosition.clone().add(r.y,-r.x).divide(o),s=2*r.len();this._operation.set({start:a,end:n,size:s/o.min(),gradientSize:s/o.min()}),this.setState({knobPosition:i,areaDimensions:new u.Vector2(this.state.areaDimensions.x,s)}),t.render()},t.prototype._getAreaStyle=function(){var e=this.state.knobPosition.clone().subtract(this.state.areaPosition),t=i(e.x,e.y)*(180/n),o='rotate('+(-t).toFixed(2)+'deg)';return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-0.5*this.state.areaDimensions.x,marginTop:-0.5*this.state.areaDimensions.y,transform:o,MozTransform:o,msTransform:o,WebkitTransform:o}},t.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}},t.prototype._setStylesFromOptions=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=this._operation.getStart().clone().multiply(t),i=this._operation.getEnd().clone().multiply(t),r=this._operation.getSize()*t.min(),a=i.clone().subtract(o),n=o.clone().add(a.clone().divide(2)),s=new u.Vector2(2*t.len(),r),l=a.len(),d=a.clone().divide(l).divide(2);this.setState({areaDimensions:s,areaPosition:n.clone(),knobPosition:n.clone().add(-r*d.y,r*d.x)})},t.prototype._getContainerStyle=function(){var e=this.context.editor.getSDK().getSprite().getBounds(),t=e.x,o=e.y,i=e.width,r=e.height;return{left:t,top:o,width:i,height:r}},t.prototype.renderWithBEM=function(){return u.ReactBEM.createElement('div',{bem:'b:canvasControls e:container m:full',ref:'container',style:this._getContainerStyle()},u.ReactBEM.createElement('div',{bem:'$b:linearFocusCanvasControls'},u.ReactBEM.createElement(f.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},u.ReactBEM.createElement('div',{bem:'e:area',style:this._getAreaStyle()})),u.ReactBEM.createElement(f.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getKnobStyle()}))))},t}(h.default);t.default=b,b.contextTypes=h.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(11),u=i(_),g=o(24),f=i(g),y=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,d.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onCenterDragStart','_onCenterDrag','_onKnobDragStart','_onKnobDrag','_onOperationUpdated'),n.state={areaPosition:new m.Vector2,areaDimensions:new m.Vector2,knobPosition:new m.Vector2},n._knobChangedManually=!1,n._operation=n.getSharedState('operation'),n._events=(0,a.default)({},m.Constants.EVENTS.OPERATION_UPDATED,n._onOperationUpdated),n}return(0,c.default)(t,e),t.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions()},t.prototype._onOperationUpdated=function(e){e!==this.getSharedState('operation')||(this._knobChangedManually=!1,this._setStylesFromOptions())},t.prototype.sharedStateDidChange=function(e){e.operation&&(this._operation=e.operation,'radial-focus'===this._operation.constructor.identifier&&this._setStylesFromOptions())},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set('auto',function(){o.features.disable('zoom','drag'),t._setStylesFromOptions()})},t.prototype._onCenterDragStart=function(){this._initialPosition=this._operation.getPosition(),this._initialKnobPosition=this.state.knobPosition.clone()},t.prototype._onCenterDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=e.clone().divide(o),r=this._initialPosition.clone().add(i),a=this._initialKnobPosition.clone().add(e);this._operation.set({position:r}),this.state.knobPosition=a,t.render(),this._setStylesFromOptions()},t.prototype._onKnobDragStart=function(){this._knobChangedManually=!0,this._initialKnobPosition=this.state.knobPosition.clone()},t.prototype._onKnobDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=this._initialKnobPosition.clone().add(e).clamp(new m.Vector2(0,0),o),r=this._operation.getPosition().clone().multiply(o),a=i.clone().subtract(r).abs().len();this.setState({knobPosition:i,areaDimensions:new m.Vector2(2*a,2*a)}),this._operation.set({radius:a/o.min(),gradientRadius:a/2/o.min()}),t.render()},t.prototype._getAreaStyle=function(){return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-0.5*this.state.areaDimensions.x,marginTop:-0.5*this.state.areaDimensions.y}},t.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}},t.prototype._setStylesFromOptions=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=this._operation.getPosition().clone().multiply(t),i=this._operation.getRadius()*t.min(),r=2*i,a=new m.Vector2(r,r),n={areaDimensions:a,areaPosition:o};this._knobChangedManually||(n.knobPosition=o.clone().add(i,0)),this.setState(n)},t.prototype._getContainerStyle=function(){var e=this.context.editor,t=e.getSDK().getSprite().getBounds(),o=t.x,i=t.y,r=t.width,a=t.height;return{left:o,top:i,width:r,height:a}},t.prototype.renderWithBEM=function(){return m.ReactBEM.createElement('div',{bem:'b:canvasControls e:container m:full',ref:'container',style:this._getContainerStyle()},m.ReactBEM.createElement('div',{bem:'$b:radialFocusCanvasControls'},m.ReactBEM.createElement(u.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},m.ReactBEM.createElement('div',{bem:'e:area',style:this._getAreaStyle()})),m.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},m.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getKnobStyle()}))))},t}(f.default);t.default=y,y.contextTypes=f.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(10),m=i(c),_=o(237),u=i(_),g=o(239),f=i(g),y=p.SDK.Operations.SpriteOperation,h=y.StickerSprite,b=y.BrushSprite,k=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState('operation');this.getSharedState('skipHistory')||e.history.add(t,this.getSharedState('initialOptions'),this.getSharedState('operationExistedBefore')),t.setEnabled(!0),e.zoom.restore(),e.features.enable('zoom','drag'),e.render()},t.onEnter=function(){var e=this.context.editor,t=e.operations.exists('sprite'),o=e.operations.getOrCreate('sprite'),i=o.getSprites(),r=o.getSpritesOfType(h),a=o.serializeOptions();o.setEnabled(!1),e.zoom.save(),e.zoom.set('auto'),e.features.disable('zoom','drag'),this.setSharedState({operationExistedBefore:t,operation:o,sprites:i,stickers:r,initialOptions:a})},t.clickAtPosition=function(e,t){if(!t.operations.exists('sprite'))return!1;var o=t.operations.getOrCreate('sprite'),i=o.getSpritesAtPosition(e,t.getOutputTextureDimensions()).filter(function(e){return!(e instanceof b)});return i.length&&i[0]instanceof h&&{selectedSprite:i[0]}},t.isAvailable=function(e){return e.isToolAllowed('sticker')&&e.isToolEnabled('sticker')},t}(m.default);k.controlsComponent=u.default,k.canvasControlsComponent=f.default,k.identifier='sticker',k.iconPath='controls/overview/sticker.png',k.languageKey='controls.overview.sticker',k.defaultOptions={categories:null,replaceCategories:!1,availableStickers:null,tooltips:!1,hideCategories:!1,fixedRatio:!0,snapRotation:90,snapRotationTolerance:5,smoothDownscaling:!1},k.getPreloadAssets=m.default.getPreloadAssets,t.default=k},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(29),a=i(r),n=o(4),s=i(n),l=o(0),d=i(l),c=o(2),m=i(c),_=o(3),u=i(_),g=o(1),f=o(9),y=i(f),h=o(6),b=i(h),k=o(96),v=i(k),E=o(5),S=i(E),M=o(30),C=i(M),B=o(238),R=i(B),x=function(e){function t(){(0,d.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,m.default)(this,e.call.apply(e,[this].concat(i)));return a._bindAll('_onStickerMouseLeave','_renderTooltipCanvas','_onCategoryChange','_onBeforeHistoryUndo'),a._events=(0,s.default)({},g.Constants.EVENTS.HISTORY_BEFORE_UNDO,a._onBeforeHistoryUndo),a._operation=a.getSharedState('operation'),a._sprites=a.getSharedState('sprites'),a._stickers=a.getSharedState('stickers'),a._initStickerManager(),a.state={category:a._stickerManager.getCategory('all')},a}return(0,u.default)(t,e),t.prototype._onBeforeHistoryUndo=function(e){var t=e.operation,o=e.options;if(t===this.getSharedState('operation')){var i=o.sprites;-1===i.indexOf(this.getSharedState('selectedSprite'))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls('home'))}},t.prototype._onCategoryChange=function(e){var t=this;this.setState({category:e},function(){t.refs.scrollbar.update()})},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.options.stickersJSONPath&&this._loadExternalStickers();var t=this.context.editor;t.zoom.set('auto',function(){t.features.disable('zoom','drag')})},t.prototype._loadExternalStickers=function(){var t=this,e=null,o=setTimeout(function(){e=S.default.instance.displayLoading(t._t('loading.loading'))},100),i=function(){o&&(clearTimeout(o),o=null),e&&e.close(),t._jsonLoaded=!0};this._stickerManager.loadExternal(this.props.options.stickersJSONPath).then(function(){i(),t.forceUpdate(function(){t.refs.scrollbar.update()})}).catch(function(o){i();var e=S.default.instance.displayError(t._t('errors.loadingStickersFailed.title'),o.message);e.on('close',function(){t.props.onBack()})})},t.prototype._renderTooltipCanvas=function(){var e=this,t=this.state.hoveredSticker,o=new window.Image,i=t.images.mediaBase;o.addEventListener('load',function(){if(e.state.tooltipVisible&&e.state.hoveredSticker===t){'undefined'!=typeof i.width&&'undefined'!=typeof i.height&&(o.width=i.width,o.height=i.height);var r=e.refs.tooltipCanvas;r.width=r.offsetWidth,r.height=r.offsetHeight;var a=r.getContext('2d'),n=p(r.width/o.width,r.height/o.height),s=new g.Vector2(o.width,o.height).multiply(n),l=new g.Vector2(r.width,r.height).divide(2).subtract(s.clone().divide(2));a.drawImage(o,0,0,o.width,o.height,l.x,l.y,s.x,s.y)}});var r=this._getAssetPath(C.default.getURLForSticker(t,'base'));o.crossOrigin='Anonymous',o.src=r},t.prototype._initStickerManager=function(){this._stickerManager=new C.default(this.context.ui,this.props.options)},t.prototype._onBackClick=function(){this._backButtonClicked=!0,this.props.onSwitchControls('home')},t.prototype._onStickerClick=function(e){var t=this,o=e.images.mediaBase,i=C.default.getURLForSticker(e,'base'),r=this._getAssetPath(i),a=new window.Image,n=setTimeout(function(){s=S.default.instance.displayLoading(t._t('loading.loading'))},100),s;a.addEventListener('load',function(){s&&s.close(),n&&(clearTimeout(n),n=null),'undefined'!=typeof o.width&&'undefined'!=typeof o.height&&(a.width=o.width,a.height=o.height);var i=t.context.editor,r=t._calculateInitialStickerScale(e,a),l=t._operation.createSticker({identifier:e.identifier,image:a,position:new g.Vector2(0.5,0.5),dimensions:new g.Vector2(a.width,a.height).multiply(r),rotation:0,smoothDownscaling:t.props.options.smoothDownscaling});t._operation.addSprite(l),t._stickers.push(l),i.render(function(){t.setSharedState({selectedSprite:l,sprites:t._sprites,stickers:t._stickers})})}),a.addEventListener('error',function(){s&&s.close(),n&&(clearTimeout(n),n=null),S.default.instance.displayError(t._t('errors.imageLoadFail.title'),t._t('errors.imageLoadFail.text',{path:a.src}))}),a.crossOrigin='Anonymous',a.src=r},t.prototype._calculateInitialStickerScale=function(e,t){var o=this.getSharedState('operation'),i=o.getInputDimensions(!1),r=new g.Vector2(t.width,t.height),a=g.SDKUtils.resizeVectorToFit(r,i.clone().multiply(0.5));return a.x/r.x},t.prototype._onStickerMouseEnter=function(t,o){var e=this;this.setState({tooltipVisible:!0,hoveredSticker:t,hoveredStickerElement:o.currentTarget},function(){e._renderTooltipCanvas(),e._updateTooltipPosition()})},t.prototype._updateTooltipPosition=function(){var e=this.state.hoveredStickerElement,t=this.refs.root,o=e.getBoundingClientRect(),i=t.getBoundingClientRect();this.setState({tooltipPosition:o.left-i.left})},t.prototype._onStickerMouseLeave=function(){this.setState({tooltipVisible:!1,hoveredSticker:null})},t.prototype._renderListItems=function(){var e=this,t=this.props.options,o=t.stickersJSONPath,i=t.replaceCategories;if(!(o&&i&&!this._jsonLoaded)){var r=this._stickerManager.getStickersForCategory(this.state.category.identifier);return r.map(function(t){var o=e.props.options,i=o.tooltips?{onMouseEnter:e._onStickerMouseEnter.bind(e,t),onMouseLeave:e._onStickerMouseLeave}:null;return g.ReactBEM.createElement(R.default,(0,a.default)({sticker:t,onClick:e._onStickerClick.bind(e,t)},i))})}},t.prototype._renderTooltip=function(){var e=this.props.options.tooltips&&this.state.tooltipVisible,t={left:this.state.tooltipPosition};return e?g.ReactBEM.createElement('div',{bem:'e:cell m:empty'},g.ReactBEM.createElement('div',{bem:'$b:stickersControls $e:tooltip',style:t},g.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'tooltipCanvas'}))):null},t.prototype._renderCategoryDropdown=function(){var e=this,t=this.props.options,o=t.stickersJSONPath,i=t.replaceCategories;if(!(o&&i&&!this._jsonLoaded)){var r=this._stickerManager.getCategories(!0),a=!this.props.options.hideCategories&&1<r.length;if(!a)return null;var n=r.map(function(t){return{identifier:t.identifier,item:t,label:e._t('controls.sticker.categories.'+t.identifier)||t.defaultName,icon:e._getAssetPath('controls/stickers/categories/'+t.identifier+'.png',!0)}}),s=this.state.category,l={identifier:s.identifier,item:s,label:this._t('controls.sticker.categories.'+s.identifier)||s.defaultName,icon:this._getAssetPath('controls/stickers/categories/'+s.identifier+'.png',!0)};return g.ReactBEM.createElement('div',{bem:'e:cell m:categoryDropdown'},g.ReactBEM.createElement(v.default,{items:n,selectedItem:l,onChange:this._onCategoryChange}))}},t.prototype.renderControls=function(){var e=this._renderListItems(),t=this._renderTooltip(),o=this._renderCategoryDropdown();return[t,o,g.ReactBEM.createElement('div',{bem:'e:cell m:list'},g.ReactBEM.createElement(b.default,{ref:'scrollbar'},g.ReactBEM.createElement('ul',{bem:'$e:list'},e)))]},t}(y.default);t.default=x,x.contextTypes=y.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),c=o(1),m=o(30),_=i(m),u=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n.state={sticker:n.props.sticker},n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){this._renderSticker()},t.prototype.componentWillReceiveProps=function(e){var t=this;this.props.sticker!==e.sticker&&this.setState({sticker:e.sticker},function(){t._renderSticker()})},t.prototype._renderSticker=function(){var e=this.context.editor,t=e.getSDK(),o=this.props.sticker,i=o.images.mediaThumb,r=_.default.getURLForSticker(o,'thumb'),a=this._getAssetPath(r),n=this.refs['canvas-'+o.name],s=t.getPixelRatio();n.width=n.offsetWidth*s,n.height=n.offsetHeight*s,n.style.width=n.offsetWidth+'px',n.style.height=n.offsetHeight+'px';var l=n.getContext('2d'),d=new window.Image;d.addEventListener('load',function(){'undefined'!=typeof i.width&&'undefined'!=typeof i.height&&(d.width=i.width,d.height=i.height);var e=p(n.width/d.width,n.height/d.height),t=new c.Vector2(d.width,d.height).multiply(e),o=new c.Vector2(n.width,n.height).divide(2).subtract(t.clone().divide(2));l.drawImage(d,0,0,d.width,d.height,o.x,o.y,t.x,t.y)}),d.crossOrigin='Anonymous',d.src=a},t.prototype.renderWithBEM=function(){return c.ReactBEM.createElement('li',{bem:'$b:stickersControls $e:item',key:this.props.sticker.name,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},c.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas-'+this.props.sticker.name}))},t}(c.BaseComponent);t.default=u},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(38),m=i(c),_=o(243),u=i(_),g=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._renderOverlayControls=function(){return this.getSharedState('selectedSprite')?p.ReactBEM.createElement(u.default,{onFlip:this._onSpriteFlip,onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove}):void 0},t}(m.default);t.default=g,g.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var l=o(0),d=s(l),m=o(2),_=s(m),u=o(3),g=s(u),f=o(1),y=o(11),h=s(y),b=o(67),k=s(b),v=function(e){function t(){(0,d.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,_.default)(this,e.call.apply(e,[this].concat(i)));return a._bindAll('_onTextChange','_onItemDoubleClick','_onItemTouchStart','_onItemTouchEnd','_onResizeKnobDragStart','_onResizeKnobDrag','_onResizeKnobDragStop','_onRotationKnobDragStart','_onRotationKnobDrag','_onRotationKnobDragStop'),a.state={editMode:!1,text:a.props.sprite.getText()},a}return(0,g.default)(t,e),t.prototype.componentWillReceiveProps=function(t){e.prototype.componentWillReceiveProps.call(this,t),t.sprite!==this.props.sprite&&(this.refs.textarea.blur(),this.setState({text:t.sprite.getText(),editMode:!1}))},t.prototype._onTextChange=function(t){var e=this.props.sprite;e.setText(t.target.value),this.setState({text:t.target.value})},t.prototype._onItemDoubleClick=function(){this.enterEditMode()},t.prototype.enterEditMode=function(){var e=this,t=this.props.sprite;t._edited||(t.setText(''),this.refs.textarea.value='',t._edited=!0,this.setState({text:''})),this.setState({editMode:!0},function(){e.refs.textarea.focus(),e.refs.textarea.select()})},t.prototype._onItemTouchStart=function(t){this._initialTouchPosition=f.Utils.getEventPosition(t),this._tapStartAt=(0,f.now)()},t.prototype._onItemTouchEnd=function(){100>=(0,f.now)()-this._tapStartAt&&('undefined'!=typeof this._lastTapAt&&300>=(0,f.now)()-this._lastTapAt&&this._onItemDoubleClick(),this._lastTapAt=(0,f.now)())},t.prototype._onRotationKnobDragStart=function(){this._dragging=!0,this._initialPosition=this._getRotationKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onRotationKnobDrag=function(e){var t=this.props.sprite,o=this.context.editor,r=this._getAbsoluteSpritePosition(),a=this._initialPosition.clone().add(e),n=a.clone().subtract(r),s=t.getDimensions(o.getSDK(),o.getOutputDimensions()),l=i(n.y/2,n.x/2)-i(s.y/2,s.x/2);t.setRotation(l),this.forceUpdate()},t.prototype._onRotationKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onResizeKnobDragStart=function(){this._initialPosition=this._getResizeKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onResizeKnobDrag=function(e){var t=this.props.sprite,o=t.getRotation(),i=this.context.editor,n=i.getOutputDimensions(),s=a(o),l=r(o),d=this._initialPosition.clone().add(e),p=this._getAbsoluteSpritePosition(),m=d.clone().subtract(p),_=c(2*((m.x*s+m.y*l)/n.x),0.1);t.setMaxWidth(_)},t.prototype._onResizeKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t.prototype._getRotationKnobStyle=function(){var e=this._getRotationKnobPosition();return{left:e.x,top:e.y}},t.prototype._getResizeKnobStyle=function(){var e=this._getResizeKnobPosition();return{left:e.x,top:e.y}},t.prototype._getTextStyle=function(){var e=this.context.editor,t=this.props.sprite,o=e.getSDK(),i=e.getOutputDimensions(),r=t.getDOMStyle(o,i),a=this._getAbsoluteSpritePosition(),n=t.getDimensions(o,i);return r.height=p(n.y,i.y-a.y),r},t.prototype._getItemContainerStyle=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=this.props.sprite,i=o.getPosition().clone().multiply(t),r=180*o.getRotation()/n,a='rotateZ('+r.toFixed(2)+'deg)',s='50% 50%',l=o.getMaxWidth()*t.x,d=o.getDimensions(e.getSDK(),t).y;return{width:l,left:i.x,top:i.y,marginLeft:-0.5*l,marginTop:-0.5*d,transform:a,MozTransform:a,msTransform:a,WebkitTransform:a,transformOrigin:s,MozTransformOrigin:s,msTransformOrigin:s,WebkitTransformOrigin:s}},t.prototype._getRotationKnobPosition=function(){var e=this.props.sprite,t=this.context.editor,o=r(e.getRotation()),i=a(e.getRotation()),n=t.getOutputDimensions(),s=e.getDimensions(t.getSDK(),n),l=s.clone().divide(2),d=e.getPosition().clone().multiply(n).add(l.x*i-s.y/2*o,l.x*o+s.y/2*i);return d},t.prototype._getResizeKnobPosition=function(){var e=this.props.sprite,t=this.context.editor,o=r(e.getRotation()),i=a(e.getRotation()),n=t.getOutputDimensions(),s=e.getDimensions(t.getSDK(),n),l=s.clone().divide(2),d=e.getPosition().clone().multiply(n).add(l.x*i+s.y/2*o,l.x*o-s.y/2*i);return d},t.prototype._renderKnobs=function(){var e=[];return this.props.selected&&!this.state.editMode&&(e=[f.ReactBEM.createElement(h.default,{onStart:this._onRotationKnobDragStart,onDrag:this._onRotationKnobDrag,onStop:this._onRotationKnobDragStop},f.ReactBEM.createElement('div',{bem:'e:knob m:rotate $b:knob',style:this._getRotationKnobStyle()},f.ReactBEM.createElement('img',{bem:'e:icon m:larger',src:this._getAssetPath('controls/knobs/rotate.png',!0)}))),f.ReactBEM.createElement(h.default,{onStart:this._onResizeKnobDragStart,onDrag:this._onResizeKnobDrag,onStop:this._onResizeKnobDragStop},f.ReactBEM.createElement('div',{bem:'e:knob m:resize $b:knob',style:this._getResizeKnobStyle()},f.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-up.png',!0)})))]),e},t.prototype._renderItem=function(){var e=this._getItemContainerStyle(),t=f.ReactBEM.createElement('textarea',{bem:'e:content',ref:'textarea',style:this._getTextStyle(),value:this.state.text,disabled:!this.state.editMode,onChange:this._onTextChange});return f.ReactBEM.createElement('bem',{specifier:'e:text'},f.ReactBEM.createElement('div',{bem:'e:container',style:e},t))},t.prototype._renderSelectedOverlay=function(){var e=this._getTextStyle(),t=[];this.props.selected&&t.push('is-selected'),this.state.editMode&&t.push('is-disabled'),t=t.join(' ');var o=this._getItemContainerStyle();return o.height=e.height,f.ReactBEM.createElement('bem',{specifier:'e:text'},f.ReactBEM.createElement(h.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected||this.props.selected&&this.state.editMode},f.ReactBEM.createElement('div',{bem:'e:selectedOverlay',onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:o,className:t})))},t.prototype.renderWithBEM=function(){return f.ReactBEM.createElement('bem',{specifier:'b:spritesCanvasControls'},f.ReactBEM.createElement('div',{bem:'$e:item e:container'},this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))},t}(k.default);t.default=v,v.contextTypes=k.default.contextTypes},function(e,t,o){'use strict';function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var p=o(0),c=s(p),m=o(2),_=s(m),u=o(3),g=s(u),f=o(1),y=o(11),h=s(y),b=o(67),k=s(b),v=function(e){function t(){(0,c.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var a=(0,_.default)(this,e.call.apply(e,[this].concat(i)));return a._bindAll('_onRotateKnobDragStart','_onRotateKnobDrag','_onRotateKnobDragStop'),a._id=f.SDKUtils.getUUID(),a}return(0,g.default)(t,e),t.prototype._onKnobDragStart=function(e){var t=this.props.sprite;'bottom'===e?this._initialPosition=this._getBottomDragKnobPosition():'top'===e?this._initialPosition=this._getTopDragKnobPosition():void 0,this._initialDimensions=t.getDimensions().clone(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onKnobDrag=function(e,t){var o=this.props.sprite,s=this._getAbsoluteSpritePosition(),p=this._initialPosition.clone().add(t),c=p.clone().subtract(s),m=this._initialPosition.clone().subtract(s);if(this.props.options.fixedRatio){var _=this._getStickerDimensions().divide(2).abs(),u=this._initialPosition.clone().subtract(s),g;'bottom'===e?g=i(c.y,c.x)-i(_.y,_.x):'top'===e?g=i(c.y,c.x)-i(-_.y,-_.x):void 0;var y=this._initialDimensions.clone().multiply(c.len()/u.len()),h=this.props.options,b=h.snapRotation,k=h.snapRotationTolerance,v=d(180*g/n),E=d(v/b)*b;l(v-E)<k&&(g=E*n/180),o.set({dimensions:y,rotation:g})}else{var S=this.context.editor.zoom.get(),M=o.getRotation(),C=a(-1*M),B=r(-1*M),R=new f.Vector2(c.x*C-c.y*B,c.x*B+c.y*C),x=new f.Vector2(m.x*C-m.y*B,m.x*B+m.y*C),T;'bottom'===e?T=R.clone().subtract(x):'top'===e?T=x.clone().subtract(R):void 0;var P=this._initialDimensions.clone().add(T.clone().divide(S).multiply(2));o.set({dimensions:P})}},t.prototype._onKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onRotateKnobDragStart=function(){this._initialPosition=this._getRotateKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onRotateKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onRotateKnobDrag=function(e){var t=this.props.sprite,o=this._getAbsoluteSpritePosition(),r=this._initialPosition.clone().add(e),a=this._getStickerDimensions().divide(2),n=r.clone().subtract(o),s;s=i(n.y,n.x)-i(-a.y,a.x),t.set({rotation:s})},t.prototype._getBottomDragKnobStyle=function(){var e=this._getBottomDragKnobPosition();return{left:e.x,top:e.y}},t.prototype._getTopDragKnobStyle=function(){var e=this._getTopDragKnobPosition();return{left:e.x,top:e.y}},t.prototype._getRotateKnobStyle=function(){var e=this._getRotateKnobPosition();return{left:e.x,top:e.y}},t.prototype._getStickerStyle=function(){var e=this.props.sprite,t=this._getStickerDimensions().abs(),o=this._getAbsoluteSpritePosition().subtract(t.clone().divide(2)),i=180*e.getRotation()/n,r='rotate('+i.toFixed(2)+'deg)',a=e.getDimensions(),s=e.getFlipVertically();0>a.y&&(s=!s),s&&(r+=' scaleY(-1)');var l=e.getFlipHorizontally();return 0>a.x&&(l=!l),l&&(r+=' scaleX(-1)'),{top:o.y,left:o.x,width:t.x,height:t.y,WebkitTransform:r,msTransform:r,MozTransform:r,OTransform:r}},t.prototype._getStickerDimensions=function(){var e=this.props.sprite,t=this.context.editor;return e.getDimensions().clone().multiply(t.zoom.get())},t.prototype._getRotateKnobPosition=function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),o=e.getRotation(),i=r(o||0),n=a(o||0),s=this._getStickerDimensions().divide(2);return t.clone().add(s.x*n+s.y*i,s.x*i-s.y*n)},t.prototype._getBottomDragKnobPosition=function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),o=e.getRotation(),i=r(o||0),n=a(o||0),s=this._getStickerDimensions().divide(2);return t.clone().add(s.x*n-s.y*i,s.x*i+s.y*n)},t.prototype._getTopDragKnobPosition=function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),o=e.getRotation(),i=r(o||0),n=a(o||0),s=this._getStickerDimensions(e).divide(2);return t.clone().subtract(s.x*n-s.y*i,s.x*i+s.y*n)},t.prototype._renderKnobs=function(){var e=[];return this.props.selected&&(e=[f.ReactBEM.createElement(h.default,{onStart:this._onKnobDragStart.bind(this,'bottom'),onStop:this._onKnobDragStop.bind(this,'bottom'),onDrag:this._onKnobDrag.bind(this,'bottom')},f.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getBottomDragKnobStyle()},f.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)}))),f.ReactBEM.createElement(h.default,{onStart:this._onKnobDragStart.bind(this,'top'),onStop:this._onKnobDragStop.bind(this,'top'),onDrag:this._onKnobDrag.bind(this,'top')},f.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getTopDragKnobStyle()},f.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/resize-diagonal-down.png',!0)})))],!this.props.options.fixedRatio&&e.push(f.ReactBEM.createElement(h.default,{onStart:this._onRotateKnobDragStart,onStop:this._onRotateKnobDragStop,onDrag:this._onRotateKnobDrag},f.ReactBEM.createElement('div',{bem:'e:knob $b:knob',style:this._getRotateKnobStyle()},f.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/knobs/rotate.png',!0)}))))),e},t.prototype._renderSVGFilter=function(){var e=this.props.sprite,t=e.getAdjustments(),o=t.getBrightness(),i=t.getSaturation(),r=t.getContrast(),a='<filter id=\'pesdk-sticker-'+this._id+'-filter\'>\n        <feComponentTransfer>\n          <feFuncR type=\'linear\' intercept=\''+o+'\' />\n          <feFuncG type=\'linear\' intercept=\''+o+'\' />\n          <feFuncB type=\'linear\' intercept=\''+o+'\' />\n        </feComponentTransfer>\n        <feColorMatrix type=\'saturate\' values=\''+i+'\' />\n        <feComponentTransfer>\n          <feFuncR type=\'linear\' slope=\''+r+'\' intercept=\''+(-(0.5*r)+0.5)+'\' />\n          <feFuncG type=\'linear\' slope=\''+r+'\' intercept=\''+(-(0.5*r)+0.5)+'\' />\n          <feFuncB type=\'linear\' slope=\''+r+'\' intercept=\''+(-(0.5*r)+0.5)+'\' />\n        </feComponentTransfer>\n      </filter>';return f.ReactBEM.createElement('svg',{width:'0',height:'0',"color-interpolation-filters":'sRGB',is:'svg'},f.ReactBEM.createElement('defs',{key:Math.random(),dangerouslySetInnerHTML:{__html:a}}))},t.prototype._renderSelectedOverlay=function(){var e=[];this.props.selected&&e.push('is-selected'),e=e.join(' ');var t=this._getStickerStyle();return f.ReactBEM.createElement('bem',{specifier:'e:text'},f.ReactBEM.createElement(h.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected},f.ReactBEM.createElement('div',{bem:'e:selectedOverlay',onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:t,className:e})))},t.prototype._renderItem=function(){var e=this.props.sprite,t=this._getStickerStyle(),o=window.location.href.replace(window.location.hash,''),i={filter:'url("'+o+'#pesdk-sticker-'+this._id+'-filter")'},r={width:t.width,height:t.height};return f.ReactBEM.createElement('bem',{specifier:'e:sticker'},f.ReactBEM.createElement('div',{bem:'e:container',style:t},f.ReactBEM.createElement('svg',{width:parseInt(t.width),height:parseInt(t.height),"color-interpolation-filters":'sRGB',is:'svg',style:r,preserveAspectRatio:'none'},f.ReactBEM.createElement('image',{xlinkHref:e.getImage().src,width:t.width,height:t.height,style:i,preserveAspectRatio:'none'}))))},t.prototype.renderWithBEM=function(){return f.ReactBEM.createElement('bem',{specifier:'b:spritesCanvasControls'},f.ReactBEM.createElement('div',{bem:'$e:item e:container'},this._renderSVGFilter(),this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))},t}(k.default);t.default=v,v.contextTypes=k.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(67),m=i(c),_=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.props.sprite.getCanvas();this._appendCanvas(t)},t.prototype.componentWillReceiveProps=function(e){if(e.sprite!==this.props.sprite){var t=this.props.sprite.getCanvas();t.parentNode.removeChild(t);var o=e.sprite.getCanvas();this._appendCanvas(o)}},t.prototype._isSelected=function(){return this.getSharedState('brush')===this.props.sprite},t.prototype._appendCanvas=function(e){var t=this.context.editor,o=t.getOutputDimensions();e.style.width=o.x+'px',e.style.height=o.y+'px',this.refs.brush.appendChild(e)},t.prototype.renderWithBEM=function(){var e=this._isSelected()?'is-selected':null;return p.ReactBEM.createElement('bem',{specifier:'b:spritesCanvasControls'},p.ReactBEM.createElement('div',{bem:'$e:item e:container m:full',ref:'container'},p.ReactBEM.createElement('div',{bem:'$e:brush',className:e,ref:'brush'})))},t}(m.default);t.default=_,_.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._onFlipClick=function(t,o){o.preventDefault(),o.stopPropagation(),this.props.onFlip&&this.props.onFlip(t)},t.prototype._onTakeToFrontClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()},t.prototype._onRemoveClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onRemove&&this.props.onRemove()},t.prototype._renderItems=function(){return[p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onFlipClick.bind(this,'h')},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/flip-h.png',!0)})),p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onFlipClick.bind(this,'v')},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/flip-v.png',!0)})),p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onTakeToFrontClick.bind(this)},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/take-to-front.png',!0)})),p.ReactBEM.createElement('div',{bem:'$e:separator'}),p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onRemoveClick.bind(this)},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/remove.png',!0)}))]},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:spritesControlsOverlay'},this._renderItems())},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(10),m=i(c),_=o(245),u=i(_),g=o(247),f=i(g),y=o(98),h=i(y),b=p.SDK.Operations.SpriteOperation,k=b.TextSprite,v=b.BrushSprite,E=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState('operation');this.getSharedState('skipHistory')||e.history.add(t,this.getSharedState('initialOptions'),this.getSharedState('operationExistedBefore')),t.setEnabled(!0),e.zoom.restore(),e.features.enable('zoom','drag'),e.render()},t.onEnter=function(e,t){var o=this.context,i=o.editor,r=o.ui,a=i.operations.exists('sprite'),n=i.operations.getOrCreate('sprite'),s=n.getSprites(),l=n.serializeOptions(),d=new h.default(r,t),p=d.getDefaultVariation();this.setSharedState({operationExistedBefore:a,operation:n,sprites:s,initialOptions:l,fontManager:d,defaultFontVariation:p,fonts:d.getFonts()}),i.zoom.save(),n.setEnabled(!1),i.render()},t.clickAtPosition=function(e,t){if(!t.operations.exists('sprite'))return!1;var o=t.operations.getOrCreate('sprite'),i=o.getSpritesAtPosition(e,t.getOutputTextureDimensions()).filter(function(e){return!(e instanceof v)});return i.length&&i[0]instanceof k&&{selectedSprite:i[0]}},t.isAvailable=function(e){return e.isToolAllowed('text')&&e.isToolEnabled('text')},t.getPreloadAssets=function(){return['controls/text/align_left.png','controls/text/align_right.png','controls/text/align_center.png','controls/text/minus.png','controls/text/plus.png']},t}(m.default);E.controlsComponent=f.default,E.canvasControlsComponent=u.default,E.identifier='text',E.iconPath='controls/overview/text.png',E.languageKey='controls.overview.text',E.defaultOptions={fonts:[],replaceFonts:!1,availableVariations:null},t.default=E},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(38),m=i(c),_=o(246),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onTextEdit'),n}return(0,d.default)(t,e),t.prototype._onItemBlur=function(){var e=this.getSharedState('selectedSprite');e&&''===e.getText()&&(e.setText(this._t('controls.text.defaultText')),e._edited=!1)},t.prototype._onSpriteRemove=function(){e.prototype._onSpriteRemove.call(this),this.props.onSwitchControls('home')},t.prototype._onTextEdit=function(){var e=this.getSharedState('selectedSprite');this.refs['sprite-'+e.getId()].enterEditMode()},t.prototype._renderOverlayControls=function(){return this.getSharedState('selectedSprite')?p.ReactBEM.createElement(u.default,{onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove,onEdit:this._onTextEdit}):void 0},t}(m.default);t.default=g,g.contextTypes=m.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._onEditClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onEdit&&this.props.onEdit()},t.prototype._onTakeToFrontClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()},t.prototype._onRemoveClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onRemove&&this.props.onRemove()},t.prototype._renderItems=function(){var e=[p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onTakeToFrontClick.bind(this)},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/take-to-front.png',!0)}))];return p.Utils.isTouchDevice()&&(e=e.concat([p.ReactBEM.createElement('div',{bem:'$e:separator'}),p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onEditClick.bind(this)},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/edit.png',!0)}))])),e=e.concat([p.ReactBEM.createElement('div',{bem:'$e:separator'}),p.ReactBEM.createElement('div',{bem:'$e:item',onClick:this._onRemoveClick.bind(this)},p.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/remove.png',!0)}))]),e},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',{bem:'$b:spritesControlsOverlay'},this._renderItems())},t}(p.BaseComponent);t.default=c,c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),p=i(l),c=o(3),m=i(c),_=o(1),u=o(9),g=i(u),f=o(6),y=i(f),h=o(68),b=i(h),k=o(15),v=i(k),E=o(97),S=i(E),M=o(252),C=i(M),B=o(5),R=i(B),x=['left','center','right'],T=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,p.default)(this,e.call.apply(e,[this].concat(i)));n._bindAll('_onFontSizeChange','_onFontChange','_onAlignmentClick','_onTakeToFrontClick','_onForegroundColorChange','_onBackgroundColorChange','_onBeforeHistoryUndo'),n._events=(0,a.default)({},_.Constants.EVENTS.HISTORY_BEFORE_UNDO,n._onBeforeHistoryUndo),n._operation=n.getSharedState('operation'),n._fontLoader=n.context.ui.getFontLoader(),n._fontLoader.setFonts(n.getSharedState('fonts')),n.state={mode:null,loading:!0};var l=n.context.editor;return l.render(),n._fonts=n.getSharedState('fonts'),n}return(0,m.default)(t,e),t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set('auto',function(){o.features.disable('zoom','drag')});var i=function(){t._createText(),t.setState({loading:!1})};this._fontLoader.needsToLoad()?this._loadFonts().then(i.bind(this)):i()},t.prototype._loadFonts=function(){var e=this,t=R.default.instance.displayLoading(this._t('loading.loading'));return this._fontLoader.load().then(function(){t.close()}).catch(function(){t.close(),R.default.instance.displayWarning(e._t('errors.loadingFontsFailed.title'),e._t('errors.loadingFontsFailed.text'))})},t.prototype._createText=function(){var e=this.context.editor,t=this.getSharedState('selectedSprite'),o=this.getSharedState('operation'),i=this.getSharedState('defaultFontVariation'),r=e.getOutputDimensions();if(!t){var a=e.getSDK(),n=a.getRenderer(),s=n.getMaxTextureSize(),l=o.createText({fontIdentifier:i.getIdentifier(),text:this._t('controls.text.defaultText'),position:new _.Vector2(0.5,0.5),pivot:new _.Vector2(0.5,0.5),maxWidth:0.5,maxHeight:s?s/r.y:3,fontSize:0.08,fontFamily:i.getFont().getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle(),alignment:'center'});o.addSprite(l),this.setSharedState({selectedSprite:l})}},t.prototype._onBeforeHistoryUndo=function(e){var t=e.operation,o=e.options;if(t===this.getSharedState('operation')){var i=o.sprites;-1===i.indexOf(this.getSharedState('selectedSprite'))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls('home'))}},t.prototype._onBackClick=function(){var e=this.context.editor;e.render(),this._backButtonClicked=!0,this.props.onSwitchControls('home')},t.prototype.sharedStateDidChange=function(e){'selectedSprite'in e&&this.forceUpdate()},t.prototype._onFontSizeChange=function(e){var t=this.context.editor.getOutputDimensions(),o=this.getSharedState('selectedSprite');o.setFontSize(e/t.y),this.forceUpdate()},t.prototype._onFontChange=function(e){var t=this.getSharedState('selectedSprite');t.setFontFamily(e.getFont().getFontFamily()),t.setFontWeight(e.getFontWeight()),t.setFontStyle(e.getFontStyle()),t.setFontIdentifier(e.getIdentifier()),this.forceUpdate()},t.prototype._onAlignmentClick=function(){var e=this.getSharedState('selectedSprite'),t=e.getAlignment(),o=x.indexOf(t),i=(o+1)%x.length,r=x[i];e.setAlignment(r),this.forceSharedUpdate()},t.prototype._onTakeToFrontClick=function(){var e=this.getSharedState('operation');e.takeSpriteToFront(this.getSharedState('selectedSprite')),this.forceSharedUpdate()},t.prototype._onForegroundColorChange=function(e){var t=this.getSharedState('selectedSprite');t.setColor(e)},t.prototype._onBackgroundColorChange=function(e){var t=this.getSharedState('selectedSprite');t.setBackgroundColor(e)},t.prototype._switchToMode=function(e){e===this.state.mode&&(e=null),this.setState({mode:e})},t.prototype.renderOverlayControls=function(){switch(this.state.mode){case'size':return this._renderFontSizeOverlayControl();case'font':return this._renderFontFamilyOverlayControl();default:return null;}},t.prototype._renderFontSizeOverlayControl=function(){var e=this.getSharedState('selectedSprite');if(e){var t=this.context.editor,o=t.getOutputDimensions(),i=d(o.y),r=d(e.getFontSize()*o.y);return _.ReactBEM.createElement(v.default,{value:r,minValue:0.05*o.y,maxValue:i,label:this._t('controls.text.size'),onChange:this._onFontSizeChange})}},t.prototype._renderSizeItem=function(){var e=this.getSharedState('selectedSprite');if(e){var t=this.context.editor.getOutputDimensions(),o=e.getFontSize(),i='size'===this.state.mode?'is-active':null;return _.ReactBEM.createElement('li',{bem:'e:item',key:'size'},_.ReactBEM.createElement('bem',{specifier:'$b:controls'},_.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:i,"data-identifier":'fontSize',onClick:this._switchToMode.bind(this,'size')},_.ReactBEM.createElement('div',{bem:'b:fontSize e:text'},d(o*t.y)),_.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.size')))))}},t.prototype._renderFontFamilyOverlayControl=function(){var e=this.getSharedState('selectedSprite');return e?_.ReactBEM.createElement(C.default,{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle(),fonts:this._fonts,onChange:this._onFontChange}):void 0},t.prototype._renderFontItem=function(){var e=this.getSharedState('selectedSprite');if(e){var t='font'===this.state.mode?'is-active':null;return _.ReactBEM.createElement('li',{bem:'e:item',key:'font'},_.ReactBEM.createElement('bem',{specifier:'$b:controls'},_.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:t,"data-identifier":'font',onClick:this._switchToMode.bind(this,'font')},_.ReactBEM.createElement(S.default,{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle()}),_.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.font')))))}},t.prototype._renderAlignmentItem=function(){var e=this.getSharedState('selectedSprite');if(e){var t=e.getAlignment();return _.ReactBEM.createElement('li',{bem:'e:item',key:'alignment'},_.ReactBEM.createElement('bem',{specifier:'$b:controls'},_.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',onClick:this._onAlignmentClick,"data-identifier":'alignment'},_.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/text/align_'+t+'.png',!0)}),_.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.alignment')))))}},t.prototype._renderTakeToFrontItem=function(){return _.ReactBEM.createElement('li',{bem:'e:item',key:'takeToFront'},_.ReactBEM.createElement('bem',{specifier:'$b:controls'},_.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',onClick:this._onTakeToFrontClick},_.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/sprites/take_to_front.png',!0)}),_.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.text.takeToFront')))))},t.prototype.renderControls=function(){if(this.state.loading)return _.ReactBEM.createElement('div',null);var e=[this._renderSizeItem(),this._renderFontItem(),this._renderAlignmentItem()],t=this.getSharedState('selectedSprite'),o=t.getColor().clone(),i=t.getBackgroundColor().clone();return[_.ReactBEM.createElement('div',{bem:'e:cell m:list'},_.ReactBEM.createElement(y.default,{ref:'scrollbar'},_.ReactBEM.createElement('ul',{bem:'$e:list'},e))),_.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},_.ReactBEM.createElement(b.default,{initialValue:o,label:this._t('controls.text.foreground'),onChange:this._onForegroundColorChange})),_.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},_.ReactBEM.createElement(b.default,{initialValue:i,label:this._t('controls.text.background'),onChange:this._onBackgroundColorChange}))]},t}(g.default);t.default=T,T.contextTypes=g.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),l=i(n),s=o(3),d=i(s),p=o(1),c=o(249),m=i(c),_=o(250),u=i(_),g=o(251),f=i(g),y=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,l.default)(this,e.call.apply(e,[this].concat(i)));n._value=n.props.initialValue.clone();var d=n._value.toHSV(),p=d[0],c=d[1],m=d[2];return n._hsv={h:p,s:c,v:m},n._bindAll('_onElementClick','_onColorChange','_onDocumentClick'),n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),document.addEventListener('click',this._onDocumentClick)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),document.removeEventListener('click',this._onDocumentClick)},t.prototype._onDocumentClick=function(t){for(var e=t.target;e;e=e.parentNode)if(e===this.refs.root)return;this.props.onClose&&this.props.onClose()},t.prototype._onElementClick=function(t){t.stopPropagation()},t.prototype._onColorChange=function(e){this._value=e,this.props.onChange&&this.props.onChange(e)},t.prototype.renderWithBEM=function(){var e;return!1!==this.props.alpha&&(e=p.ReactBEM.createElement(m.default,{initialValue:this._value,onChange:this._onColorChange})),p.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:overlay',onClick:this._onElementClick,ref:'root'},e,p.ReactBEM.createElement('div',{bem:'e:bottom'},p.ReactBEM.createElement(u.default,{initialValue:this._value,onChange:this._onColorChange}),p.ReactBEM.createElement(f.default,{initialValue:this._value,onChange:this._onColorChange})))},t}(p.BaseComponent);t.default=y,y.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),m=o(1),_=o(11),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onKnobDrag','_onKnobDragStart'),n._value=n.props.initialValue.clone(),n._transparentPatternCanvas=m.Utils.createTransparentPatternCanvas(),n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.shouldComponentUpdate=function(e){var t=e.initialValue;return t!==this._value&&(this._value=t.clone(),this._renderCanvas(),!0)},t.prototype._onKnobDragStart=function(t,o){o.target===this.refs.knob?this._initialAlpha=this._value.a:this._setAlphaFromPosition(t)},t.prototype._onKnobDrag=function(e){var t=this.refs.canvas,o=t.offsetWidth,i=e.x/o;this._setAlpha(this._initialAlpha+i)},t.prototype._getKnobStyle=function(){return{left:(100*this._value.a).toFixed(2)+'%',top:'50%'}},t.prototype._setAlpha=function(e){this._value.a=e,this._value.a=p(1,c(0,this._value.a)),this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},t.prototype._setAlphaFromPosition=function(e){var t=this.refs.canvas;this._initialAlpha=e.x/t.offsetWidth,this._setAlpha(this._initialAlpha)},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext('2d');e.width=e.offsetWidth,e.height=e.offsetHeight;var o=t.createPattern(this._transparentPatternCanvas,'repeat');t.fillStyle=o,t.fillRect(0,0,e.width,e.height);var i=t.createLinearGradient(0,0,e.width,e.height),r=this._value.clone();r.a=0,i.addColorStop(0,r.toRGBA()),i.addColorStop(1,this._value.toHex()),t.fillStyle=i,t.fillRect(0,0,e.width,e.height)},t.prototype.renderWithBEM=function(){return m.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:alpha'},m.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},m.ReactBEM.createElement('div',null,m.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),m.ReactBEM.createElement('div',{bem:'e:knob $b:knob m:transparent',ref:'knob',style:this._getKnobStyle()}))))},t}(m.BaseComponent);t.default=g,g.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),l=i(n),s=o(3),d=i(s),m=o(1),_=o(11),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,l.default)(this,e.call.apply(e,[this].concat(i)));n._bindAll('_onKnobDrag','_onKnobDragStart'),n._value=n.props.initialValue.clone();var d=n._value.toHSV(),p=d[0],c=d[1],m=d[2];return n._hsvColor={h:p,s:c,v:m},n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.shouldComponentUpdate=function(e){var t=e.initialValue;if(t!==this._value){this._value=t.clone();var o=this._value.toHSV(),i=o[0],r=o[1],a=o[2];return this._hsvColor={h:i,s:r,v:a},this._renderCanvas(),!0}return!1},t.prototype._onKnobDragStart=function(t,o){o.target===this.refs.knob?(this._initialValue=this._hsvColor.v,this._initialSaturation=this._hsvColor.s):this._setValuesFromPosition(t)},t.prototype._onKnobDrag=function(e){var t=this.refs.canvas,o=t.offsetWidth,i=t.offsetHeight,r=e.x/o,a=-1*(e.y/i),n=this._hsvColor.h;this._setHSV(n,this._initialSaturation+r,this._initialValue+a)},t.prototype._getKnobStyle=function(){var e=this._hsvColor,t=e.s,o=e.v;return{left:(100*t).toFixed(2)+'%',top:(100*(1-o)).toFixed(2)+'%'}},t.prototype._setHSV=function(e,t,o){t=c(0.01,p(t,0.99)),o=c(0.01,p(o,0.99)),this._value=m.Color.fromHSV(e,t,o,this._value.a),this._hsvColor={h:e,s:t,v:o},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},t.prototype._setValuesFromPosition=function(e){var t=this.refs.canvas;this._initialSaturation=e.x/t.offsetWidth,this._initialValue=1-e.y/t.offsetHeight;var o=this._hsvColor.h;this._setHSV(o,this._initialSaturation,this._initialValue)},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext('2d');e.width=e.offsetWidth,e.height=e.offsetHeight;for(var o=t.getImageData(0,0,e.width,e.height),i=0,n;i<e.height;i++){n=(e.height-i)/e.height;for(var s=0;s<e.width;s++){var l=s/e.width,d=m.Color.fromHSV(this._hsvColor.h,l,n),p=d.r,r=d.g,c=d.b,_=d.a,a=4*(i*e.width+s);o.data[a]=255*p,o.data[a+1]=255*r,o.data[a+2]=255*c,o.data[a+3]=255*_}}t.putImageData(o,0,0)},t.prototype.renderWithBEM=function(){return m.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:saturation'},m.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},m.ReactBEM.createElement('div',null,m.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),m.ReactBEM.createElement('div',{bem:'e:knob $b:knob m:transparent',ref:'knob',style:this._getKnobStyle()}))))},t}(m.BaseComponent);t.default=g,g.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),l=i(n),s=o(3),d=i(s),m=o(1),_=o(11),u=i(_),g=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,l.default)(this,e.call.apply(e,[this].concat(i)));n._bindAll('_onKnobDrag','_onKnobDragStart'),n._value=n.props.initialValue.clone();var d=n._value.toHSV(),p=d[0],c=d[1],m=d[2];return n._hsvColor={h:p,s:c,v:m},n.state={value:n.props.initialValue},n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.shouldComponentUpdate=function(e){var t=e.initialValue;if(t!==this._value){this._value=t.clone();var o=this._value.toHSV(),i=o[0],r=o[1],a=o[2];return this._hsvColor={h:i,s:r,v:a},this._renderCanvas(),!0}return!1},t.prototype._onKnobDragStart=function(t,o){o.target===this.refs.knob?this._initialHue=this._hsvColor.h:this._setValueFromPosition(t)},t.prototype._onKnobDrag=function(e){var t=this.refs.canvas,o=t.offsetHeight,i=e.y/o;this._setHue(this._initialHue+i)},t.prototype._getKnobStyle=function(){return{left:'50%',top:(100*this._hsvColor.h).toFixed(2)+'%'}},t.prototype._setHue=function(e){var t=this._hsvColor,o=t.s,i=t.v;e=p(1,c(0,e)),o=c(0.01,p(o,0.99)),i=c(0.01,p(i,0.99)),this._value=m.Color.fromHSV(e,o,i,this._value.a),this._hsvColor={h:e,s:o,v:i},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},t.prototype._setValueFromPosition=function(e){var t=this.refs.canvas;this._initialHue=e.y/t.offsetHeight,this._setHue(this._initialHue)},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext('2d');e.width=e.offsetWidth,e.height=e.offsetHeight;for(var o=0;o<e.height;o++){var i=o/e.height,r=m.Color.fromHSV(i,1,1);t.strokeStyle=r.toRGBA(),t.beginPath(),t.moveTo(0,o),t.lineTo(e.width,o),t.stroke()}},t.prototype.renderWithBEM=function(){return m.ReactBEM.createElement('div',{bem:'$b:colorPicker $e:hue'},m.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},m.ReactBEM.createElement('div',null,m.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),m.ReactBEM.createElement('div',{bem:'e:knob $b:knob m:transparent',ref:'knob',style:this._getKnobStyle()}))))},t}(m.BaseComponent);t.default=g,g.contextTypes=m.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(6),m=i(c),_=o(97),u=i(_),g=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._onListItemClick=function(e){this.props.onChange&&this.props.onChange(e)},t.prototype._renderListItems=function(){var e=this,t=this.props.fonts;return t.map(function(t){var o=e.props.selectedIdentifier;return t.getVariations().map(function(i){var r=o===i.getIdentifier(),a=r?'is-active':null;return p.ReactBEM.createElement('li',{bem:'e:item',key:i.getIdentifier(),className:a,onClick:e._onListItemClick.bind(e,i)},p.ReactBEM.createElement(u.default,{fontFamily:i.getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle()}),p.ReactBEM.createElement('div',{bem:'e:label'},t.getFontFamily()))})})},t.prototype.renderWithBEM=function(){var e=this._renderListItems();return p.ReactBEM.createElement('div',{bem:'$b:controls e:overlay m:dark m:large'},p.ReactBEM.createElement(m.default,null,p.ReactBEM.createElement('ul',{bem:'$b:fontFamily e:list'},e)))},t}(p.BaseComponent);t.default=g,g.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=p.SDK.OptionType,m=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t}(p.SDK.Configurable);t.default=m,m.prototype.availableOptions={fontFamily:{type:c.STRING,required:!0},variations:{type:c.ARRAY,required:!0}}},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),m=o(10),_=i(m),u=o(255),g=i(u),f=o(257),y=i(f),h=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState('operation');t.setEnabled(!0),e.zoom.restore(),e.features.enable('zoom','drag'),e.render()},t.onEnter=function(e,t){var o=this.context.editor;o.zoom.save(),o.zoom.set('auto',function(){a.setEnabled(!1),o.render()});var i=o.getOutputDimensions(),r=o.operations.exists('sprite'),a=o.operations.getOrCreate('sprite'),n=a.createBrush(),s=a.serializeOptions(void 0,!0);a.addSprite(n);var l=c(0.05*i.min(),1);t.sizePresets&&0<t.sizePresets.length&&(l=t.sizePresets[0]);var d=new p.Color(1,0,0,1);this.setSharedState({operationExistedBefore:r,operation:a,brush:n,initialOptions:s,size:l,color:d,hardness:1})},t.isAvailable=function(e){return e.isToolAllowed('brush')&&e.isToolEnabled('brush')},t.getPreloadAssets=function(){return[]},t}(_.default);h.controlsComponent=g.default,h.canvasControlsComponent=y.default,h.identifier='brush',h.iconPath='controls/overview/brush.png',h.languageKey='controls.overview.brush',h.defaultOptions={sizePresets:[]},t.default=h},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),p=i(l),m=o(3),_=i(m),u=o(1),g=o(9),f=i(g),y=o(37),h=i(y),b=o(6),k=i(b),v=o(68),E=i(v),S=o(256),M=i(S),C=function(e){function t(){var o;(0,s.default)(this,t);for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];var l=(0,p.default)(this,e.call.apply(e,[this].concat(r)));return l._hasDoneButton=!1,l._brushOptions={size:l.getSharedState('size'),color:l.getSharedState('color').clone()},l._hasPresets=l.props.options.sizePresets&&0<l.props.options.sizePresets.length,l._hasSlider=!l._hasPresets,l._bindAll('_onSizeUpdated','_onColorUpdated','_onOperationUpdated','_onOperationRemoved'),l.state={sizeControlsEnabled:!1},l._events=(o={},(0,a.default)(o,u.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),(0,a.default)(o,u.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),o),l}return(0,_.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.editor;t.zoom.set('auto'),t.features.disable('zoom','drag')},t.prototype._onSizeClick=function(e){this._onSizeUpdated(e),this.forceUpdate()},t.prototype._onOperationRemoved=function(e){if(e===this.getSharedState('operation')&&!this._backButtonClicked){var t=this.context.editor,o=t.operations.getOrCreate('sprite'),i=o.createBrush();o.addSprite(i),this.setSharedState({operation:o,brush:i,operationExistedBefore:!1,initialOptions:{}}),t.render()}},t.prototype._onOperationUpdated=function(e){var t=this;if(e===this.getSharedState('operation')){var o=this.getSharedState('brush');if(o){var i=e.getSprites().filter(function(e){return e.getId()===o.getId()})[0];this.setSharedState({brush:i})}e.setEnabled(!0),this.context.editor.render(function(){e.setEnabled(!1),t.context.editor.render()})}},t.prototype._onSizeUpdated=function(e){this.setSharedState({size:e}),this._brushOptions.size=e},t.prototype._onColorUpdated=function(e){this.setSharedState({color:e}),this._brushOptions.color=e.clone()},t.prototype._renderSizeItems=function(){var e=this,t=this.props.options.sizePresets,o=c.apply(null,t);return t.map(function(t){var i=e.getSharedState('size')===t;return u.ReactBEM.createElement(M.default,{size:t,maxSize:o,active:i,key:t,onClick:e._onSizeClick.bind(e,t)})})},t.prototype.renderControls=function(){var e=this.context.editor,t=e.zoom.get(),o=[];if(this._hasSlider){var i=e.getFinalDimensions(),r=d(i.clone().multiply(t).min()/2),a=this._brushOptions.size;o.push(u.ReactBEM.createElement('div',{bem:'e:cell m:slider'},u.ReactBEM.createElement(h.default,{style:'large',minValue:1,maxValue:r,valueUnit:'px',middleDot:!1,label:this._t('controls.brush.size'),onChange:this._onSizeUpdated,value:a})))}else this._hasPresets&&o.push(u.ReactBEM.createElement('div',{bem:'e:cell m:list'},u.ReactBEM.createElement(k.default,null,u.ReactBEM.createElement('ul',{bem:'$e:list'},this._renderSizeItems()))));return o.push(u.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},u.ReactBEM.createElement(E.default,{initialValue:this._brushOptions.color.clone(),onChange:this._onColorUpdated}))),o},t}(f.default);t.default=C,C.contextTypes=f.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),s=o(2),l=i(s),d=o(3),p=i(d),c=o(1),m=function(e){function t(){return(0,a.default)(this,t),(0,l.default)(this,e.apply(this,arguments))}return(0,p.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.componentDidUpdate=function(){this._renderCanvas()},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext('2d');e.width=e.offsetWidth,e.height=e.offsetHeight;var o=this.props,i=o.maxSize,r=o.size,a=e.width*(r/i);t.fillStyle='white',t.beginPath(),t.arc(e.width/2,e.height/2,a/2,0,2*n),t.fill()},t.prototype.renderWithBEM=function(){return c.ReactBEM.createElement('bem',{specifier:'$b:controls $e:list'},c.ReactBEM.createElement('li',{bem:'e:item',onClick:this.props.onClick},c.ReactBEM.createElement('bem',{specifier:'$b:controls'},c.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:this.props.active?'is-active':null},c.ReactBEM.createElement('canvas',{bem:'e:canvas',ref:'canvas'}),c.ReactBEM.createElement('div',{bem:'e:label'},this.props.size)))))},t}(c.BaseComponent);t.default=m,m.contextTypes=c.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(38),u=i(_),g=m.SDK.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush,f=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,d.default)(this,e.call.apply(e,[this].concat(i)));return n._windowResized=!1,n._drawing=!1,n._bindAll('_onMouseEnter','_onMouseLeave','_onMouseDown','_onMouseMove','_onMouseUp','_onMouseMoveOnCanvas','_onWindowResize'),n._lastDrawPosition=null,n._events=m.SDKUtils.extend(n._events,(0,a.default)({},m.Constants.EVENTS.WINDOW_RESIZE,n._onWindowResize)),n.state={cursorVisible:!1,cursorPosition:new m.Vector2},n}return(0,c.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._updateContainerRect()},t.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)},t.prototype._onWindowResize=function(){this._windowResized=!0},t.prototype._onOperationRemoved=function(){},t.prototype._onOperationUpdated=function(e){e===this.getSharedState('operation')&&this.forceUpdate()},t.prototype._onMouseDown=function(t){t.preventDefault(),this._optionsBeforeDraw=this.getSharedState('operation').serializeOptions(),this._operationExistedBeforeDraw=this.getSharedState('operationExistedBefore'),this.setSharedState({operationExistedBefore:!0},!1);var e=this.context.editor.getOutputDimensions(),o=this._getCursorPosition(t),i=this.getSharedState('brush'),r=this.getSharedState('size')/e.min(),a=this.getSharedState('color'),n=this.getSharedState('hardness');this._drawing=!0;var s=new g({size:r,hardness:n,color:a});this._currentPath=i.createPath(s),this._currentPath.addControlPoint(o.clone().divide(e)),document.addEventListener('mousemove',this._onMouseMove),document.addEventListener('touchmove',this._onMouseMove),document.addEventListener('mouseup',this._onMouseUp),document.addEventListener('touchend',this._onMouseUp)},t.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var e=this.context.editor,t=e.getOutputTextureDimensions();this.getSharedState('brush').render(t),this._currentPath=null,this._drawing=!1,e.history.add(this.getSharedState('operation'),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener('mousemove',this._onMouseMove),document.removeEventListener('touchmove',this._onMouseMove),document.removeEventListener('mouseup',this._onMouseUp),document.removeEventListener('touchend',this._onMouseUp)},t.prototype._onMouseEnter=function(t){var e=this._getCursorPosition(t);this.setState({cursorVisible:!0,cursorPosition:e}),this._onMouseMove(t)},t.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1})},t.prototype._onMouseMove=function(t){var e=this.context.editor,o=e.getOutputDimensions(),i=e.getOutputTextureDimensions(),r=e.zoom.get(),a=this._getCursorPosition(t);this.setState({cursorPosition:a});var n;if(!this._lastDrawPosition)n=!0;else{var s=this.getSharedState('size'),l=this._lastDrawPosition.clone().subtract(a).abs().len()/r;n=l>=s/10}this._drawing&&n&&(this._currentPath.addControlPoint(a.clone().divide(o)),this.getSharedState('brush').render(i),this._lastDrawPosition=a.clone())},t.prototype._onMouseMoveOnCanvas=function(t){var e=this._getCursorPosition(t);this.setState({cursorPosition:e})},t.prototype._getCursorStyle=function(){var e=this.getSharedState('size'),t=this.getSharedState('color'),o=this.state.cursorPosition;return{left:o.x,top:o.y,width:e,height:e,background:t.toRGBA(),marginLeft:-0.5*e,marginTop:-0.5*e}},t.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()},t.prototype._getCursorPosition=function(e){var t=m.Utils.getEventPosition(e),o=this._containerBoundingRect;return t.subtract(o.left,o.top)},t.prototype._getContainerProps=function(){var t=e.prototype._getContainerProps.call(this);return t.onMouseDown=t.onTouchStart=this._onMouseDown,t},t.prototype._getInnerContainerProps=function(){var t=e.prototype._getInnerContainerProps.call(this);return delete t.onClick,t.onMouseEnter=this._onMouseEnter,t.onMouseLeave=this._onMouseLeave,t.onMouseMove=this._onMouseMoveOnCanvas,t},t.prototype._renderOverlayControls=function(){var e=this.state.cursorVisible?'is-visible':null;return m.ReactBEM.createElement('div',{bem:'$b:brushCanvasControls'},m.ReactBEM.createElement('div',{bem:'e:cursor',className:e,style:this._getCursorStyle()}))},t}(u.default);t.default=f,f.contextTypes=u.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(10),c=i(p),m=o(259),_=i(m),u=o(260),g=i(u),f=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState('operation');0===t.getPaths().length&&e.operations.remove(t),e.zoom.restore(),e.features.enable('zoom','drag'),e.render()},t.onEnter=function(){var e=this.context.editor;e.zoom.save(),e.zoom.set('auto',function(){e.render()});var t=e.getOutputDimensions(),o=e.operations.exists('selective-blur'),i=e.operations.getOrCreate('selective-blur'),r=i.serializeOptions(),a=i.getBrush(),n=0.1*t.min(),s=i.getInputDimensions();this.setSharedState({operationExistedBefore:o,operation:i,brush:a,initialOptions:r,size:n,hardness:1,inputDimensions:s})},t.isAvailable=function(e){return e.isToolEnabled('selective-blur')},t}(c.default);f.controlsComponent=_.default,f.canvasControlsComponent=g.default,f.identifier='selective-blur',f.iconPath='controls/overview/selective-blur.png',f.languageKey='controls.overview.selective-blur',f.defaultOptions={},t.default=f},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),c=i(l),m=o(3),_=i(m),u=o(1),g=o(9),f=i(g),y=o(37),h=i(y),b=o(15),k=i(b),v=function(e){function t(){var o;(0,s.default)(this,t);for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];var l=(0,c.default)(this,e.call.apply(e,[this].concat(r)));return l._hasDoneButton=!1,l._brushSize=l.getSharedState('size'),l._bindAll('_onOperationUpdated','_onOperationRemoved','_onSizeUpdated','_onBlurRadiusChange'),l.state={sizeControlsEnabled:!1},l._events=(o={},(0,a.default)(o,u.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),(0,a.default)(o,u.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),o),l}return(0,_.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.editor;t.zoom.set('auto'),t.features.disable('zoom','drag')},t.prototype._onOperationRemoved=function(e){if(e===this.getSharedState('operation')&&!this._backButtonClicked){var t=this.context.editor,o=t.operations.getOrCreate('selective-blur'),i=o.getBrush();this.setSharedState({operation:o,brush:i,operationExistedBefore:!1,initialOptions:{}}),t.render()}},t.prototype._onOperationUpdated=function(e){if(e===this.getSharedState('operation')){var t=this.context.editor;t.render(),this.forceUpdate()}},t.prototype._onSizeUpdated=function(e){this.setSharedState({size:e}),this._brushSize=e},t.prototype._onBlurRadiusChange=function(e,t){var o=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=this.getSharedState('inputDimensions');this.getSharedState('operation').setBlurRadius(e/i.min());var r=this.context.editor;r.render(),o&&r.history.add(this.getSharedState('operation'),{blurRadius:t/i.min()},!0)},t.prototype.renderOverlayControls=function(){var e=this.getSharedState('inputDimensions'),t=e.min(),o=this.getSharedState('operation').getBlurRadius()*t;return u.ReactBEM.createElement(k.default,{minValue:0,maxValue:p(180,d(0.1*t)),value:o,valueUnit:'px',label:this._t('controls.selectiveBlur.blurRadius'),onChange:this._onBlurRadiusChange})},t.prototype.renderControls=function(){var e=this.context.editor,t=e.zoom.get(),o=[],i=e.getFinalDimensions(),r=d(i.clone().multiply(t).min()/2),a=this._brushSize;return o.push(u.ReactBEM.createElement('div',{bem:'e:cell m:slider'},u.ReactBEM.createElement(h.default,{style:'large',minValue:1,maxValue:r,valueUnit:'px',middleDot:!1,label:this._t('controls.brush.size'),onChange:this._onSizeUpdated,value:a}))),o},t}(f.default);t.default=v,v.contextTypes=f.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),d=i(l),p=o(3),c=i(p),m=o(1),_=o(38),u=i(_),g=m.SDK.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush,f=function(e){function t(){(0,s.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,d.default)(this,e.call.apply(e,[this].concat(i)));return n._windowResized=!1,n._drawing=!1,n._bindAll('_onMouseEnter','_onMouseLeave','_onMouseDown','_onMouseMove','_onMouseUp','_onMouseMoveOnCanvas','_onWindowResize'),n._lastDrawPosition=null,n._events=m.SDKUtils.extend(n._events,(0,a.default)({},m.Constants.EVENTS.WINDOW_RESIZE,n._onWindowResize)),n.state={cursorVisible:!1,cursorPosition:new m.Vector2},n}return(0,c.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._updateContainerRect()},t.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)},t.prototype._onWindowResize=function(){this._windowResized=!0},t.prototype._onOperationRemoved=function(){},t.prototype._onOperationUpdated=function(e){e===this.getSharedState('operation')&&this.forceUpdate()},t.prototype._onMouseDown=function(t){t.preventDefault();var e=this.getSharedState('operation');this._optionsBeforeDraw=e.serializeOptions(),this._operationExistedBeforeDraw=this.getSharedState('operationExistedBefore'),this.setSharedState({operationExistedBefore:!0},!1);var o=this.context.editor.getOutputDimensions(),i=this._getCursorPosition(t),r=this.getSharedState('size')/o.min(),a=this.getSharedState('hardness');this._drawing=!0;var n=new g({size:r,hardness:a});this._currentPath=e.createPath(n),this._currentPath.addControlPoint(i.clone().divide(o)),document.addEventListener('mousemove',this._onMouseMove),document.addEventListener('touchmove',this._onMouseMove),document.addEventListener('mouseup',this._onMouseUp),document.addEventListener('touchend',this._onMouseUp)},t.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var e=this.context.editor;e.render(),this._currentPath=null,this._drawing=!1,e.history.add(this.getSharedState('operation'),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener('mousemove',this._onMouseMove),document.removeEventListener('touchmove',this._onMouseMove),document.removeEventListener('mouseup',this._onMouseUp),document.removeEventListener('touchend',this._onMouseUp)},t.prototype._onMouseEnter=function(t){var e=this._getCursorPosition(t);this.setState({cursorVisible:!0,cursorPosition:e}),this._onMouseMove(t)},t.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1})},t.prototype._onMouseMove=function(t){var e=this.context.editor,o=e.getOutputDimensions(),i=e.zoom.get(),r=this._getCursorPosition(t);this.setState({cursorPosition:r});var a;if(!this._lastDrawPosition)a=!0;else{var n=this.getSharedState('size'),s=this._lastDrawPosition.clone().subtract(r).abs().len()/i;a=s>=n/10}this._drawing&&a&&(this._currentPath.addControlPoint(r.clone().divide(o)),this._lastDrawPosition=r.clone(),e.render())},t.prototype._onMouseMoveOnCanvas=function(t){var e=this._getCursorPosition(t);this.setState({cursorPosition:e})},t.prototype._getCursorStyle=function(){var e=this.getSharedState('size'),t=this.state.cursorPosition;return{left:t.x,top:t.y,width:e,height:e,marginLeft:-0.5*e,marginTop:-0.5*e}},t.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()},t.prototype._getCursorPosition=function(e){var t=m.Utils.getEventPosition(e),o=this._containerBoundingRect;return t.subtract(o.left,o.top)},t.prototype._getContainerProps=function(){var t=e.prototype._getContainerProps.call(this);return t.onMouseDown=t.onTouchStart=this._onMouseDown,t},t.prototype._getInnerContainerProps=function(){var t=e.prototype._getInnerContainerProps.call(this);return delete t.onClick,t.onMouseEnter=this._onMouseEnter,t.onMouseLeave=this._onMouseLeave,t.onMouseMove=this._onMouseMoveOnCanvas,t},t.prototype._renderSpriteItems=function(){return null},t.prototype._renderOverlayControls=function(){var e=this.state.cursorVisible?'is-visible':null;return m.ReactBEM.createElement('div',{bem:'$b:selectiveBlurCanvasControls'},m.ReactBEM.createElement('div',{bem:'e:cursor',className:e,style:this._getCursorStyle()}))},t}(u.default);t.default=f,f.contextTypes=u.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(10),c=i(p),m=o(262),_=i(m),u=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState('operation'),o=this.getSharedState('initialOptions'),i=t.getFrame(),r=t.getScale();((i&&i.identifier)!==(o.frame&&o.frame.identifier)||r!==o.scale)&&e.history.add(t,this.getSharedState('initialOptions'),this.getSharedState('operationExistedBefore')),t.getFrame()||e.operations.remove(t),e.render()},t.onEnter=function(){var e=this.context.editor,t=e.operations.exists('frame'),o=e.operations.getOrCreate('frame'),i=o.serializeOptions();this.setSharedState({operation:o,operationExistedBefore:t,initialOptions:i,inputDimensions:o.getInputDimensions(),frame:o.getFrame()})},t.isAvailable=function(e){return e.isToolAllowed('frame')&&e.isToolEnabled('frame')},t}(c.default);u.controlsComponent=_.default,u.identifier='frame',u.iconPath='controls/overview/frame.png',u.languageKey='controls.overview.frame',u.defaultOptions={frames:[]},u.getPreloadAssets=c.default.getPreloadAssets,t.default=u},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(4),a=i(r),n=o(0),s=i(n),l=o(2),p=i(l),c=o(3),m=i(c),_=o(1),u=o(9),g=i(u),f=o(6),y=i(f),h=o(5),b=i(h),k=o(100),v=i(k),E=o(263),S=i(E),M=o(68),C=i(M),B=o(15),R=i(B),x=o(101),T=i(x),P=function(e){function t(){var o;(0,s.default)(this,t);for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];var l=(0,p.default)(this,e.call.apply(e,[this].concat(r)));return l._operation=l.getSharedState('operation'),l._bindAll('_onScaleChange','_onColorChange','_onOperationUpdated','_onOperationRemoved'),l._events=(o={},(0,a.default)(o,_.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),(0,a.default)(o,_.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),o),l._initFrameManager(),l}return(0,m.default)(t,e),t.prototype._initFrameManager=function(){this._frameManager=new v.default(this.context.ui,this.props.options)},t.prototype._onOperationUpdated=function(e){e===this.getSharedState('operation')&&this.forceSharedUpdate()},t.prototype._onOperationRemoved=function(e){if(e===this.getSharedState('operation')&&!this._backButtonClicked){var t=this.context.editor,o=t.operations.getOrCreate('frame');this.setSharedState({operation:o,frame:null,operationExistedBefore:!1,initialOptions:{}}),t.render()}},t.prototype._onScaleChange=function(e){var t=this.context.editor,o=this.getSharedState('inputDimensions');this._operation.setScale(e/o.min()),t.render()},t.prototype._onColorChange=function(e){var t=this.getSharedState('operation');t.setTintColor(e.clone());var o=this.context.editor;o.render()},t.prototype._onBackClick=function(){this._backButtonClicked=!0,this.props.onSwitchControls('home')},t.prototype._onFrameClick=function(e){var t=this,o=this.context.editor,i=this.getSharedState('operation');if(null===e)return i.setFrame(null),o.render(),this.setSharedState({frame:a});var r=setTimeout(function(){n=b.default.instance.displayLoading(t._t('loading.loading'))},100),a=new T.default(this.context.ui,e),n;a.load().then(function(){n&&n.close(),r&&(clearTimeout(r),r=null);var e=a.getFrame();i.setFrame(e);var o=t.context.editor;o.render(),t.setSharedState({frame:a})})},t.prototype.renderOverlayControls=function(){var e=this.getSharedState('frame');if(!e)return null;var t=this.getSharedState('inputDimensions'),o=d(0.3*t.min()),i=this._operation.getScale()*t.min();return _.ReactBEM.createElement(R.default,{minValue:5,maxValue:o,value:i,valueUnit:'px',middleDot:!1,label:this._t('controls.frame.scale'),onChange:this._onScaleChange})},t.prototype._renderListItems=function(){var e=this,t=this._frameManager.getFramesForCategory('all'),o=this.getSharedState('operation').getFrame(),i=_.ReactBEM.createElement('li',{bem:'e:item',key:'no-frame',onClick:this._onFrameClick.bind(this,null)},_.ReactBEM.createElement('bem',{specifier:'$b:controls'},_.ReactBEM.createElement('div',{bem:'$e:button m:withLabel',className:o?null:'is-active'},_.ReactBEM.createElement('img',{bem:'e:icon',src:this._getAssetPath('controls/frame/no-frame.png',!0)}),_.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.frame.noFrame')))));return[i].concat(t.map(function(t){return _.ReactBEM.createElement(S.default,{frame:t,active:o&&o.identifier===t.identifier,onClick:e._onFrameClick.bind(e,t)})}))},t.prototype.renderControls=function(){var e=this.getSharedState('operation').getFrame(),t=this._renderListItems(),o=[_.ReactBEM.createElement('div',{bem:'e:cell m:list'},_.ReactBEM.createElement(y.default,{ref:'scrollbar'},_.ReactBEM.createElement('ul',{bem:'$e:list'},t)))];if(e&&e.tintable){var i=this.getSharedState('operation');o.push(_.ReactBEM.createElement('div',{bem:'e:cell m:colorPicker'},_.ReactBEM.createElement(C.default,{initialValue:i.getTintColor().clone(),onChange:this._onColorChange})))}return o},t}(g.default);t.default=P,P.contextTypes=g.default.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),c=o(1),m=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n.state={frame:n.props.frame},n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){this._renderFrame()},t.prototype.componentWillReceiveProps=function(e){var t=this;this.props.frame!==e.frame&&this.setState({frame:e.frame},function(){t._renderFrame()})},t.prototype._renderFrame=function(){var e=this.context.editor,t=e.getSDK(),o=this.props.frame,i=this._getAssetPath(o.thumbnail),r=this.refs['canvas-'+o.identifier],a=t.getPixelRatio();r.width=r.offsetWidth*a,r.height=r.offsetHeight*a,r.style.width=r.offsetWidth+'px',r.style.height=r.offsetHeight+'px';var n=r.getContext('2d'),s=new window.Image;s.addEventListener('load',function(){var e=p(r.width/s.width,r.height/s.height),t=new c.Vector2(s.width,s.height).multiply(e),o=new c.Vector2(r.width,r.height).divide(2).subtract(t.clone().divide(2));n.drawImage(s,0,0,s.width,s.height,o.x,o.y,t.x,t.y)}),s.crossOrigin='Anonymous',s.src=i},t.prototype.renderWithBEM=function(){return c.ReactBEM.createElement('bem',{specifier:'b:controls e:list'},c.ReactBEM.createElement('li',{bem:'e:item',key:this.props.frame.identifier,onClick:this.props.onClick},c.ReactBEM.createElement('bem',{specifier:'$b:controls'},c.ReactBEM.createElement('div',{bem:'$e:button m:withInlineLabel'},c.ReactBEM.createElement('canvas',{bem:'e:canvas m:large',ref:'canvas-'+this.props.frame.identifier}),c.ReactBEM.createElement('div',{bem:'$e:inlineLabel',className:this.props.active?'is-active':null},c.ReactBEM.createElement('div',{bem:'e:label'},this._t('controls.frame.frames.'+this.props.frame.identifier)||this.props.frame.defaultName))))))},t}(c.BaseComponent);t.default=m},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t,o,i){(0,r.default)(this,e),this._editor=t,this._sdk=o,this._mediator=i,this._options=this._editor.getOptions(),this._features={drag:this._options.editor.enableDrag,zoom:this._options.editor.enableZoom}}return e.prototype.isEnabled=function(e){var t=e.charAt(0).toUpperCase()+e.slice(1),o=this._options.editor['enable'+t];return this._features[e]&&o},e.prototype.enable=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];o.forEach(function(t){e._features[t]=!0}),this._mediator.emit(a.Constants.EVENTS.FEATURES_ENABLED,o),this._mediator.emit(a.Constants.EVENTS.FEATURES_UPDATED,o)},e.prototype.disable=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];o.forEach(function(t){e._features[t]=!1}),this._mediator.emit(a.Constants.EVENTS.FEATURES_DISABLED,o),this._mediator.emit(a.Constants.EVENTS.FEATURES_UPDATED,o)},e}();t.default=n},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),m=o(1),_=300,u=function(e){function t(o,i,r){(0,a.default)(this,t);var n=(0,s.default)(this,e.call(this));return n._editor=o,n._sdk=i,n._mediator=r,n._isDefaultZoom=!1,n._zoom=n._sdk.getZoom(),n._options=n._editor.getOptions(),n._zoomLevels=[1,2,3,4,5,6.25,8.33,12.5,16.66,25,33.33,50,66.66,100,200,300,400,500,600,700,800,1200,1600,3200].map(function(e){return e/100}),n}return(0,d.default)(t,e),t.prototype.in=function(){var e=this._getClosestZoomLevel(this._zoom+1e-3,1);return e?void this.set(e):this._zoomLevels[this._zoomLevels.length-1]},t.prototype.out=function(){var e=this._getClosestZoomLevel(this._zoom-1e-3,-1);return e?void this.set(e):this._zoomLevels[0]},t.prototype._getClosestZoomLevel=function(e,t){return-1===t?this._zoomLevels.filter(function(t){return t<e}).pop():1===t?this._zoomLevels.filter(function(t){return t>e})[0]:void 0},t.prototype.restore=function(){this._previousZoom&&(this.set(this._previousZoom),this._previousZoom=null)},t.prototype.save=function(){this._previousZoom=this._zoom},t.prototype.set=function(e,t){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;if(this._editor.isReady()){var i=e,r=this.getDefault();'auto'===e||i===r?(i=r,e='auto',this._isDefaultZoom=!0):this._isDefaultZoom=!1;var a=c(1,2*r),n=o?this.getMinimum():0;i=c(n,p(a,i)),this._zoom=i,this._sdk.setZoom(this._zoom),this._sdk.setTextureQuality(p(this._zoom,1)),this.emit('set',this._zoom,t)}},t.prototype.getDefault=function(){var e=this._editor.getFinalDimensions(!1),t=this._editor.getCanvasDimensions(),o=m.SDKUtils.resizeVectorToFit(e,t);return o.divide(e).x},t.prototype.getMinimum=function(){var e=this._editor.getFinalDimensions(),t=m.SDKUtils.resizeVectorToFit(e,new m.Vector2(_,_));return t.divide(e).x},t.prototype.isDefault=function(){return this._isDefaultZoom},t.prototype.get=function(){return this._zoom},t}(m.EventEmitter);t.default=u},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(o,i,r){(0,a.default)(this,t);var n=(0,s.default)(this,e.call(this));return n._editor=o,n._sdk=i,n._mediator=r,n._history=[],n}return(0,d.default)(t,e),t.prototype.isAvailable=function(){return 0!==this._history.length},t.prototype.add=function(e,t,o){var i=this,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a;if(e instanceof Array){var n=e;this._history.push(n),n.forEach(function(e){i._mediator.emit(p.Constants.EVENTS.HISTORY_UPDATED,e.operation)}),a=n}else a={operation:e,options:t,existent:o,undo:r},this._history.push(a),this._mediator.emit(p.Constants.EVENTS.HISTORY_UPDATED,e);return a},t.prototype.undo=function(){var e=this,t=this._editor.operations,o=this._history.pop();if(o){var i=[].concat(o);i.forEach(function(o){var i=o.operation,r=o.existent,a=o.options,n=o.undo;e._mediator.emit(p.Constants.EVENTS.HISTORY_BEFORE_UNDO,o),r?(i=t.getOrCreate(i.constructor.identifier),i.set(a),e._mediator.emit(p.Constants.EVENTS.OPERATION_UPDATED,i)):t.remove(i),'function'==typeof n&&n(i,a),e._mediator.emit(p.Constants.EVENTS.HISTORY_UPDATED,i),e._mediator.emit(p.Constants.EVENTS.HISTORY_UNDO,i)}),this.emit('undo')}},t.prototype.reset=function(){this._history=[]},t}(p.EventEmitter);t.default=c},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(102),s=i(n),l=o(103),d=i(l),p=function(){function e(t){(0,a.default)(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){var t=new d.default(this._editor,e);return t.deserialize()},e}();t.default=p,p.version='1.0.0'},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t,o){(0,r.default)(this,e),this._ui=t,this._options=o,this._brushes=[],this._brushesById={},this._addBrushes(a.Constants.DEFAULTS.BRUSHES);var i=this._options,n=i.brushes,s=i.replaceBrushes,l=i.availableBrushes;this._options.brushes&&this._addBrushes(n,s),l&&(this._brushes=this._brushes.filter(function(e){return-1!==l.indexOf(e.identifier)}))}return e.prototype._addBrushes=function(e,t){var o=this;t&&(this._brushes=[],this._brushesById={}),e.forEach(function(e){o._brushes.push(e),o._brushesById[e.identifier]=e})},e.prototype.getBrushByIdentifier=function(e){return this._brushesById[e]},e.prototype.getBrushes=function(){return this._brushes},e.prototype.getFirstBrush=function(){return this._brushes[0]},e}();t.default=n},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(104),c=i(p),m={italic:'i'},_=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.load=function(){return this._fonts.length&&this._addStylesheetTag(),e.prototype.load.call(this)},t.prototype._addStylesheetTag=function(){var e=this._getFamiliesString(),t=document.createElement('link');t.rel='stylesheet',t.href='https://fonts.googleapis.com/css?family='+e;var o=document.getElementsByTagName('head')[0];o.appendChild(t)},t.prototype._getFamiliesString=function(){var e={};this._fonts.forEach(function(t){var o=t.getFontFamily(),i=t.getFontStyle(),r=t.getFontWeight();e[o]=e[o]||[],'undefined'==typeof r?e[o].push(400):e[o].push(''+r+(m[i]||''))});var t=[];for(var o in e){var i=e[o],r=i.length?':'+i.join(','):'',a=o.replace(' ','+')+r;t.push(a)}return t.join('|')},t}(c.default);t.default=_},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(271),s=i(n),l='undefined'!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):o(90),d=function(){function e(t){(0,a.default)(this,e),this._fontVariation=t,this._defaultFontRuler=new s.default,this._customFontRuler=new s.default(this._fontVariation)}return e.prototype.observe=function(){var e=this,t=l();return new Promise(function(o,i){var r=window.setInterval(function(){var a=e._defaultFontRuler.getWidth()!==e._customFontRuler.getWidth();if(a)return window.clearInterval(r),o();if(l()-t>=5e3){var n=new Error('Failed to load font '+e._fontVariation.getFontFamily()+'.');return n.font=e._fontVariation,i(n)}},50)})},e.prototype.dispose=function(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()},e}();t.default=d},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(99),s=i(n),l=function(){function e(t){(0,a.default)(this,e),this._fontVariation=t||new s.default({fontFamily:'Times New Roman',fontWeight:'normal',fontStyle:'normal'}),this._createRuler()}return e.prototype._createRuler=function(){this._ruler=document.createElement('div'),this._ruler.innerText='abcdefghijklmnopqrstuvwxzy',document.body.appendChild(this._ruler),this._setRulerStyle()},e.prototype._setRulerStyle=function(){this._ruler.style.cssText='\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      opacity: 0;\n      display: inline-block;\n      font: '+this._fontVariation.getFontStyle()+' '+this._fontVariation.getFontWeight()+' '+30+'px '+this._fontVariation.getFontFamily()+';\n    '},e.prototype.setFontVariation=function(e){this._fontVariation=e,this._setRulerStyle()},e.prototype.getWidth=function(){return this._ruler.offsetWidth},e.prototype.dispose=function(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)},e}();t.default=l},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(104),c=i(p),m=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.load=function(){var t=this,o=[];this._fonts.forEach(function(e){var i=t._ui.getAssetPath(e.getFilePath(),!1,!0);o.push('@font-face {\n        font-family: "'+e.getFontFamily()+'";\n        src: url(\''+i+'\') format(\'woff\');\n        font-weight: '+e.getFontWeight()+';\n        font-style: '+e.getFontStyle()+';\n      }')});var i=o.join('\n'),r=document.createElement('style');r.innerHTML=i;var a=document.getElementsByTagName('head')[0];return a.appendChild(r),e.prototype.load.call(this)},t}(c.default);t.default=m},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(105),s=i(n),l=o(106),d=i(l),p=function(){function e(t){(0,a.default)(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){var t=new d.default(this._editor,e);return t.deserialize()},e}();t.default=p,p.version='1.0.1'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(69),s=i(n),l=o(70),d=i(l),p=function(){function e(t){(0,a.default)(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){var t=new d.default(this._editor,e);return t.deserialize()},e}();t.default=p,p.version='2.0.0'},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(t){var o=this;(0,r.default)(this,e),this._options=t,this._overlays=a.SharedConstants.DEFAULTS.OVERLAYS,this._overlaysByIdentifier={},this._overlays.forEach(function(e){o._overlaysByIdentifier[e.identifier]=e})}return e.prototype.getOverlays=function(){return this._overlays},e.prototype.getOverlayByIdentifier=function(e){return this._overlaysByIdentifier[e]},e}();t.default=n},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(277),s=i(n),l=o(278),d=i(l),p=function(){function e(t){(0,a.default)(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){var t=new d.default(this._editor,e);return t.deserialize()},e}();t.default=p,p.version='2.0.1'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(69),c=i(p),m=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t}(c.default);t.default=m,m.version='2.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(70),c=i(p),m=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t}(c.default);t.default=m,m.version='2.0.1'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(280),s=i(n),l=o(281),d=i(l),p=function(){function e(t){(0,a.default)(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){var t=new d.default(this._editor,e);return t.deserialize()},e}();t.default=p,p.version='3.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(69),m=i(c),_=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.serialize=function(){var t=this,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.prototype.serialize.call(this,o).then(function(e){return e.meta={platform:'html5',version:t._editor.getSDK().version,createdAt:p.SDKUtils.ISODateString(new Date)},e.image=e.inputImage,delete e.inputImage,e})},t.prototype._serializeSticker=function(t,o){var i=e.prototype._serializeSticker.call(this,t,o);return i.options.alpha=o.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i},t.prototype._serializeText=function(t,o){var i=e.prototype._serializeText.call(this,t,o);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i},t.prototype._serializePath=function(t){var o=e.prototype._serializePath.call(this,t);delete o.hardness,delete o.size,delete o.color;var i=t.getBrush();o.brush=i.serializeOptions(['identifier','size','color'],!0),'undefined'==typeof o.brush.identifier&&delete o.brush.identifier,o.brush.color={rgba:o.brush.color};var r=i.getOption('hardness');return'undefined'!==r&&(o.brush.hardness=r),o},t.prototype._serializeFrameOperation=function(t,o){e.prototype._serializeFrameOperation.call(this,t,o);var i=o.filter(function(e){return'sprite'===e.type}),r;if(i.length){r=i.pop();var a=r.options.sprites.filter(function(e){return'frame'===e.type})[0],n=t.getTintColor();n.equals(new p.Color(1,1,1,0))||(a.options.tintColor={rgba:t.serializeOption('tintColor',!0)});var s=t.serializeOptions(['scale','alpha'],!0);a.options=p.SDKUtils.extend(a.options,s),a.options.size=a.options.scale,delete a.options.scale}},t.prototype._serializeTransformOperation=function(t){var o=e.prototype._serializeTransformOperation.call(this,t);return t._ratio&&(o.options.meta={identifier:t._ratio.identifier}),delete o.options.scale,o},t.prototype._serializeAdjustmentsOperation=function(t){var o=e.prototype._serializeAdjustmentsOperation.call(this,t),i=t.availableOptions,r=i.gamma,a=t.getGamma(),n=r.minValue,s=r.midValue,l=r.maxValue;return o.options.gamma=a<=s?(a-n)/(s-n)-1:(a-s)/(l-s),o},t.prototype._serializeOperation=function(t,o){switch(t.constructor.identifier){case'mirrored-focus':return this._serializeMirroredFocusOperation(t);case'linear-focus':return this._serializeLinearFocusOperation(t);case'blur':return this._serializeBlurOperation(t);default:return e.prototype._serializeOperation.call(this,t,o);}},t.prototype._serializeMirroredFocusOperation=function(e){return{type:'focus',options:{type:'mirrored',options:e.serializeOptions(['start','end','blurRadius','size','gradientSize'],!0)}}},t.prototype._serializeLinearFocusOperation=function(e){var t=e.serializeOptions(['controlPoint1','controlPoint2','blurRadius'],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:'focus',options:{type:'linear',options:t}}},t.prototype._serializeBlurOperation=function(e){return{type:'focus',options:{type:'gaussian',options:e.serializeOptions(['blurRadius'],!0)}}},t}(m.default);t.default=_,_.version='3.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(70),m=i(c),_=o(39),u=i(_),g=o(30),f=i(g),y=p.SDK.Operations.SpriteOperation.BrushSprite.Brush,h=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype._deserializeSticker=function(e,t){var o=this,i=p.SDK.Operations.SpriteOperation,r=t.options,a=this._stickerManager.getStickerByIdentifier(r.identifier);if(!a)return p.Log.warn('Deserializer','Unknown sticker `'+r.identifier+'`. Skipping sprite.'),Promise.resolve();var n=f.default.getURLForSticker(a,'base'),s=e.getInputDimensions(!1);return new Promise(function(t){var l=new window.Image;l.addEventListener('load',function(){var o=i.StickerSprite.prototype.availableOptions.adjustments.structure,n=r.rotation,d=r.flipHorizontally,c=r.flipVertically,m={identifier:r.identifier,image:l,position:p.Vector2.fromObject(r.position),dimensions:p.Vector2.fromObject(r.dimensions).multiply(s.min()),rotation:n||0,flipHorizontally:d,flipVertically:c,adjustments:{}};'undefined'!=typeof r.adjustments&&['brightness','contrast','saturation'].forEach(function(e){'undefined'!=typeof r.adjustments[e]&&(m.adjustments[e]=r.adjustments[e]+o[e].default)}),'undefined'!=typeof r.tintColor&&'undefined'!=typeof a.tintMode&&(m.tintColor=p.Color.fromArray(r.tintColor.rgba),m.tintMode=a.tintMode),'undefined'!=typeof r.alpha&&(m.alpha=r.alpha),t(e.createSticker(m))}),l.crossOrigin='Anonymous',l.src=o._editor.getUI().getAssetPath(n)})},t.prototype._deserializeTransformOperation=function(t){return e.prototype._deserializeTransformOperation.call(this,t).then(function(e){return e._ratio=null,e})},t.prototype._deserializeInputImage=function(){var e=this;return new Promise(function(t){var o=e._data.image,i=o.data,r=o.type;if(i&&r){var a=new window.Image;a.addEventListener('load',function(){e._editor.setImage(a),t()}),a.src='data:'+r+';base64,'+i}else t()})},t.prototype._deserializeAdjustmentsOperation=function(t){var o=p.SDK.Operations.AdjustmentsOperation;return e.prototype._deserializeAdjustmentsOperation.call(this,t).then(function(e){var i=t.options;if('undefined'!=typeof i.gamma){var r=o.prototype.availableOptions.gamma,a=r.minValue,n=r.midValue,s=r.maxValue;e.setGamma(0>i.gamma?n+(n-a)*i.gamma:n+(s-n)*i.gamma)}return e})},t.prototype._deserializeFocusOperation=function(t){var o=t.options.options;switch(t.options.type){case'radial':e.prototype._deserializeFocusOperation.call(this,t);break;case'linear':{var i=o.start,r=o.end,a=o.blurRadius;this._editor.operations.getOrCreate('linear-focus',{controlPoint1:p.Vector2.fromObject(i),controlPoint2:p.Vector2.fromObject(r),blurRadius:a})}break;case'mirrored':{var n=o.start,s=o.end,l=o.size,d=o.gradientSize,c=o.blurRadius;this._editor.operations.getOrCreate('mirrored-focus',{start:p.Vector2.fromObject(n),end:p.Vector2.fromObject(s),size:l,gradientSize:d,blurRadius:c})}break;case'gaussian':{var m=o.blurRadius;this._editor.operations.getOrCreate('blur',{blurRadius:m})}}},t.prototype._deserializeText=function(e,t){var o=t.options,i=o.fontSize,r=o.lineHeight,a=o.fontIdentifier,n=o.alignment,s=o.rotation,l=o.maxWidth,d=o.color,c=o.backgroundColor,m=new u.default(this._ui),_=this._fontManager.getVariationByIdentifier(a);return _?m.setFonts([_.getFont()]):_=this._fontManager.getDefaultFont(),m.load().then(function(){var t=e.getInputDimensions(!1),a=l*t.min()/t.x;return e.createText({fontSize:i,lineHeight:r,fontFamily:_.getFontFamily(),fontWeight:_.getFontWeight(),fontIdentifier:_.getIdentifier(),alignment:n,rotation:s,maxWidth:a,text:o.text,color:p.Color.fromArray(d.rgba),backgroundColor:p.Color.fromArray(c.rgba),position:p.Vector2.fromObject(o.position)})})},t.prototype._createBrushForPath=function(e){var t=e.brush,o=t.identifier,i=t.color,r=t.size,n=t.hardness,l=p.Color.fromArray(i.rgba),c={color:l,size:r};'undefined'!=typeof n&&(c.hardness=n);var m=this._brushManager.getBrushByIdentifier(o);if(m||(m=this._brushManager.getFirstBrush()),m.prototype&&m.prototype instanceof y){var _=m;return new _(c)}var u=p.SDKUtils.extend({},m);delete u.image;var g=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t}(y);return g.identifier=m.identifier,new g(p.SDKUtils.extend({},u,c))},t.prototype._deserializeFrame=function(t,o){var i=this;return e.prototype._deserializeFrame.call(this,t,o).then(function(){var e=i._editor.operations.get('frame'),t=o.options,r=t.size,a=t.alpha,n=t.tintColor,s={};'undefined'!=typeof r&&(s.scale=r),'undefined'!=typeof a&&(s.alpha=a),'undefined'!=typeof n&&(s.tintColor=p.Color.fromArray(n.rgba)),e.set(s)})},t}(m.default);t.default=h,h.version='3.0.0'},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(283),m=i(c),_=o(284),u=i(_),g=o(285),f=i(g),y=o(286),h=i(y),b=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._modalManager=n.props.modalManager,n._bindAll('_onModalManagerUpdate'),n}return(0,d.default)(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._modalManager.on('update',this._onModalManagerUpdate)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._modalManager.off('update',this._onModalManagerUpdate)},t.prototype._onModalManagerUpdate=function(){this.forceUpdate()},t.prototype._onModalClosed=function(e){this._modalManager.removeModal(e)},t.prototype._renderModals=function(){var e=this,t=this._modalManager.getModals();return t.map(function(t){var o;switch(t.type){case'loading':o=m.default;break;case'warning':o=u.default;break;case'error':o=f.default;break;case'progress':o=h.default;}return p.ReactBEM.createElement(o,{modal:t,onClose:e._onModalClosed.bind(e,t)})})},t.prototype.renderWithBEM=function(){return p.ReactBEM.createElement('div',null,this._renderModals())},t}(p.BaseComponent);t.default=b,b.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){var e=this.props.modal;return p.ReactBEM.createElement('bem',{specifier:'$b:modals'},p.ReactBEM.createElement('div',{bem:'e:overlay'},p.ReactBEM.createElement('div',{bem:'e:modal m:loading'},p.ReactBEM.createElement('div',{bem:'e:text'},e.text))))},t}(p.BaseComponent);t.default=c,c.propTypes={modal:p.PropTypes.object},c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){var e=this.props.modal;return p.ReactBEM.createElement('bem',{specifier:'$b:modals'},p.ReactBEM.createElement('div',{bem:'e:modal m:warning'},p.ReactBEM.createElement('div',{bem:'e:title'},e.title),p.ReactBEM.createElement('div',{bem:'e:text'},e.text),p.ReactBEM.createElement('div',{bem:'e:button b:button m:inline',onClick:this.props.onClose},'OK')))},t}(p.BaseComponent);t.default=c,c.propTypes={modal:p.PropTypes.object},c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){(0,a.default)(this,t);for(var o=arguments.length,i=Array(o),r=0;r<o;r++)i[r]=arguments[r];var n=(0,s.default)(this,e.call.apply(e,[this].concat(i)));return n._bindAll('_onClose'),n}return(0,d.default)(t,e),t.prototype._onClose=function(){this.props.modal.close()},t.prototype.renderWithBEM=function(){var e=this.props.modal,t=p.ReactBEM.createElement('div',{bem:'e:modal m:error'},p.ReactBEM.createElement('div',{bem:'e:title'},e.title),p.ReactBEM.createElement('div',{bem:'e:text'},e.text),p.ReactBEM.createElement('div',{bem:'e:button b:button m:inline',onClick:this._onClose},'OK')),o=e.overlay?p.ReactBEM.createElement('div',{bem:'e:overlay'},t):t;return p.ReactBEM.createElement('bem',{specifier:'$b:modals'},o)},t}(p.BaseComponent);t.default=c,c.propTypes={modal:p.PropTypes.object},c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,e.apply(this,arguments))}return(0,d.default)(t,e),t.prototype.renderWithBEM=function(){var e=this.props.modal,t=e.data.progress,o={width:(100*(t||0)).toFixed(2)+'%'};return p.ReactBEM.createElement('bem',{specifier:'$b:modals'},p.ReactBEM.createElement('div',{bem:'e:overlay'},p.ReactBEM.createElement('div',{bem:'e:modal m:loading'},p.ReactBEM.createElement('div',{bem:'e:text'},e.text),p.ReactBEM.createElement('bem',{specifier:'b:loadingModal'},p.ReactBEM.createElement('div',{bem:'$e:progressBar'},p.ReactBEM.createElement('div',{bem:'e:progress',style:o}))))))},t}(p.BaseComponent);t.default=c,c.propTypes={modal:p.PropTypes.object},c.contextTypes=p.BaseComponent.contextTypes},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(0),a=i(r),n=o(2),s=i(n),l=o(3),d=i(l),p=o(1),c=o(94),m=i(c),_=function(e){function t(o,i,r){(0,a.default)(this,t);var n=(0,s.default)(this,e.call(this));return n._ui=o,n._options=i,n._mediator=r,n._assets={},n._editor=new m.default(o,i,r,!0),n._assets=['controls/back.png','controls/minus.png','controls/plus.png','controls/tick.png','controls/webcam/shutter.png','controls/knobs/remove.png','controls/knobs/resize-diagonal-down.png','controls/knobs/resize-diagonal-up.png','controls/knobs/rotate.png','editor/export.png','editor/new.png','editor/undo.png',['splash/photo-roll.png',!1,!0],['splash/webcam.png',!1,!0],'top-bar/back.png','close.png'],n._appendControlsAssets(),n}return(0,d.default)(t,e),t.prototype._appendControlsAssets=function(){var e=this._editor.controls.getAvailable();for(var t in e){var o=e[t];this._editor.controls.isEnabled(t)&&(this._assets=this._assets.concat(o.getPreloadAssets(this._editor)),this._assets.push(o.iconPath))}},t.prototype.load=function(){var e=this,t=this._assets.slice(),o=t.length,i=0,r=function(){i++,e.emit('progress',i/o),i===o&&e.emit('done')},a=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'timed out';p.Log.warn('Preloader',e+' '+t+'.'),r()},n=function(e){return window.setTimeout(function(){a(e)},5e3)};t.forEach(function(t){var o=!0,i=!0;p.SDKUtils.isArray(t)&&(i=t[2],o=t[1],t=t[0]);var s=e._ui.getAssetPath(t,i,!o),l=new window.Image,d=n(s);l.addEventListener('load',function(){e._assets[s]=l,window.clearTimeout(d),r()}),l.addEventListener('error',function(){window.clearTimeout(d),a(s,'was not found')}),l.crossOrigin='Anonymous',l.src=s})},t.prototype.getAsset=function(e){return this._assets[e]},t}(p.EventEmitter);t.default=_},function(e,t,o){'use strict';function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var r=o(289);Object.defineProperty(t,'Provider',{enumerable:!0,get:function(){return i(r).default}});var a=o(290);Object.defineProperty(t,'Library',{enumerable:!0,get:function(){return i(a).default}});var n=o(291);Object.defineProperty(t,'SearchSuggestion',{enumerable:!0,get:function(){return i(n).default}});var s=o(292);Object.defineProperty(t,'Photo',{enumerable:!0,get:function(){return i(s).default}})},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),a=o(1),n=function(){function e(){(0,r.default)(this,e)}return e.prototype.getLibraries=function(){return a.Log.warn(this.constructor.name,'`getLibraries` is abstract and not implemented.'),a.Promise.resolve([])},e.prototype.getSearchSuggestions=function(){return a.Log.warn(this.constructor.name,'`getSearchSuggestions` is abstract and not implemented.'),a.Promise.resolve([])},e.prototype.getPhotosForLibrary=function(){return a.Log.warn(this.constructor.name,'`getPhotosForLibrary` is abstract and not implemented.'),a.Promise.resolve([])},e.prototype.searchPhotos=function(){return a.Log.warn(this.constructor.name,'`searchPhotos` is abstract and not implemented.'),a.Promise.resolve([])},e}();t.default=n},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function e(t){(0,r.default)(this,e),this.name=t.name,this.coverImage=t.coverImage}},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function e(t){(0,r.default)(this,e),this.query=t.query,this.name=this.query,this.coverImage=t.coverImage}},function(e,t,o){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default=function e(t,o){(0,r.default)(this,e),this.library=t,this.title=o.title,this.urls=o.urls}},function(e){e.exports={controls:{overview:{filters:'Filter',adjustments:'Korrekturen',transform:'Zuschneiden',blur:'Weichzeichnen',frame:'Rahmen',sticker:'Sticker',text:'Text',brush:'Malen',focus:'Focus',"selective-blur":'Sel. Unsch\xE4rfe'},text:{foreground:'Vordergrund',background:'Hintergrund',size:'Gr\xF6\xDFe',font:'Schriftart',alignment:'Ausrichtung',takeToFront:'Nach oben',defaultText:'Doppelklick zum Bearbeiten!'},adjustments:{brightness:'Helligkeit',contrast:'Kontrast',saturation:'S\xE4ttigung',gamma:'Gamma',exposure:'Belichtung',shadows:'Schatten',highlights:'Lichter',clarity:'Klarheit'},transform:{none:'Original',rotation:'Drehung'},focus:{none:'Original',radial:'Kreisf\xF6rmig',mirrored:'Gespiegelt',blurRadius:'Radius'},selectiveBlur:{blurRadius:'Radius',size:'Dicke'},filters:{intensity:'Intensit\xE4t',filters:{identity:'Original'}},sticker:{flip:'Spiegeln',"flip-v":'Spiegeln (V)',"flip-h":'Spiegeln (H)',takeToFront:'Nach oben',categories:{all:'Alle'}},brush:{size:'Dicke',color:'Farbe'},frame:{noFrame:'Kein Rahmen',scale:'Gr\xF6\xDFe'}},webcam:{headline:'Mache ein Foto!'},editor:{headline:'Foto editieren',new:'Neu',backgroundImage:'Hintergrundbild',undo:'R\xFCckg\xE4ngig',export:'Speichern',zoom:'Zoom'},splash:{upload:{button:'Lade ein Foto hoch',description:'Klicke hier, um ein Foto von deinem Rechner hochzuladen oder lade es per Drag-and-Drop hoch'},webcam:{headline:'Webcam',description:'Klicke hier, um ein Foto mit deiner Webcam zu machen'},photoRoll:{headline:'Kostenloses Bildmaterial',description:'Suche dir eines von tausenden Stock Photos aus.'}},photoRoll:{search:{placeholder:'Nach Fotos suchen',noSearchResults:'Entschuldigung, aber wir konnten f\xFCr <strong>"${query}"</strong> leider keine Ergebnisse finden.',results:{headline:'Suchergebnisse f\xFCr "${query}"'}}},generic:{back:'Zur\xFCck',cancel:'Abbrechen',color:'Farbe'},loading:{resizing:'Bild wird bearbeitet...',exporting:'Exportiere...',loading:'Lade...'},warnings:{imageResized_maxMegaPixels:{title:'Bild verkleinert',text:'Da dein Bild die maximale Gr\xF6\xDFe von ${maxMegaPixels} Megapixeln \xFCberschreitet, wurde es auf ${width}x${height} Pixel verkleinert.'},imageResized_maxDimensions:{title:'Bild verkleinert',text:'Aufgrund von Hardware-Beschr\xE4nkungen wurde das Bild auf ${width}x${height} Pixel verkleinert.'}},errors:{imageLoadFail:{title:'Bild konnte nicht geladen werden',text:'Beim Laden des Bildes unter ${path} ist ein Fehler aufgetreten.'},webcamUnavailable:{title:'Webcam nicht verf\xFCgbar',text:'Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})'},webcamNotSupported:{title:'Webcam nicht unterst\xFCtzt',text:'Dein Browser unterst\xFCtzt das Webcam-Feature leider noch nicht.'},renderingError:{title:'Rendering-Fehler',text:'Beim Rendern des Bildes ist ein Fehler aufgetreten.'},context_lost:{title:'Es ist ein Fehler aufgetreten',text:'Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal.'},context_lost_limit:{title:'Es ist ein Fehler aufgetreten',text:'Bild-Generierung ist mehrmals fehlgeschlagen.'},loadingStickersFailed:{title:'Laden der Sticker fehlgeschlagen'},loadingFontsFailed:{title:'Laden der Schriftarten fehlgeschlagen',text:'Einige Schriftarten sind m\xF6glicherweise nicht verf\xFCgbar.'},photoRollLoadFail:{title:'Laden der Photo Roll fehlgeschlagen',text:'Die Photo Roll konnte nicht geladen werden: ${error}'},invalidFileType:{text:'Der Dateityp ${fileType} wird nicht unterst\xFCtzt.'},title:'Es ist ein Fehler aufgetreten'}}},function(e){e.exports={controls:{overview:{filters:'Filters',adjustments:'Adjust',transform:'Transform',focus:'Focus',frame:'Frame',sticker:'Sticker',text:'Text',brush:'Brush',"selective-blur":'Selective Blur'},text:{foreground:'Foreground',background:'Background',size:'Size',font:'Font',alignment:'Alignment',takeToFront:'To Front',defaultText:'Double-click to edit'},adjustments:{brightness:'Brightness',contrast:'Contrast',saturation:'Saturation',exposure:'Exposure',gamma:'Gamma',shadows:'Shadows',highlights:'Highlights',clarity:'Clarity'},transform:{none:'Original',rotation:'Rotation'},focus:{none:'None',radial:'Radial',mirrored:'Mirrored',blurRadius:'Blur radius'},selectiveBlur:{blurRadius:'Blur radius',size:'Size'},filter:{intensity:'Intensity',filters:{identity:'None'}},sticker:{flip:'Flip',"flip-v":'Flip (V)',"flip-h":'Flip (H)',takeToFront:'To Front',categories:{all:'All'}},brush:{size:'Size',color:'Color'},frame:{noFrame:'No Frame',scale:'Scale'}},webcam:{headline:'Take a photo!'},editor:{headline:'Edit Photo',new:'New',backgroundImage:'Background Image',undo:'Undo',export:'Export',zoom:'Zoom'},splash:{upload:{button:'Upload your image',description:'Upload a picture from your library or just drag and drop'},webcam:{headline:'Webcam',description:'Take a picture with your webcam or phone'},photoRoll:{headline:'Free stock footage',description:'Select from thousands of Free Stock Photos'}},photoRoll:{search:{placeholder:'Search for photos',noSearchResults:'Sorry, but we couldn\'t find any photos for <strong>"${query}"</strong>.',results:{headline:'Search results for "${query}"'}}},generic:{back:'Back',cancel:'Cancel',color:'Color'},loading:{resizing:'Resizing...',exporting:'Exporting...',loading:'Loading...'},warnings:{imageResized_maxMegaPixels:{title:'Image resized',text:'Your image exceeds the maximum size of ${maxMegaPixels} megapixels and has therefore been resized to ${width}x${height} pixels.'},imageResized_maxDimensions:{title:'Image resized',text:'Due to hardware limitations your image has been resized to ${width}x${height} pixels.'}},errors:{imageLoadFail:{title:'Failed to load image',text:'Failed to load the image at ${path}'},webcamUnavailable:{title:'Webcam unavailable',text:'Unable to display webcam image (Error: ${error})'},webcamNotSupported:{title:'Webcam not supported',text:'The webcam feature is not supported by your browser.'},renderingError:{title:'Error while rendering',text:'An error has occurred while rendering the image.'},context_lost:{title:'An error has occurred',text:'Your browser took too long to render the image. Please try applying less operations.'},context_lost_limit:{title:'An error has occurred',text:'Your browser failed multiple times while rendering the image.'},loadingStickersFailed:{title:'Failed to load stickers'},loadingFontsFailed:{title:'Failed to load fonts',text:'Some fonts might not be available.'},photoRollLoadFail:{title:'Failed to load Photo Roll',text:'Failed to load photos for the photo roll: ${error}'},invalidFileType:{text:'The file type ${fileType} is not supported.'},title:'An error has occurred'}}}])});